(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[604],{32264:function(e,t,r){"use strict";let{AbortError:i,codes:n}=r(64385),{isNodeStream:o,isWebStream:a,kControllerErrorFunction:s}=r(66909),l=r(94906),{ERR_INVALID_ARG_TYPE:d}=n,u=(e,t)=>{if("object"!=typeof e||!("aborted"in e))throw new d(t,"AbortSignal",e)};e.exports.addAbortSignal=function(t,r){if(u(t,"signal"),!o(r)&&!a(r))throw new d("stream",["ReadableStream","WritableStream","Stream"],r);return e.exports.addAbortSignalNoValidate(t,r)},e.exports.addAbortSignalNoValidate=function(e,t){if("object"!=typeof e||!("aborted"in e))return t;let r=o(t)?()=>{t.destroy(new i(void 0,{cause:e.reason}))}:()=>{t[s](new i(void 0,{cause:e.reason}))};return e.aborted?r():(e.addEventListener("abort",r),l(t,()=>e.removeEventListener("abort",r))),t}},57231:function(e,t,r){"use strict";let{StringPrototypeSlice:i,SymbolIterator:n,TypedArrayPrototypeSet:o,Uint8Array:a}=r(57156),{Buffer:s}=r(48764),{inspect:l}=r(70780);e.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){let t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){let t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}shift(){if(0===this.length)return;let e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(0===this.length)return"";let t=this.head,r=""+t.data;for(;null!==(t=t.next);)r+=e+t.data;return r}concat(e){if(0===this.length)return s.alloc(0);let t=s.allocUnsafe(e>>>0),r=this.head,i=0;for(;r;)o(t,r.data,i),i+=r.data.length,r=r.next;return t}consume(e,t){let r=this.head.data;if(e<r.length){let t=r.slice(0,e);return this.head.data=r.slice(e),t}return e===r.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[n](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let t="",r=this.head,n=0;do{let o=r.data;if(e>o.length)t+=o,e-=o.length;else{e===o.length?(t+=o,++n,r.next?this.head=r.next:this.head=this.tail=null):(t+=i(o,0,e),this.head=r,r.data=i(o,e));break}++n}while(null!==(r=r.next));return this.length-=n,t}_getBuffer(e){let t=s.allocUnsafe(e),r=e,i=this.head,n=0;do{let s=i.data;if(e>s.length)o(t,s,r-e),e-=s.length;else{e===s.length?(o(t,s,r-e),++n,i.next?this.head=i.next:this.head=this.tail=null):(o(t,new a(s.buffer,s.byteOffset,e),r-e),this.head=i,i.data=s.slice(e));break}++n}while(null!==(i=i.next));return this.length-=n,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return l(this,{...t,depth:0,customInspect:!1})}}},96171:function(e,t,r){"use strict";let{pipeline:i}=r(6729),n=r(96665),{destroyer:o}=r(39201),{isNodeStream:a,isReadable:s,isWritable:l,isWebStream:d,isTransformStream:u,isWritableStream:c,isReadableStream:h}=r(66909),{AbortError:f,codes:{ERR_INVALID_ARG_VALUE:p,ERR_MISSING_ARGS:b}}=r(64385),y=r(94906);e.exports=function(...e){let t,r,g,w,m;if(0===e.length)throw new b("streams");if(1===e.length)return n.from(e[0]);let _=[...e];if("function"==typeof e[0]&&(e[0]=n.from(e[0])),"function"==typeof e[e.length-1]){let t=e.length-1;e[t]=n.from(e[t])}for(let t=0;t<e.length;++t)if(a(e[t])||d(e[t])){if(t<e.length-1&&!(s(e[t])||h(e[t])||u(e[t])))throw new p(`streams[${t}]`,_[t],"must be readable");if(t>0&&!(l(e[t])||c(e[t])||u(e[t])))throw new p(`streams[${t}]`,_[t],"must be writable")}let v=e[0],S=i(e,function(e){let t=w;w=null,t?t(e):e?m.destroy(e):A||E||m.destroy()}),E=!!(l(v)||c(v)||u(v)),A=!!(s(S)||h(S)||u(S));if(m=new n({writableObjectMode:!!(null!=v&&v.writableObjectMode),readableObjectMode:!!(null!=S&&S.writableObjectMode),writable:E,readable:A}),E){if(a(v))m._write=function(e,r,i){v.write(e,r)?i():t=i},m._final=function(e){v.end(),r=e},v.on("drain",function(){if(t){let e=t;t=null,e()}});else if(d(v)){let e=(u(v)?v.writable:v).getWriter();m._write=async function(t,r,i){try{await e.ready,e.write(t).catch(()=>{}),i()}catch(e){i(e)}},m._final=async function(t){try{await e.ready,e.close().catch(()=>{}),r=t}catch(e){t(e)}}}y(u(S)?S.readable:S,()=>{if(r){let e=r;r=null,e()}})}if(A){if(a(S))S.on("readable",function(){if(g){let e=g;g=null,e()}}),S.on("end",function(){m.push(null)}),m._read=function(){for(;;){let e=S.read();if(null===e){g=m._read;return}if(!m.push(e))return}};else if(d(S)){let e=(u(S)?S.readable:S).getReader();m._read=async function(){for(;;)try{let{value:t,done:r}=await e.read();if(!m.push(t))return;if(r){m.push(null);return}}catch{return}}}}return m._destroy=function(e,i){e||null===w||(e=new f),g=null,t=null,r=null,null===w?i(e):(w=i,a(S)&&o(S,e))},m}},39201:function(e,t,r){"use strict";let i=r(34155),{aggregateTwoErrors:n,codes:{ERR_MULTIPLE_CALLBACK:o},AbortError:a}=r(64385),{Symbol:s}=r(57156),{kDestroyed:l,isDestroyed:d,isFinished:u,isServerRequest:c}=r(66909),h=s("kDestroy"),f=s("kConstruct");function p(e,t,r){e&&(e.stack,t&&!t.errored&&(t.errored=e),r&&!r.errored&&(r.errored=e))}function b(e,t,r){let n=!1;function o(t){if(n)return;n=!0;let o=e._readableState,a=e._writableState;p(t,a,o),a&&(a.closed=!0),o&&(o.closed=!0),"function"==typeof r&&r(t),t?i.nextTick(y,e,t):i.nextTick(g,e)}try{e._destroy(t||null,o)}catch(e){o(e)}}function y(e,t){w(e,t),g(e)}function g(e){let t=e._readableState,r=e._writableState;r&&(r.closeEmitted=!0),t&&(t.closeEmitted=!0),(null!=r&&r.emitClose||null!=t&&t.emitClose)&&e.emit("close")}function w(e,t){let r=e._readableState,i=e._writableState;null!=i&&i.errorEmitted||null!=r&&r.errorEmitted||(i&&(i.errorEmitted=!0),r&&(r.errorEmitted=!0),e.emit("error",t))}function m(e,t,r){let n=e._readableState,o=e._writableState;if(null!=o&&o.destroyed||null!=n&&n.destroyed)return this;null!=n&&n.autoDestroy||null!=o&&o.autoDestroy?e.destroy(t):t&&(t.stack,o&&!o.errored&&(o.errored=t),n&&!n.errored&&(n.errored=t),r?i.nextTick(w,e,t):w(e,t))}function _(e){let t=!1;function r(r){if(t){m(e,null!=r?r:new o);return}t=!0;let n=e._readableState,a=e._writableState,s=a||n;n&&(n.constructed=!0),a&&(a.constructed=!0),s.destroyed?e.emit(h,r):r?m(e,r,!0):i.nextTick(v,e)}try{e._construct(e=>{i.nextTick(r,e)})}catch(e){i.nextTick(r,e)}}function v(e){e.emit(f)}function S(e){return(null==e?void 0:e.setHeader)&&"function"==typeof e.abort}function E(e){e.emit("close")}function A(e,t){e.emit("error",t),i.nextTick(E,e)}e.exports={construct:function(e,t){if("function"!=typeof e._construct)return;let r=e._readableState,n=e._writableState;r&&(r.constructed=!1),n&&(n.constructed=!1),e.once(f,t),e.listenerCount(f)>1||i.nextTick(_,e)},destroyer:function(e,t){!(!e||d(e))&&(t||u(e)||(t=new a),c(e)?(e.socket=null,e.destroy(t)):S(e)?e.abort():S(e.req)?e.req.abort():"function"==typeof e.destroy?e.destroy(t):"function"==typeof e.close?e.close():t?i.nextTick(A,e,t):i.nextTick(E,e),e.destroyed||(e[l]=!0))},destroy:function(e,t){let r=this._readableState,i=this._writableState,o=i||r;return null!=i&&i.destroyed||null!=r&&r.destroyed?"function"==typeof t&&t():(p(e,i,r),i&&(i.destroyed=!0),r&&(r.destroyed=!0),o.constructed?b(this,e,t):this.once(h,function(r){b(this,n(r,e),t)})),this},undestroy:function(){let e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=!1===e.readable,e.endEmitted=!1===e.readable),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=!1===t.writable,t.ending=!1===t.writable,t.finished=!1===t.writable)},errorOrDestroy:m}},96665:function(e,t,r){"use strict";let i,n;let{ObjectDefineProperties:o,ObjectGetOwnPropertyDescriptor:a,ObjectKeys:s,ObjectSetPrototypeOf:l}=r(57156);e.exports=c;let d=r(47950),u=r(39713);l(c.prototype,d.prototype),l(c,d);{let e=s(u.prototype);for(let t=0;t<e.length;t++){let r=e[t];c.prototype[r]||(c.prototype[r]=u.prototype[r])}}function c(e){if(!(this instanceof c))return new c(e);d.call(this,e),u.call(this,e),e?(this.allowHalfOpen=!1!==e.allowHalfOpen,!1===e.readable&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===e.writable&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}function h(){return void 0===i&&(i={}),i}o(c.prototype,{writable:{__proto__:null,...a(u.prototype,"writable")},writableHighWaterMark:{__proto__:null,...a(u.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...a(u.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...a(u.prototype,"writableBuffer")},writableLength:{__proto__:null,...a(u.prototype,"writableLength")},writableFinished:{__proto__:null,...a(u.prototype,"writableFinished")},writableCorked:{__proto__:null,...a(u.prototype,"writableCorked")},writableEnded:{__proto__:null,...a(u.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...a(u.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set(e){this._readableState&&this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}}),c.fromWeb=function(e,t){return h().newStreamDuplexFromReadableWritablePair(e,t)},c.toWeb=function(e){return h().newReadableWritablePairFromDuplex(e)},c.from=function(e){return n||(n=r(87687)),n(e,"body")}},87687:function(e,t,r){"use strict";let i=r(34155),n=r(48764),{isReadable:o,isWritable:a,isIterable:s,isNodeStream:l,isReadableNodeStream:d,isWritableNodeStream:u,isDuplexNodeStream:c}=r(66909),h=r(94906),{AbortError:f,codes:{ERR_INVALID_ARG_TYPE:p,ERR_INVALID_RETURN_VALUE:b}}=r(64385),{destroyer:y}=r(39201),g=r(96665),w=r(47950),{createDeferredPromise:m}=r(70780),_=r(24545),v=globalThis.Blob||n.Blob,S=void 0!==v?function(e){return e instanceof v}:function(e){return!1},E=globalThis.AbortController||r(28599).AbortController,{FunctionPrototypeCall:A}=r(57156);class T extends g{constructor(e){super(e),(null==e?void 0:e.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(null==e?void 0:e.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}function R(e){let t,r,i,n,s;let l=e.readable&&"function"!=typeof e.readable.read?w.wrap(e.readable):e.readable,d=e.writable,u=!!o(l),c=!!a(d);function p(e){let t=n;n=null,t?t(e):e&&s.destroy(e)}return s=new T({readableObjectMode:!!(null!=l&&l.readableObjectMode),writableObjectMode:!!(null!=d&&d.writableObjectMode),readable:u,writable:c}),c&&(h(d,e=>{c=!1,e&&y(l,e),p(e)}),s._write=function(e,r,i){d.write(e,r)?i():t=i},s._final=function(e){d.end(),r=e},d.on("drain",function(){if(t){let e=t;t=null,e()}}),d.on("finish",function(){if(r){let e=r;r=null,e()}})),u&&(h(l,e=>{u=!1,e&&y(l,e),p(e)}),l.on("readable",function(){if(i){let e=i;i=null,e()}}),l.on("end",function(){s.push(null)}),s._read=function(){for(;;){let e=l.read();if(null===e){i=s._read;return}if(!s.push(e))return}}),s._destroy=function(e,o){e||null===n||(e=new f),i=null,t=null,r=null,null===n?o(e):(n=o,y(d,e),y(l,e))},s}e.exports=function e(t,r){if(c(t))return t;if(d(t))return R({readable:t});if(u(t))return R({writable:t});if(l(t))return R({writable:!1,readable:!1});if("function"==typeof t){let{value:e,write:n,final:o,destroy:a}=function(e){let{promise:t,resolve:r}=m(),n=new E,o=n.signal;return{value:e(async function*(){for(;;){let e=t;t=null;let{chunk:n,done:a,cb:s}=await e;if(i.nextTick(s),a)return;if(o.aborted)throw new f(void 0,{cause:o.reason});({promise:t,resolve:r}=m()),yield n}}(),{signal:o}),write(e,t,i){let n=r;r=null,n({chunk:e,done:!1,cb:i})},final(e){let t=r;r=null,t({done:!0,cb:e})},destroy(e,t){n.abort(),t(e)}}}(t);if(s(e))return _(T,e,{objectMode:!0,write:n,final:o,destroy:a});let l=null==e?void 0:e.then;if("function"==typeof l){let t;let r=A(l,e,e=>{if(null!=e)throw new b("nully","body",e)},e=>{y(t,e)});return t=new T({objectMode:!0,readable:!1,write:n,final(e){o(async()=>{try{await r,i.nextTick(e,null)}catch(t){i.nextTick(e,t)}})},destroy:a})}throw new b("Iterable, AsyncIterable or AsyncFunction",r,e)}if(S(t))return e(t.arrayBuffer());if(s(t))return _(T,t,{objectMode:!0,writable:!1});if("object"==typeof(null==t?void 0:t.writable)||"object"==typeof(null==t?void 0:t.readable))return R({readable:null!=t&&t.readable?d(null==t?void 0:t.readable)?null==t?void 0:t.readable:e(t.readable):void 0,writable:null!=t&&t.writable?u(null==t?void 0:t.writable)?null==t?void 0:t.writable:e(t.writable):void 0});let n=null==t?void 0:t.then;if("function"==typeof n){let e;return A(n,t,t=>{null!=t&&e.push(t),e.push(null)},t=>{y(e,t)}),e=new T({objectMode:!0,writable:!1,read(){}})}throw new p(r,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],t)}},94906:function(e,t,r){"use strict";let i=r(34155),{AbortError:n,codes:o}=r(64385),{ERR_INVALID_ARG_TYPE:a,ERR_STREAM_PREMATURE_CLOSE:s}=o,{kEmptyObject:l,once:d}=r(70780),{validateAbortSignal:u,validateFunction:c,validateObject:h,validateBoolean:f}=r(8055),{Promise:p,PromisePrototypeThen:b}=r(57156),{isClosed:y,isReadable:g,isReadableNodeStream:w,isReadableStream:m,isReadableFinished:_,isReadableErrored:v,isWritable:S,isWritableNodeStream:E,isWritableStream:A,isWritableFinished:T,isWritableErrored:R,isNodeStream:C,willEmitClose:D,kIsClosedPromise:M}=r(66909),I=()=>{};function k(e,t,r){var o,f;if(2==arguments.length?(r=t,t=l):null==t?t=l:h(t,"options"),c(r,"callback"),u(t.signal,"options.signal"),r=d(r),m(e)||A(e))return function(e,t,r){let o=!1,a=I;if(t.signal){if(a=()=>{o=!0,r.call(e,new n(void 0,{cause:t.signal.reason}))},t.signal.aborted)i.nextTick(a);else{let i=r;r=d((...r)=>{t.signal.removeEventListener("abort",a),i.apply(e,r)}),t.signal.addEventListener("abort",a)}}let s=(...t)=>{o||i.nextTick(()=>r.apply(e,t))};return b(e[M].promise,s,s),I}(e,t,r);if(!C(e))throw new a("stream",["ReadableStream","WritableStream","Stream"],e);let p=null!==(o=t.readable)&&void 0!==o?o:w(e),k=null!==(f=t.writable)&&void 0!==f?f:E(e),P=e._writableState,O=e._readableState,N=()=>{e.writable||x()},L=D(e)&&w(e)===p&&E(e)===k,U=T(e,!1),x=()=>{U=!0,e.destroyed&&(L=!1),L&&(!e.readable||p)||p&&!B||r.call(e)},B=_(e,!1),W=()=>{B=!0,e.destroyed&&(L=!1),L&&(!e.writable||k)||k&&!U||r.call(e)},j=t=>{r.call(e,t)},$=y(e),H=()=>{$=!0;let t=R(e)||v(e);return t&&"boolean"!=typeof t?r.call(e,t):p&&!B&&w(e,!0)&&!_(e,!1)||k&&!U&&!T(e,!1)?r.call(e,new s):void r.call(e)},K=()=>{$=!0;let t=R(e)||v(e);if(t&&"boolean"!=typeof t)return r.call(e,t);r.call(e)},Z=()=>{e.req.on("finish",x)};e.setHeader&&"function"==typeof e.abort?(e.on("complete",x),L||e.on("abort",H),e.req?Z():e.on("request",Z)):k&&!P&&(e.on("end",N),e.on("close",N)),L||"boolean"!=typeof e.aborted||e.on("aborted",H),e.on("end",W),e.on("finish",x),!1!==t.error&&e.on("error",j),e.on("close",H),$?i.nextTick(H):null!=P&&P.errorEmitted||null!=O&&O.errorEmitted?L||i.nextTick(K):!p&&(!L||g(e))&&(U||!1===S(e))?i.nextTick(K):!k&&(!L||S(e))&&(B||!1===g(e))?i.nextTick(K):O&&e.req&&e.aborted&&i.nextTick(K);let V=()=>{r=I,e.removeListener("aborted",H),e.removeListener("complete",x),e.removeListener("abort",H),e.removeListener("request",Z),e.req&&e.req.removeListener("finish",x),e.removeListener("end",N),e.removeListener("close",N),e.removeListener("finish",x),e.removeListener("end",W),e.removeListener("error",j),e.removeListener("close",H)};if(t.signal&&!$){let o=()=>{let i=r;V(),i.call(e,new n(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)i.nextTick(o);else{let i=r;r=d((...r)=>{t.signal.removeEventListener("abort",o),i.apply(e,r)}),t.signal.addEventListener("abort",o)}}return V}e.exports=k,e.exports.finished=function(e,t){var r;let i=!1;return null===t&&(t=l),null!==(r=t)&&void 0!==r&&r.cleanup&&(f(t.cleanup,"cleanup"),i=t.cleanup),new p((r,n)=>{let o=k(e,t,e=>{i&&o(),e?n(e):r()})})}},24545:function(e,t,r){"use strict";let i=r(34155),{PromisePrototypeThen:n,SymbolAsyncIterator:o,SymbolIterator:a}=r(57156),{Buffer:s}=r(48764),{ERR_INVALID_ARG_TYPE:l,ERR_STREAM_NULL_VALUES:d}=r(64385).codes;e.exports=function(e,t,r){let u,c;if("string"==typeof t||t instanceof s)return new e({objectMode:!0,...r,read(){this.push(t),this.push(null)}});if(t&&t[o])c=!0,u=t[o]();else if(t&&t[a])c=!1,u=t[a]();else throw new l("iterable",["Iterable"],t);let h=new e({objectMode:!0,highWaterMark:1,...r}),f=!1;async function p(e){let t=null!=e,r="function"==typeof u.throw;if(t&&r){let{value:t,done:r}=await u.throw(e);if(await t,r)return}if("function"==typeof u.return){let{value:e}=await u.return();await e}}async function b(){for(;;){try{let{value:e,done:t}=c?await u.next():u.next();if(t)h.push(null);else{let t=e&&"function"==typeof e.then?await e:e;if(null===t)throw f=!1,new d;if(h.push(t))continue;f=!1}}catch(e){h.destroy(e)}break}}return h._read=function(){f||(f=!0,b())},h._destroy=function(e,t){n(p(e),()=>i.nextTick(t,e),r=>i.nextTick(t,r||e))},h}},85484:function(e,t,r){"use strict";let{ArrayIsArray:i,ObjectSetPrototypeOf:n}=r(57156),{EventEmitter:o}=r(17187);function a(e){o.call(this,e)}function s(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?i(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}n(a.prototype,o.prototype),n(a,o),a.prototype.pipe=function(e,t){let r=this;function i(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function n(){r.readable&&r.resume&&r.resume()}r.on("data",i),e.on("drain",n),e._isStdio||t&&!1===t.end||(r.on("end",l),r.on("close",d));let a=!1;function l(){a||(a=!0,e.end())}function d(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){c(),0===o.listenerCount(this,"error")&&this.emit("error",e)}function c(){r.removeListener("data",i),e.removeListener("drain",n),r.removeListener("end",l),r.removeListener("close",d),r.removeListener("error",u),e.removeListener("error",u),r.removeListener("end",c),r.removeListener("close",c),e.removeListener("close",c)}return s(r,"error",u),s(e,"error",u),r.on("end",c),r.on("close",c),e.on("close",c),e.emit("pipe",r),e},e.exports={Stream:a,prependListener:s}},27715:function(e,t,r){"use strict";let i=globalThis.AbortController||r(28599).AbortController,{codes:{ERR_INVALID_ARG_VALUE:n,ERR_INVALID_ARG_TYPE:o,ERR_MISSING_ARGS:a,ERR_OUT_OF_RANGE:s},AbortError:l}=r(64385),{validateAbortSignal:d,validateInteger:u,validateObject:c}=r(8055),h=r(57156).Symbol("kWeak"),{finished:f}=r(94906),p=r(96171),{addAbortSignalNoValidate:b}=r(32264),{isWritable:y,isNodeStream:g}=r(66909),{ArrayPrototypePush:w,MathFloor:m,Number:_,NumberIsNaN:v,Promise:S,PromiseReject:E,PromisePrototypeThen:A,Symbol:T}=r(57156),R=T("kEmpty"),C=T("kEof");function D(e,t){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);null!=t&&c(t,"options"),(null==t?void 0:t.signal)!=null&&d(t.signal,"options.signal");let r=1;return(null==t?void 0:t.concurrency)!=null&&(r=m(t.concurrency)),u(r,"concurrency",1),(async function*(){var n,o;let a,s;let d=new i,u=this,c=[],h=d.signal,f={signal:h},p=()=>d.abort();null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted&&p(),null==t||null===(o=t.signal)||void 0===o||o.addEventListener("abort",p);let b=!1;function y(){b=!0}(async function(){var i,n;try{for await(let t of u){if(b)return;if(h.aborted)throw new l;try{t=e(t,f)}catch(e){t=E(e)}t!==R&&("function"==typeof(null===(i=t)||void 0===i?void 0:i.catch)&&t.catch(y),c.push(t),a&&(a(),a=null),!b&&c.length&&c.length>=r&&await new S(e=>{s=e}))}c.push(C)}catch(t){let e=E(t);A(e,void 0,y),c.push(e)}finally{b=!0,a&&(a(),a=null),null==t||null===(n=t.signal)||void 0===n||n.removeEventListener("abort",p)}})();try{for(;;){for(;c.length>0;){let e=await c[0];if(e===C)return;if(h.aborted)throw new l;e!==R&&(yield e),c.shift(),s&&(s(),s=null)}await new S(e=>{a=e})}}finally{d.abort(),b=!0,s&&(s(),s=null)}}).call(this)}async function M(e,t){for await(let r of O.call(this,e,t))return!0;return!1}async function I(e,t){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);return!await M.call(this,async(...t)=>!await e(...t),t)}async function k(e,t){for await(let r of O.call(this,e,t))return r}async function P(e,t){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);async function r(t,r){return await e(t,r),R}for await(let e of D.call(this,r,t));}function O(e,t){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);async function r(t,r){return await e(t,r)?t:R}return D.call(this,r,t)}class N extends a{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function L(e,t,r){var n,a;if("function"!=typeof e)throw new o("reducer",["Function","AsyncFunction"],e);null!=r&&c(r,"options"),(null==r?void 0:r.signal)!=null&&d(r.signal,"options.signal");let s=arguments.length>1;if(null!=r&&null!==(n=r.signal)&&void 0!==n&&n.aborted){let e=new l(void 0,{cause:r.signal.reason});throw this.once("error",()=>{}),await f(this.destroy(e)),e}let u=new i,p=u.signal;null!=r&&r.signal&&r.signal.addEventListener("abort",()=>u.abort(),{once:!0,[h]:this});let b=!1;try{for await(let i of this){if(b=!0,null!=r&&null!==(a=r.signal)&&void 0!==a&&a.aborted)throw new l;s?t=await e(t,i,{signal:p}):(t=i,s=!0)}if(!b&&!s)throw new N}finally{u.abort()}return t}async function U(e){null!=e&&c(e,"options"),(null==e?void 0:e.signal)!=null&&d(e.signal,"options.signal");let t=[];for await(let i of this){var r;if(null!=e&&null!==(r=e.signal)&&void 0!==r&&r.aborted)throw new l(void 0,{cause:e.signal.reason});w(t,i)}return t}function x(e){if(v(e=_(e)))return 0;if(e<0)throw new s("number",">= 0",e);return e}e.exports.streamReturningOperators={asIndexedPairs:function(e){return null!=e&&c(e,"options"),(null==e?void 0:e.signal)!=null&&d(e.signal,"options.signal"),(async function*(){let t=0;for await(let i of this){var r;if(null!=e&&null!==(r=e.signal)&&void 0!==r&&r.aborted)throw new l({cause:e.signal.reason});yield[t++,i]}}).call(this)},drop:function(e,t){return null!=t&&c(t,"options"),(null==t?void 0:t.signal)!=null&&d(t.signal,"options.signal"),e=x(e),(async function*(){var r,i;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new l;for await(let r of this){if(null!=t&&null!==(i=t.signal)&&void 0!==i&&i.aborted)throw new l;e--<=0&&(yield r)}}).call(this)},filter:O,flatMap:function(e,t){let r=D.call(this,e,t);return(async function*(){for await(let e of r)yield*e}).call(this)},map:D,take:function(e,t){return null!=t&&c(t,"options"),(null==t?void 0:t.signal)!=null&&d(t.signal,"options.signal"),e=x(e),(async function*(){var r,i;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new l;for await(let r of this){if(null!=t&&null!==(i=t.signal)&&void 0!==i&&i.aborted)throw new l;if(!(e-- >0))return;yield r}}).call(this)},compose:function(e,t){if(null!=t&&c(t,"options"),(null==t?void 0:t.signal)!=null&&d(t.signal,"options.signal"),g(e)&&!y(e))throw new n("stream",e,"must be writable");let r=p(this,e);return null!=t&&t.signal&&b(t.signal,r),r}},e.exports.promiseReturningOperators={every:I,forEach:P,reduce:L,toArray:U,some:M,find:k}},23058:function(e,t,r){"use strict";let{ObjectSetPrototypeOf:i}=r(57156);e.exports=o;let n=r(88393);function o(e){if(!(this instanceof o))return new o(e);n.call(this,e)}i(o.prototype,n.prototype),i(o,n),o.prototype._transform=function(e,t,r){r(null,e)}},6729:function(e,t,r){let i,n;"use strict";let o=r(34155),{ArrayIsArray:a,Promise:s,SymbolAsyncIterator:l}=r(57156),d=r(94906),{once:u}=r(70780),c=r(39201),h=r(96665),{aggregateTwoErrors:f,codes:{ERR_INVALID_ARG_TYPE:p,ERR_INVALID_RETURN_VALUE:b,ERR_MISSING_ARGS:y,ERR_STREAM_DESTROYED:g,ERR_STREAM_PREMATURE_CLOSE:w},AbortError:m}=r(64385),{validateFunction:_,validateAbortSignal:v}=r(8055),{isIterable:S,isReadable:E,isReadableNodeStream:A,isNodeStream:T,isTransformStream:R,isWebStream:C,isReadableStream:D,isReadableEnded:M}=r(66909),I=globalThis.AbortController||r(28599).AbortController;function k(e,t,r){let i=!1;return e.on("close",()=>{i=!0}),{destroy:t=>{i||(i=!0,c.destroyer(e,t||new g("pipe")))},cleanup:d(e,{readable:t,writable:r},e=>{i=!e})}}function P(e){if(S(e))return e;if(A(e))return O(e);throw new p("val",["Readable","Iterable","AsyncIterable"],e)}async function*O(e){n||(n=r(47950)),yield*n.prototype[l].call(e)}async function N(e,t,r,{end:i}){let n;let o=null,a=e=>{if(e&&(n=e),o){let e=o;o=null,e()}},l=()=>new s((e,t)=>{n?t(n):o=()=>{n?t(n):e()}});t.on("drain",a);let u=d(t,{readable:!1},a);try{for await(let r of(t.writableNeedDrain&&await l(),e))t.write(r)||await l();i&&t.end(),await l(),r()}catch(e){r(n!==e?f(n,e):e)}finally{u(),t.off("drain",a)}}async function L(e,t,r,{end:i}){R(t)&&(t=t.writable);let n=t.getWriter();try{for await(let t of e)await n.ready,n.write(t).catch(()=>{});await n.ready,i&&await n.close(),r()}catch(e){try{await n.abort(e),r(e)}catch(e){r(e)}}}function U(e,t,n){let s,l,u;if(1===e.length&&a(e[0])&&(e=e[0]),e.length<2)throw new y("streams");let c=new I,f=c.signal,g=null==n?void 0:n.signal,_=[];function O(){W(new m)}v(g,"options.signal"),null==g||g.addEventListener("abort",O);let U=[],x=0;function B(e){W(e,0==--x)}function W(e,r){if(e&&(!s||"ERR_STREAM_PREMATURE_CLOSE"===s.code)&&(s=e),s||r){for(;U.length;)U.shift()(s);null==g||g.removeEventListener("abort",O),c.abort(),r&&(s||_.forEach(e=>e()),o.nextTick(t,s,l))}}for(let t=0;t<e.length;t++){let a=e[t],s=t<e.length-1,c=t>0,y=s||(null==n?void 0:n.end)!==!1,g=t===e.length-1;if(T(a)){if(y){let{destroy:e,cleanup:t}=k(a,s,c);U.push(e),E(a)&&g&&_.push(t)}function j(e){e&&"AbortError"!==e.name&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code&&B(e)}a.on("error",j),E(a)&&g&&_.push(()=>{a.removeListener("error",j)})}if(0===t){if("function"==typeof a){if(!S(u=a({signal:f})))throw new b("Iterable, AsyncIterable or Stream","source",u)}else u=S(a)||A(a)||R(a)?a:h.from(a)}else if("function"==typeof a){var $,H;if(u=a(u=R(u)?P(null===($=u)||void 0===$?void 0:$.readable):P(u),{signal:f}),s){if(!S(u,!0))throw new b("AsyncIterable",`transform[${t-1}]`,u)}else{i||(i=r(23058));let e=new i({objectMode:!0}),t=null===(H=u)||void 0===H?void 0:H.then;if("function"==typeof t)x++,t.call(u,t=>{l=t,null!=t&&e.write(t),y&&e.end(),o.nextTick(B)},t=>{e.destroy(t),o.nextTick(B,t)});else if(S(u,!0))x++,N(u,e,B,{end:y});else if(D(u)||R(u)){let t=u.readable||u;x++,N(t,e,B,{end:y})}else throw new b("AsyncIterable or Promise","destination",u);let{destroy:n,cleanup:a}=k(u=e,!1,!0);U.push(n),g&&_.push(a)}}else if(T(a)){if(A(u)){x+=2;let e=function(e,t,r,{end:i}){let n=!1;if(t.on("close",()=>{n||r(new w)}),e.pipe(t,{end:!1}),i){function a(){n=!0,t.end()}M(e)?o.nextTick(a):e.once("end",a)}else r();return d(e,{readable:!0,writable:!1},t=>{let i=e._readableState;t&&"ERR_STREAM_PREMATURE_CLOSE"===t.code&&i&&i.ended&&!i.errored&&!i.errorEmitted?e.once("end",r).once("error",r):r(t)}),d(t,{readable:!1,writable:!0},r)}(u,a,B,{end:y});E(a)&&g&&_.push(e)}else if(R(u)||D(u)){let e=u.readable||u;x++,N(e,a,B,{end:y})}else if(S(u))x++,N(u,a,B,{end:y});else throw new p("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],u);u=a}else if(C(a)){if(A(u))x++,L(P(u),a,B,{end:y});else if(D(u)||S(u))x++,L(u,a,B,{end:y});else if(R(u))x++,L(u.readable,a,B,{end:y});else throw new p("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],u);u=a}else u=h.from(a)}return(null!=f&&f.aborted||null!=g&&g.aborted)&&o.nextTick(O),u}e.exports={pipelineImpl:U,pipeline:function(...e){return U(e,u((_(e[e.length-1],"streams[stream.length - 1]"),e.pop())))}}},47950:function(e,t,r){let i;"use strict";let n=r(34155),{ArrayPrototypeIndexOf:o,NumberIsInteger:a,NumberIsNaN:s,NumberParseInt:l,ObjectDefineProperties:d,ObjectKeys:u,ObjectSetPrototypeOf:c,Promise:h,SafeSet:f,SymbolAsyncIterator:p,Symbol:b}=r(57156);e.exports=j,j.ReadableState=W;let{EventEmitter:y}=r(17187),{Stream:g,prependListener:w}=r(85484),{Buffer:m}=r(48764),{addAbortSignal:_}=r(32264),v=r(94906),S=r(70780).debuglog("stream",e=>{S=e}),E=r(57231),A=r(39201),{getHighWaterMark:T,getDefaultHighWaterMark:R}=r(25917),{aggregateTwoErrors:C,codes:{ERR_INVALID_ARG_TYPE:D,ERR_METHOD_NOT_IMPLEMENTED:M,ERR_OUT_OF_RANGE:I,ERR_STREAM_PUSH_AFTER_EOF:k,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:P}}=r(64385),{validateObject:O}=r(8055),N=b("kPaused"),{StringDecoder:L}=r(32553),U=r(24545);c(j.prototype,g.prototype),c(j,g);let x=()=>{},{errorOrDestroy:B}=A;function W(e,t,i){"boolean"!=typeof i&&(i=t instanceof r(96665)),this.objectMode=!!(e&&e.objectMode),i&&(this.objectMode=this.objectMode||!!(e&&e.readableObjectMode)),this.highWaterMark=e?T(this,e,"readableHighWaterMark",i):R(!1),this.buffer=new E,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[N]=null,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,e&&e.encoding&&(this.decoder=new L(e.encoding),this.encoding=e.encoding)}function j(e){if(!(this instanceof j))return new j(e);let t=this instanceof r(96665);this._readableState=new W(e,this,t),e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&!t&&_(e.signal,this)),g.call(this,e),A.construct(this,()=>{this._readableState.needReadable&&F(this,this._readableState)})}function $(e,t,r,i){let n;S("readableAddChunk",t);let o=e._readableState;if(o.objectMode||("string"==typeof t?(r=r||o.defaultEncoding,o.encoding!==r&&(i&&o.encoding?t=m.from(t,r).toString(o.encoding):(t=m.from(t,r),r=""))):t instanceof m?r="":g._isUint8Array(t)?(t=g._uint8ArrayToBuffer(t),r=""):null!=t&&(n=new D("chunk",["string","Buffer","Uint8Array"],t))),n)B(e,n);else if(null===t)o.reading=!1,function(e,t){if(S("onEofChunk"),!t.ended){if(t.decoder){let e=t.decoder.end();e&&e.length&&(t.buffer.push(e),t.length+=t.objectMode?1:e.length)}t.ended=!0,t.sync?Z(e):(t.needReadable=!1,t.emittedReadable=!0,V(e))}}(e,o);else if(o.objectMode||t&&t.length>0){if(i){if(o.endEmitted)B(e,new P);else{if(o.destroyed||o.errored)return!1;H(e,o,t,!0)}}else if(o.ended)B(e,new k);else{if(o.destroyed||o.errored)return!1;o.reading=!1,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?H(e,o,t,!1):F(e,o)):H(e,o,t,!1)}}else i||(o.reading=!1,F(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function H(e,t,r,i){t.flowing&&0===t.length&&!t.sync&&e.listenerCount("data")>0?(t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null,t.dataEmitted=!0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&Z(e)),F(e,t)}function K(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:s(e)?t.flowing&&t.length?t.buffer.first().length:t.length:e<=t.length?e:t.ended?t.length:0}function Z(e){let t=e._readableState;S("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(S("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(V,e))}function V(e){let t=e._readableState;S("emitReadable_",t.destroyed,t.length,t.ended),!t.destroyed&&!t.errored&&(t.length||t.ended)&&(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,z(e)}function F(e,t){!t.readingMore&&t.constructed&&(t.readingMore=!0,n.nextTick(q,e,t))}function q(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){let r=t.length;if(S("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function G(e){let t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!1===t[N]?t.flowing=!0:e.listenerCount("data")>0?e.resume():t.readableListening||(t.flowing=null)}function Y(e){S("readable nexttick read 0"),e.read(0)}function X(e,t){S("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),z(e),t.flowing&&!t.reading&&e.read(0)}function z(e){let t=e._readableState;for(S("flow",t.flowing);t.flowing&&null!==e.read(););}function J(e,t){"function"!=typeof e.read&&(e=j.wrap(e,{objectMode:!0}));let r=Q(e,t);return r.stream=e,r}async function*Q(e,t){let r,i=x;function n(t){this===e?(i(),i=x):i=t}e.on("readable",n);let o=v(e,{writable:!1},e=>{r=e?C(r,e):null,i(),i=x});try{for(;;){let t=e.destroyed?null:e.read();if(null!==t)yield t;else if(r)throw r;else{if(null===r)return;await new h(n)}}}catch(e){throw r=C(r,e)}finally{(r||(null==t?void 0:t.destroyOnReturn)!==!1)&&(void 0===r||e._readableState.autoDestroy)?A.destroyer(e,null):(e.off("readable",n),o())}}function ee(e,t){let r;return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r)}function et(e){let t=e._readableState;S("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(er,t,e))}function er(e,t){if(S("endReadableNT",e.endEmitted,e.length),!e.errored&&!e.closeEmitted&&!e.endEmitted&&0===e.length){if(e.endEmitted=!0,t.emit("end"),t.writable&&!1===t.allowHalfOpen)n.nextTick(ei,t);else if(e.autoDestroy){let e=t._writableState;(!e||e.autoDestroy&&(e.finished||!1===e.writable))&&t.destroy()}}}function ei(e){!e.writable||e.writableEnded||e.destroyed||e.end()}function en(){return void 0===i&&(i={}),i}j.prototype.destroy=A.destroy,j.prototype._undestroy=A.undestroy,j.prototype._destroy=function(e,t){t(e)},j.prototype[y.captureRejectionSymbol]=function(e){this.destroy(e)},j.prototype.push=function(e,t){return $(this,e,t,!1)},j.prototype.unshift=function(e,t){return $(this,e,t,!0)},j.prototype.isPaused=function(){let e=this._readableState;return!0===e[N]||!1===e.flowing},j.prototype.setEncoding=function(e){let t=new L(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;let r=this._readableState.buffer,i="";for(let e of r)i+=t.write(e);return r.clear(),""!==i&&r.push(i),this._readableState.length=i.length,this},j.prototype.read=function(e){let t;S("read",e),void 0===e?e=NaN:a(e)||(e=l(e,10));let r=this._readableState,i=e;if(e>r.highWaterMark&&(r.highWaterMark=function(e){if(e>1073741824)throw new I("size","<= 1GiB",e);return e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e}(e)),0!==e&&(r.emittedReadable=!1),0===e&&r.needReadable&&((0!==r.highWaterMark?r.length>=r.highWaterMark:r.length>0)||r.ended))return S("read: emitReadable",r.length,r.ended),0===r.length&&r.ended?et(this):Z(this),null;if(0===(e=K(e,r))&&r.ended)return 0===r.length&&et(this),null;let n=r.needReadable;if(S("need readable",n),(0===r.length||r.length-e<r.highWaterMark)&&S("length less than watermark",n=!0),r.ended||r.reading||r.destroyed||r.errored||!r.constructed)S("reading, ended or constructing",n=!1);else if(n){S("do read"),r.reading=!0,r.sync=!0,0===r.length&&(r.needReadable=!0);try{this._read(r.highWaterMark)}catch(e){B(this,e)}r.sync=!1,r.reading||(e=K(i,r))}return null===(t=e>0?ee(e,r):null)?(r.needReadable=r.length<=r.highWaterMark,e=0):(r.length-=e,r.multiAwaitDrain?r.awaitDrainWriters.clear():r.awaitDrainWriters=null),0===r.length&&(r.ended||(r.needReadable=!0),i!==e&&r.ended&&et(this)),null===t||r.errorEmitted||r.closeEmitted||(r.dataEmitted=!0,this.emit("data",t)),t},j.prototype._read=function(e){throw new M("_read()")},j.prototype.pipe=function(e,t){let r;let i=this,o=this._readableState;1!==o.pipes.length||o.multiAwaitDrain||(o.multiAwaitDrain=!0,o.awaitDrainWriters=new f(o.awaitDrainWriters?[o.awaitDrainWriters]:[])),o.pipes.push(e),S("pipe count=%d opts=%j",o.pipes.length,t);let a=t&&!1===t.end||e===n.stdout||e===n.stderr?b:s;function s(){S("onend"),e.end()}o.endEmitted?n.nextTick(a):i.once("end",a),e.on("unpipe",function t(n,a){S("onunpipe"),n===i&&a&&!1===a.hasUnpiped&&(a.hasUnpiped=!0,S("cleanup"),e.removeListener("close",h),e.removeListener("finish",p),r&&e.removeListener("drain",r),e.removeListener("error",c),e.removeListener("unpipe",t),i.removeListener("end",s),i.removeListener("end",b),i.removeListener("data",u),l=!0,r&&o.awaitDrainWriters&&(!e._writableState||e._writableState.needDrain)&&r())});let l=!1;function d(){l||(1===o.pipes.length&&o.pipes[0]===e?(S("false write response, pause",0),o.awaitDrainWriters=e,o.multiAwaitDrain=!1):o.pipes.length>1&&o.pipes.includes(e)&&(S("false write response, pause",o.awaitDrainWriters.size),o.awaitDrainWriters.add(e)),i.pause()),r||(r=function(){let t=i._readableState;t.awaitDrainWriters===e?(S("pipeOnDrain",1),t.awaitDrainWriters=null):t.multiAwaitDrain&&(S("pipeOnDrain",t.awaitDrainWriters.size),t.awaitDrainWriters.delete(e)),(!t.awaitDrainWriters||0===t.awaitDrainWriters.size)&&i.listenerCount("data")&&i.resume()},e.on("drain",r))}function u(t){S("ondata");let r=e.write(t);S("dest.write",r),!1===r&&d()}function c(t){if(S("onerror",t),b(),e.removeListener("error",c),0===e.listenerCount("error")){let r=e._writableState||e._readableState;r&&!r.errorEmitted?B(e,t):e.emit("error",t)}}function h(){e.removeListener("finish",p),b()}function p(){S("onfinish"),e.removeListener("close",h),b()}function b(){S("unpipe"),i.unpipe(e)}return i.on("data",u),w(e,"error",c),e.once("close",h),e.once("finish",p),e.emit("pipe",i),!0===e.writableNeedDrain?o.flowing&&d():o.flowing||(S("pipe resume"),i.resume()),e},j.prototype.unpipe=function(e){let t=this._readableState;if(0===t.pipes.length)return this;if(!e){let e=t.pipes;t.pipes=[],this.pause();for(let t=0;t<e.length;t++)e[t].emit("unpipe",this,{hasUnpiped:!1});return this}let r=o(t.pipes,e);return -1===r||(t.pipes.splice(r,1),0===t.pipes.length&&this.pause(),e.emit("unpipe",this,{hasUnpiped:!1})),this},j.prototype.on=function(e,t){let r=g.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"!==e||i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,S("on readable",i.length,i.reading),i.length?Z(this):i.reading||n.nextTick(Y,this)),r},j.prototype.addListener=j.prototype.on,j.prototype.removeListener=function(e,t){let r=g.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(G,this),r},j.prototype.off=j.prototype.removeListener,j.prototype.removeAllListeners=function(e){let t=g.prototype.removeAllListeners.apply(this,arguments);return("readable"===e||void 0===e)&&n.nextTick(G,this),t},j.prototype.resume=function(){let e=this._readableState;return e.flowing||(S("resume"),e.flowing=!e.readableListening,e.resumeScheduled||(e.resumeScheduled=!0,n.nextTick(X,this,e))),e[N]=!1,this},j.prototype.pause=function(){return S("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(S("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[N]=!0,this},j.prototype.wrap=function(e){let t=!1;e.on("data",r=>{!this.push(r)&&e.pause&&(t=!0,e.pause())}),e.on("end",()=>{this.push(null)}),e.on("error",e=>{B(this,e)}),e.on("close",()=>{this.destroy()}),e.on("destroy",()=>{this.destroy()}),this._read=()=>{t&&e.resume&&(t=!1,e.resume())};let r=u(e);for(let t=1;t<r.length;t++){let i=r[t];void 0===this[i]&&"function"==typeof e[i]&&(this[i]=e[i].bind(e))}return this},j.prototype[p]=function(){return J(this)},j.prototype.iterator=function(e){return void 0!==e&&O(e,"options"),J(this,e)},d(j.prototype,{readable:{__proto__:null,get(){let e=this._readableState;return!!e&&!1!==e.readable&&!e.destroyed&&!e.errorEmitted&&!e.endEmitted},set(e){this._readableState&&(this._readableState.readable=!!e)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(!1!==this._readableState.readable&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return!!this._readableState&&this._readableState.closed}},destroyed:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.destroyed},set(e){this._readableState&&(this._readableState.destroyed=e)}},readableEnded:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.endEmitted}}}),d(W.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return!1!==this[N]},set(e){this[N]=!!e}}}),j._fromList=ee,j.from=function(e,t){return U(j,e,t)},j.fromWeb=function(e,t){return en().newStreamReadableFromReadableStream(e,t)},j.toWeb=function(e,t){return en().newReadableStreamFromStreamReadable(e,t)},j.wrap=function(e,t){var r,i;return new j({objectMode:null===(r=null!==(i=e.readableObjectMode)&&void 0!==i?i:e.objectMode)||void 0===r||r,...t,destroy(t,r){A.destroyer(e,t),r(t)}}).wrap(e)}},25917:function(e,t,r){"use strict";let{MathFloor:i,NumberIsInteger:n}=r(57156),{ERR_INVALID_ARG_VALUE:o}=r(64385).codes;function a(e){return e?16:16384}e.exports={getHighWaterMark:function(e,t,r,s){let l=null!=t.highWaterMark?t.highWaterMark:s?t[r]:null;if(null!=l){if(!n(l)||l<0)throw new o(s?`options.${r}`:"options.highWaterMark",l);return i(l)}return a(e.objectMode)},getDefaultHighWaterMark:a}},88393:function(e,t,r){"use strict";let{ObjectSetPrototypeOf:i,Symbol:n}=r(57156);e.exports=d;let{ERR_METHOD_NOT_IMPLEMENTED:o}=r(64385).codes,a=r(96665),{getHighWaterMark:s}=r(25917);i(d.prototype,a.prototype),i(d,a);let l=n("kCallback");function d(e){if(!(this instanceof d))return new d(e);let t=e?s(this,e,"readableHighWaterMark",!0):null;0===t&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),a.call(this,e),this._readableState.sync=!1,this[l]=null,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",c)}function u(e){"function"!=typeof this._flush||this.destroyed?(this.push(null),e&&e()):this._flush((t,r)=>{if(t){e?e(t):this.destroy(t);return}null!=r&&this.push(r),this.push(null),e&&e()})}function c(){this._final!==u&&u.call(this)}d.prototype._final=u,d.prototype._transform=function(e,t,r){throw new o("_transform()")},d.prototype._write=function(e,t,r){let i=this._readableState,n=this._writableState,o=i.length;this._transform(e,t,(e,t)=>{if(e){r(e);return}null!=t&&this.push(t),n.ended||o===i.length||i.length<i.highWaterMark?r():this[l]=r})},d.prototype._read=function(){if(this[l]){let e=this[l];this[l]=null,e()}}},66909:function(e,t,r){"use strict";let{Symbol:i,SymbolAsyncIterator:n,SymbolIterator:o,SymbolFor:a}=r(57156),s=i("kDestroyed"),l=i("kIsErrored"),d=i("kIsReadable"),u=i("kIsDisturbed"),c=a("nodejs.webstream.isClosedPromise"),h=a("nodejs.webstream.controllerErrorFunction");function f(e,t=!1){var r;return!!(e&&"function"==typeof e.pipe&&"function"==typeof e.on&&(!t||"function"==typeof e.pause&&"function"==typeof e.resume)&&(!e._writableState||(null===(r=e._readableState)||void 0===r?void 0:r.readable)!==!1)&&(!e._writableState||e._readableState))}function p(e){var t;return!!(e&&"function"==typeof e.write&&"function"==typeof e.on&&(!e._readableState||(null===(t=e._writableState)||void 0===t?void 0:t.writable)!==!1))}function b(e){return e&&(e._readableState||e._writableState||"function"==typeof e.write&&"function"==typeof e.on||"function"==typeof e.pipe&&"function"==typeof e.on)}function y(e){return!!(e&&!b(e)&&"function"==typeof e.pipeThrough&&"function"==typeof e.getReader&&"function"==typeof e.cancel)}function g(e){return!!(e&&!b(e)&&"function"==typeof e.getWriter&&"function"==typeof e.abort)}function w(e){return!!(e&&!b(e)&&"object"==typeof e.readable&&"object"==typeof e.writable)}function m(e){if(!b(e))return null;let t=e._writableState,r=e._readableState,i=t||r;return!!(e.destroyed||e[s]||null!=i&&i.destroyed)}function _(e){if(!p(e))return null;if(!0===e.writableEnded)return!0;let t=e._writableState;return(null==t||!t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)}function v(e,t){if(!f(e))return null;let r=e._readableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.endEmitted)?null:!!(r.endEmitted||!1===t&&!0===r.ended&&0===r.length))}function S(e){return e&&null!=e[d]?e[d]:"boolean"!=typeof(null==e?void 0:e.readable)?null:!m(e)&&f(e)&&e.readable&&!v(e)}function E(e){return"boolean"!=typeof(null==e?void 0:e.writable)?null:!m(e)&&p(e)&&e.writable&&!_(e)}function A(e){return"boolean"==typeof e._closed&&"boolean"==typeof e._defaultKeepAlive&&"boolean"==typeof e._removedConnection&&"boolean"==typeof e._removedContLen}function T(e){return"boolean"==typeof e._sent100&&A(e)}e.exports={kDestroyed:s,isDisturbed:function(e){var t;return!!(e&&(null!==(t=e[u])&&void 0!==t?t:e.readableDidRead||e.readableAborted))},kIsDisturbed:u,isErrored:function(e){var t,r,i,n,o,a,s,d,u,c;return!!(e&&(null!==(t=null!==(r=null!==(i=null!==(n=null!==(o=null!==(a=e[l])&&void 0!==a?a:e.readableErrored)&&void 0!==o?o:e.writableErrored)&&void 0!==n?n:null===(s=e._readableState)||void 0===s?void 0:s.errorEmitted)&&void 0!==i?i:null===(d=e._writableState)||void 0===d?void 0:d.errorEmitted)&&void 0!==r?r:null===(u=e._readableState)||void 0===u?void 0:u.errored)&&void 0!==t?t:null===(c=e._writableState)||void 0===c?void 0:c.errored))},kIsErrored:l,isReadable:S,kIsReadable:d,kIsClosedPromise:c,kControllerErrorFunction:h,isClosed:function(e){if(!b(e))return null;if("boolean"==typeof e.closed)return e.closed;let t=e._writableState,r=e._readableState;return"boolean"==typeof(null==t?void 0:t.closed)||"boolean"==typeof(null==r?void 0:r.closed)?(null==t?void 0:t.closed)||(null==r?void 0:r.closed):"boolean"==typeof e._closed&&A(e)?e._closed:null},isDestroyed:m,isDuplexNodeStream:function(e){return!!(e&&"function"==typeof e.pipe&&e._readableState&&"function"==typeof e.on&&"function"==typeof e.write)},isFinished:function(e,t){return b(e)?!!m(e)||!((null==t?void 0:t.readable)!==!1&&S(e)||(null==t?void 0:t.writable)!==!1&&E(e)):null},isIterable:function(e,t){return null!=e&&(!0===t?"function"==typeof e[n]:!1===t?"function"==typeof e[o]:"function"==typeof e[n]||"function"==typeof e[o])},isReadableNodeStream:f,isReadableStream:y,isReadableEnded:function(e){if(!f(e))return null;if(!0===e.readableEnded)return!0;let t=e._readableState;return!!t&&!t.errored&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)},isReadableFinished:v,isReadableErrored:function(e){var t,r;return b(e)?e.readableErrored?e.readableErrored:null!==(t=null===(r=e._readableState)||void 0===r?void 0:r.errored)&&void 0!==t?t:null:null},isNodeStream:b,isWebStream:function(e){return y(e)||g(e)||w(e)},isWritable:E,isWritableNodeStream:p,isWritableStream:g,isWritableEnded:_,isWritableFinished:function(e,t){if(!p(e))return null;if(!0===e.writableFinished)return!0;let r=e._writableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.finished)?null:!!(r.finished||!1===t&&!0===r.ended&&0===r.length))},isWritableErrored:function(e){var t,r;return b(e)?e.writableErrored?e.writableErrored:null!==(t=null===(r=e._writableState)||void 0===r?void 0:r.errored)&&void 0!==t?t:null:null},isServerRequest:function(e){var t;return"boolean"==typeof e._consuming&&"boolean"==typeof e._dumped&&(null===(t=e.req)||void 0===t?void 0:t.upgradeOrConnect)===void 0},isServerResponse:T,willEmitClose:function(e){if(!b(e))return null;let t=e._writableState,r=e._readableState,i=t||r;return!i&&T(e)||!!(i&&i.autoDestroy&&i.emitClose&&!1===i.closed)},isTransformStream:w}},39713:function(e,t,r){let i;"use strict";let n=r(34155),{ArrayPrototypeSlice:o,Error:a,FunctionPrototypeSymbolHasInstance:s,ObjectDefineProperty:l,ObjectDefineProperties:d,ObjectSetPrototypeOf:u,StringPrototypeToLowerCase:c,Symbol:h,SymbolHasInstance:f}=r(57156);e.exports=L,L.WritableState=O;let{EventEmitter:p}=r(17187),b=r(85484).Stream,{Buffer:y}=r(48764),g=r(39201),{addAbortSignal:w}=r(32264),{getHighWaterMark:m,getDefaultHighWaterMark:_}=r(25917),{ERR_INVALID_ARG_TYPE:v,ERR_METHOD_NOT_IMPLEMENTED:S,ERR_MULTIPLE_CALLBACK:E,ERR_STREAM_CANNOT_PIPE:A,ERR_STREAM_DESTROYED:T,ERR_STREAM_ALREADY_FINISHED:R,ERR_STREAM_NULL_VALUES:C,ERR_STREAM_WRITE_AFTER_END:D,ERR_UNKNOWN_ENCODING:M}=r(64385).codes,{errorOrDestroy:I}=g;function k(){}u(L.prototype,b.prototype),u(L,b);let P=h("kOnFinished");function O(e,t,i){"boolean"!=typeof i&&(i=t instanceof r(96665)),this.objectMode=!!(e&&e.objectMode),i&&(this.objectMode=this.objectMode||!!(e&&e.writableObjectMode)),this.highWaterMark=e?m(this,e,"writableHighWaterMark",i):_(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;let n=!!(e&&!1===e.decodeStrings);this.decodeStrings=!n,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=W.bind(void 0,t),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,N(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[P]=[]}function N(e){e.buffered=[],e.bufferedIndex=0,e.allBuffers=!0,e.allNoop=!0}function L(e){let t=this instanceof r(96665);if(!t&&!s(L,this))return new L(e);this._writableState=new O(e,this,t),e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&w(e.signal,this)),b.call(this,e),g.construct(this,()=>{let e=this._writableState;e.writing||K(this,e),V(this,e)})}function U(e,t,r,i){let o;let a=e._writableState;if("function"==typeof r)i=r,r=a.defaultEncoding;else{if(r){if("buffer"!==r&&!y.isEncoding(r))throw new M(r)}else r=a.defaultEncoding;"function"!=typeof i&&(i=k)}if(null===t)throw new C;if(!a.objectMode){if("string"==typeof t)!1!==a.decodeStrings&&(t=y.from(t,r),r="buffer");else if(t instanceof y)r="buffer";else if(b._isUint8Array(t))t=b._uint8ArrayToBuffer(t),r="buffer";else throw new v("chunk",["string","Buffer","Uint8Array"],t)}return(a.ending?o=new D:a.destroyed&&(o=new T("write")),o)?(n.nextTick(i,o),I(e,o,!0),o):(a.pendingcb++,function(e,t,r,i,n){let o=t.objectMode?1:r.length;t.length+=o;let a=t.length<t.highWaterMark;return a||(t.needDrain=!0),t.writing||t.corked||t.errored||!t.constructed?(t.buffered.push({chunk:r,encoding:i,callback:n}),t.allBuffers&&"buffer"!==i&&(t.allBuffers=!1),t.allNoop&&n!==k&&(t.allNoop=!1)):(t.writelen=o,t.writecb=n,t.writing=!0,t.sync=!0,e._write(r,i,t.onwrite),t.sync=!1),a&&!t.errored&&!t.destroyed}(e,a,t,r,i))}function x(e,t,r,i,n,o,a){t.writelen=i,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new T("write")):r?e._writev(n,t.onwrite):e._write(n,o,t.onwrite),t.sync=!1}function B(e,t,r,i){--t.pendingcb,i(r),H(t),I(e,r)}function W(e,t){let r=e._writableState,i=r.sync,o=r.writecb;if("function"!=typeof o){I(e,new E);return}r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0,t?(t.stack,r.errored||(r.errored=t),e._readableState&&!e._readableState.errored&&(e._readableState.errored=t),i?n.nextTick(B,e,r,t,o):B(e,r,t,o)):(r.buffered.length>r.bufferedIndex&&K(e,r),i?null!==r.afterWriteTickInfo&&r.afterWriteTickInfo.cb===o?r.afterWriteTickInfo.count++:(r.afterWriteTickInfo={count:1,cb:o,stream:e,state:r},n.nextTick(j,r.afterWriteTickInfo)):$(e,r,1,o))}function j({stream:e,state:t,count:r,cb:i}){return t.afterWriteTickInfo=null,$(e,t,r,i)}function $(e,t,r,i){for(t.ending||e.destroyed||0!==t.length||!t.needDrain||(t.needDrain=!1,e.emit("drain"));r-- >0;)t.pendingcb--,i();t.destroyed&&H(t),V(e,t)}function H(e){var t,r;if(e.writing)return;for(let r=e.bufferedIndex;r<e.buffered.length;++r){let{chunk:i,callback:n}=e.buffered[r],o=e.objectMode?1:i.length;e.length-=o,n(null!==(t=e.errored)&&void 0!==t?t:new T("write"))}let i=e[P].splice(0);for(let t=0;t<i.length;t++)i[t](null!==(r=e.errored)&&void 0!==r?r:new T("end"));N(e)}function K(e,t){if(t.corked||t.bufferProcessing||t.destroyed||!t.constructed)return;let{buffered:r,bufferedIndex:i,objectMode:n}=t,a=r.length-i;if(!a)return;let s=i;if(t.bufferProcessing=!0,a>1&&e._writev){t.pendingcb-=a-1;let i=t.allNoop?k:e=>{for(let t=s;t<r.length;++t)r[t].callback(e)},n=t.allNoop&&0===s?r:o(r,s);n.allBuffers=t.allBuffers,x(e,t,!0,t.length,n,"",i),N(t)}else{do{let{chunk:i,encoding:o,callback:a}=r[s];r[s++]=null,x(e,t,!1,n?1:i.length,i,o,a)}while(s<r.length&&!t.writing);s===r.length?N(t):s>256?(r.splice(0,s),t.bufferedIndex=0):t.bufferedIndex=s}t.bufferProcessing=!1}function Z(e){return e.ending&&!e.destroyed&&e.constructed&&0===e.length&&!e.errored&&0===e.buffered.length&&!e.finished&&!e.writing&&!e.errorEmitted&&!e.closeEmitted}function V(e,t,r){Z(t)&&(t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.finalCalled=!0,function(e,t){let r=!1;function i(i){if(r){I(e,null!=i?i:E());return}if(r=!0,t.pendingcb--,i){let r=t[P].splice(0);for(let e=0;e<r.length;e++)r[e](i);I(e,i,t.sync)}else Z(t)&&(t.prefinished=!0,e.emit("prefinish"),t.pendingcb++,n.nextTick(F,e,t))}t.sync=!0,t.pendingcb++;try{e._final(i)}catch(e){i(e)}t.sync=!1}(e,t))),0===t.pendingcb&&(r?(t.pendingcb++,n.nextTick((e,t)=>{Z(t)?F(e,t):t.pendingcb--},e,t)):Z(t)&&(t.pendingcb++,F(e,t))))}function F(e,t){t.pendingcb--,t.finished=!0;let r=t[P].splice(0);for(let e=0;e<r.length;e++)r[e]();if(e.emit("finish"),t.autoDestroy){let t=e._readableState;(!t||t.autoDestroy&&(t.endEmitted||!1===t.readable))&&e.destroy()}}O.prototype.getBuffer=function(){return o(this.buffered,this.bufferedIndex)},l(O.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}}),l(L,f,{__proto__:null,value:function(e){return!!s(this,e)||this===L&&e&&e._writableState instanceof O}}),L.prototype.pipe=function(){I(this,new A)},L.prototype.write=function(e,t,r){return!0===U(this,e,t,r)},L.prototype.cork=function(){this._writableState.corked++},L.prototype.uncork=function(){let e=this._writableState;e.corked&&(e.corked--,e.writing||K(this,e))},L.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=c(e)),!y.isEncoding(e))throw new M(e);return this._writableState.defaultEncoding=e,this},L.prototype._write=function(e,t,r){if(this._writev)this._writev([{chunk:e,encoding:t}],r);else throw new S("_write()")},L.prototype._writev=null,L.prototype.end=function(e,t,r){let i;let o=this._writableState;if("function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e){let r=U(this,e,t);r instanceof a&&(i=r)}return o.corked&&(o.corked=1,this.uncork()),i||(o.errored||o.ending?o.finished?i=new R("end"):o.destroyed&&(i=new T("end")):(o.ending=!0,V(this,o,!0),o.ended=!0)),"function"==typeof r&&(i||o.finished?n.nextTick(r,i):o[P].push(r)),this},d(L.prototype,{closed:{__proto__:null,get(){return!!this._writableState&&this._writableState.closed}},destroyed:{__proto__:null,get(){return!!this._writableState&&this._writableState.destroyed},set(e){this._writableState&&(this._writableState.destroyed=e)}},writable:{__proto__:null,get(){let e=this._writableState;return!!e&&!1!==e.writable&&!e.destroyed&&!e.errored&&!e.ending&&!e.ended},set(e){this._writableState&&(this._writableState.writable=!!e)}},writableFinished:{__proto__:null,get(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{__proto__:null,get(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{__proto__:null,get(){let e=this._writableState;return!!e&&!e.destroyed&&!e.ending&&e.needDrain}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(!1!==this._writableState.writable&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});let q=g.destroy;function G(){return void 0===i&&(i={}),i}L.prototype.destroy=function(e,t){let r=this._writableState;return!r.destroyed&&(r.bufferedIndex<r.buffered.length||r[P].length)&&n.nextTick(H,r),q.call(this,e,t),this},L.prototype._undestroy=g.undestroy,L.prototype._destroy=function(e,t){t(e)},L.prototype[p.captureRejectionSymbol]=function(e){this.destroy(e)},L.fromWeb=function(e,t){return G().newStreamWritableFromWritableStream(e,t)},L.toWeb=function(e){return G().newWritableStreamFromStreamWritable(e)}},8055:function(e,t,r){"use strict";let{ArrayIsArray:i,ArrayPrototypeIncludes:n,ArrayPrototypeJoin:o,ArrayPrototypeMap:a,NumberIsInteger:s,NumberIsNaN:l,NumberMAX_SAFE_INTEGER:d,NumberMIN_SAFE_INTEGER:u,NumberParseInt:c,ObjectPrototypeHasOwnProperty:h,RegExpPrototypeExec:f,String:p,StringPrototypeToUpperCase:b,StringPrototypeTrim:y}=r(57156),{hideStackFrames:g,codes:{ERR_SOCKET_BAD_PORT:w,ERR_INVALID_ARG_TYPE:m,ERR_INVALID_ARG_VALUE:_,ERR_OUT_OF_RANGE:v,ERR_UNKNOWN_SIGNAL:S}}=r(64385),{normalizeEncoding:E}=r(70780),{isAsyncFunction:A,isArrayBufferView:T}=r(70780).types,R={},C=/^[0-7]+$/,D=g((e,t,r=u,i=d)=>{if("number"!=typeof e)throw new m(t,"number",e);if(!s(e))throw new v(t,"an integer",e);if(e<r||e>i)throw new v(t,`>= ${r} && <= ${i}`,e)}),M=g((e,t,r=-2147483648,i=2147483647)=>{if("number"!=typeof e)throw new m(t,"number",e);if(!s(e))throw new v(t,"an integer",e);if(e<r||e>i)throw new v(t,`>= ${r} && <= ${i}`,e)}),I=g((e,t,r=!1)=>{if("number"!=typeof e)throw new m(t,"number",e);if(!s(e))throw new v(t,"an integer",e);let i=r?1:0;if(e<i||e>4294967295)throw new v(t,`>= ${i} && <= 4294967295`,e)});function k(e,t){if("string"!=typeof e)throw new m(t,"string",e)}let P=g((e,t,r)=>{if(!n(r,e))throw new _(t,e,"must be one of: "+o(a(r,e=>"string"==typeof e?`'${e}'`:p(e)),", "))});function O(e,t){if("boolean"!=typeof e)throw new m(t,"boolean",e)}function N(e,t,r){return null!=e&&h(e,t)?e[t]:r}let L=g((e,t,r=null)=>{let n=N(r,"allowArray",!1),o=N(r,"allowFunction",!1);if(!N(r,"nullable",!1)&&null===e||!n&&i(e)||"object"!=typeof e&&(!o||"function"!=typeof e))throw new m(t,"Object",e)}),U=g((e,t)=>{if(null!=e&&"object"!=typeof e&&"function"!=typeof e)throw new m(t,"a dictionary",e)}),x=g((e,t,r=0)=>{if(!i(e))throw new m(t,"Array",e);if(e.length<r)throw new _(t,e,`must be longer than ${r}`)}),B=g((e,t="buffer")=>{if(!T(e))throw new m(t,["Buffer","TypedArray","DataView"],e)}),W=g((e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new m(t,"AbortSignal",e)}),j=g((e,t)=>{if("function"!=typeof e)throw new m(t,"Function",e)}),$=g((e,t)=>{if("function"!=typeof e||A(e))throw new m(t,"Function",e)}),H=g((e,t)=>{if(void 0!==e)throw new m(t,"undefined",e)}),K=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function Z(e,t){if(void 0===e||!f(K,e))throw new _(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}e.exports={isInt32:function(e){return e===(0|e)},isUint32:function(e){return e===e>>>0},parseFileMode:function(e,t,r){if(void 0===e&&(e=r),"string"==typeof e){if(null===f(C,e))throw new _(t,e,"must be a 32-bit unsigned integer or an octal string");e=c(e,8)}return I(e,t),e},validateArray:x,validateStringArray:function(e,t){x(e,t);for(let r=0;r<e.length;r++)k(e[r],`${t}[${r}]`)},validateBooleanArray:function(e,t){x(e,t);for(let r=0;r<e.length;r++)O(e[r],`${t}[${r}]`)},validateBoolean:O,validateBuffer:B,validateDictionary:U,validateEncoding:function(e,t){let r=E(t),i=e.length;if("hex"===r&&i%2!=0)throw new _("encoding",t,`is invalid for data of length ${i}`)},validateFunction:j,validateInt32:M,validateInteger:D,validateNumber:function(e,t,r,i){if("number"!=typeof e)throw new m(t,"number",e);if(null!=r&&e<r||null!=i&&e>i||(null!=r||null!=i)&&l(e))throw new v(t,`${null!=r?`>= ${r}`:""}${null!=r&&null!=i?" && ":""}${null!=i?`<= ${i}`:""}`,e)},validateObject:L,validateOneOf:P,validatePlainFunction:$,validatePort:function(e,t="Port",r=!0){if("number"!=typeof e&&"string"!=typeof e||"string"==typeof e&&0===y(e).length||+e!=+e>>>0||e>65535||0===e&&!r)throw new w(t,e,r);return 0|e},validateSignalName:function(e,t="signal"){if(k(e,t),void 0===R[e]){if(void 0!==R[b(e)])throw new S(e+" (signals must use all capital letters)");throw new S(e)}},validateString:k,validateUint32:I,validateUndefined:H,validateUnion:function(e,t,r){if(!n(r,e))throw new m(t,`('${o(r,"|")}')`,e)},validateAbortSignal:W,validateLinkHeaderValue:function(e){if("string"==typeof e)return Z(e,"hints"),e;if(i(e)){let t=e.length,r="";if(0===t)return r;for(let i=0;i<t;i++){let n=e[i];Z(n,"hints"),r+=n,i!==t-1&&(r+=", ")}return r}throw new _("hints",e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}}},81876:function(e,t,r){"use strict";let i=r(14730),n=r(17578),o=i.Readable.destroy;e.exports=i.Readable,e.exports._uint8ArrayToBuffer=i._uint8ArrayToBuffer,e.exports._isUint8Array=i._isUint8Array,e.exports.isDisturbed=i.isDisturbed,e.exports.isErrored=i.isErrored,e.exports.isReadable=i.isReadable,e.exports.Readable=i.Readable,e.exports.Writable=i.Writable,e.exports.Duplex=i.Duplex,e.exports.Transform=i.Transform,e.exports.PassThrough=i.PassThrough,e.exports.addAbortSignal=i.addAbortSignal,e.exports.finished=i.finished,e.exports.destroy=i.destroy,e.exports.destroy=o,e.exports.pipeline=i.pipeline,e.exports.compose=i.compose,Object.defineProperty(i,"promises",{configurable:!0,enumerable:!0,get:()=>n}),e.exports.Stream=i.Stream,e.exports.default=e.exports},64385:function(e,t,r){"use strict";let{format:i,inspect:n,AggregateError:o}=r(70780),a=globalThis.AggregateError||o,s=Symbol("kIsNodeError"),l=["string","function","number","object","Function","Object","boolean","bigint","symbol"],d=/^([A-Z][a-z0-9]*)+$/,u={};function c(e,t){if(!e)throw new u.ERR_INTERNAL_ASSERTION(t)}function h(e){let t="",r=e.length,i="-"===e[0]?1:0;for(;r>=i+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function f(e,t,r){r||(r=Error);class n extends r{constructor(...r){super(function(e,t,r){if("function"==typeof t)return c(t.length<=r.length,`Code: ${e}; The provided arguments length (${r.length}) does not match the required ones (${t.length}).`),t(...r);let n=(t.match(/%[dfijoOs]/g)||[]).length;return(c(n===r.length,`Code: ${e}; The provided arguments length (${r.length}) does not match the required ones (${n}).`),0===r.length)?t:i(t,...r)}(e,t,r))}toString(){return`${this.name} [${e}]: ${this.message}`}}Object.defineProperties(n.prototype,{name:{value:r.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),n.prototype.code=e,n.prototype[s]=!0,u[e]=n}function p(e){let t="__node_internal_"+e.name;return Object.defineProperty(e,"name",{value:t}),e}class b extends Error{constructor(e="The operation was aborted",t){if(void 0!==t&&"object"!=typeof t)throw new u.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}}f("ERR_ASSERTION","%s",Error),f("ERR_INVALID_ARG_TYPE",(e,t,r)=>{c("string"==typeof e,"'name' must be a string"),Array.isArray(t)||(t=[t]);let i="The ";e.endsWith(" argument")?i+=`${e} `:i+=`"${e}" ${e.includes(".")?"property":"argument"} `,i+="must be ";let o=[],a=[],s=[];for(let e of t)c("string"==typeof e,"All expected entries have to be of type string"),l.includes(e)?o.push(e.toLowerCase()):d.test(e)?a.push(e):(c("object"!==e,'The value "object" should be written as "Object"'),s.push(e));if(a.length>0){let e=o.indexOf("object");-1!==e&&(o.splice(o,e,1),a.push("Object"))}if(o.length>0){switch(o.length){case 1:i+=`of type ${o[0]}`;break;case 2:i+=`one of type ${o[0]} or ${o[1]}`;break;default:{let e=o.pop();i+=`one of type ${o.join(", ")}, or ${e}`}}(a.length>0||s.length>0)&&(i+=" or ")}if(a.length>0){switch(a.length){case 1:i+=`an instance of ${a[0]}`;break;case 2:i+=`an instance of ${a[0]} or ${a[1]}`;break;default:{let e=a.pop();i+=`an instance of ${a.join(", ")}, or ${e}`}}s.length>0&&(i+=" or ")}switch(s.length){case 0:break;case 1:s[0].toLowerCase()!==s[0]&&(i+="an "),i+=`${s[0]}`;break;case 2:i+=`one of ${s[0]} or ${s[1]}`;break;default:{let e=s.pop();i+=`one of ${s.join(", ")}, or ${e}`}}if(null==r)i+=`. Received ${r}`;else if("function"==typeof r&&r.name)i+=`. Received function ${r.name}`;else if("object"==typeof r){var u;if(null!==(u=r.constructor)&&void 0!==u&&u.name)i+=`. Received an instance of ${r.constructor.name}`;else{let e=n(r,{depth:-1});i+=`. Received ${e}`}}else{let e=n(r,{colors:!1});e.length>25&&(e=`${e.slice(0,25)}...`),i+=`. Received type ${typeof r} (${e})`}return i},TypeError),f("ERR_INVALID_ARG_VALUE",(e,t,r="is invalid")=>{let i=n(t);i.length>128&&(i=i.slice(0,128)+"...");let o=e.includes(".")?"property":"argument";return`The ${o} '${e}' ${r}. Received ${i}`},TypeError),f("ERR_INVALID_RETURN_VALUE",(e,t,r)=>{var i;let n=null!=r&&null!==(i=r.constructor)&&void 0!==i&&i.name?`instance of ${r.constructor.name}`:`type ${typeof r}`;return`Expected ${e} to be returned from the "${t}" function but got ${n}.`},TypeError),f("ERR_MISSING_ARGS",(...e)=>{let t;c(e.length>0,"At least one arg needs to be specified");let r=e.length;switch(e=(Array.isArray(e)?e:[e]).map(e=>`"${e}"`).join(" or "),r){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{let r=e.pop();t+=`The ${e.join(", ")}, and ${r} arguments`}}return`${t} must be specified`},TypeError),f("ERR_OUT_OF_RANGE",(e,t,r)=>{let i;return c(t,'Missing "range" argument'),Number.isInteger(r)&&Math.abs(r)>4294967296?i=h(String(r)):"bigint"==typeof r?(i=String(r),(r>2n**32n||r<-(2n**32n))&&(i=h(i)),i+="n"):i=n(r),`The value of "${e}" is out of range. It must be ${t}. Received ${i}`},RangeError),f("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),f("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),f("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),f("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),f("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),f("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),f("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),f("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),f("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),f("ERR_STREAM_WRITE_AFTER_END","write after end",Error),f("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),e.exports={AbortError:b,aggregateTwoErrors:p(function(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;let r=new a([t,e],t.message);return r.code=t.code,r}return e||t}),hideStackFrames:p,codes:u}},57156:function(e){"use strict";e.exports={ArrayIsArray:e=>Array.isArray(e),ArrayPrototypeIncludes:(e,t)=>e.includes(t),ArrayPrototypeIndexOf:(e,t)=>e.indexOf(t),ArrayPrototypeJoin:(e,t)=>e.join(t),ArrayPrototypeMap:(e,t)=>e.map(t),ArrayPrototypePop:(e,t)=>e.pop(t),ArrayPrototypePush:(e,t)=>e.push(t),ArrayPrototypeSlice:(e,t,r)=>e.slice(t,r),Error,FunctionPrototypeCall:(e,t,...r)=>e.call(t,...r),FunctionPrototypeSymbolHasInstance:(e,t)=>Function.prototype[Symbol.hasInstance].call(e,t),MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties:(e,t)=>Object.defineProperties(e,t),ObjectDefineProperty:(e,t,r)=>Object.defineProperty(e,t,r),ObjectGetOwnPropertyDescriptor:(e,t)=>Object.getOwnPropertyDescriptor(e,t),ObjectKeys:e=>Object.keys(e),ObjectSetPrototypeOf:(e,t)=>Object.setPrototypeOf(e,t),Promise,PromisePrototypeCatch:(e,t)=>e.catch(t),PromisePrototypeThen:(e,t,r)=>e.then(t,r),PromiseReject:e=>Promise.reject(e),ReflectApply:Reflect.apply,RegExpPrototypeTest:(e,t)=>e.test(t),SafeSet:Set,String,StringPrototypeSlice:(e,t,r)=>e.slice(t,r),StringPrototypeToLowerCase:e=>e.toLowerCase(),StringPrototypeToUpperCase:e=>e.toUpperCase(),StringPrototypeTrim:e=>e.trim(),Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet:(e,t,r)=>e.set(t,r),Uint8Array}},70780:function(e,t,r){"use strict";let i=r(48764),n=Object.getPrototypeOf(async function(){}).constructor,o=globalThis.Blob||i.Blob;class a extends Error{constructor(e){if(!Array.isArray(e))throw TypeError(`Expected input to be an Array, got ${typeof e}`);let t="";for(let r=0;r<e.length;r++)t+=`    ${e[r].stack}
`;super(t),this.name="AggregateError",this.errors=e}}e.exports={AggregateError:a,kEmptyObject:Object.freeze({}),once(e){let t=!1;return function(...r){t||(t=!0,e.apply(this,r))}},createDeferredPromise:function(){let e,t;return{promise:new Promise((r,i)=>{e=r,t=i}),resolve:e,reject:t}},promisify:e=>new Promise((t,r)=>{e((e,...i)=>e?r(e):t(...i))}),debuglog:()=>function(){},format:(e,...t)=>e.replace(/%([sdifj])/g,function(...[e,r]){let i=t.shift();if("f"===r)return i.toFixed(6);if("j"===r)return JSON.stringify(i);if("s"!==r||"object"!=typeof i)return i.toString();{let e=i.constructor!==Object?i.constructor.name:"";return`${e} {}`.trim()}}),inspect(e){switch(typeof e){case"string":if(e.includes("'")){if(!e.includes('"'))return`"${e}"`;if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}return`'${e}'`;case"number":if(isNaN(e))return"NaN";if(Object.is(e,-0))return String(e);return e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}},types:{isAsyncFunction:e=>e instanceof n,isArrayBufferView:e=>ArrayBuffer.isView(e)},isBlob:void 0!==o?function(e){return e instanceof o}:function(e){return!1}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")},14730:function(e,t,r){"use strict";let{Buffer:i}=r(48764),{ObjectDefineProperty:n,ObjectKeys:o,ReflectApply:a}=r(57156),{promisify:{custom:s}}=r(70780),{streamReturningOperators:l,promiseReturningOperators:d}=r(27715),{codes:{ERR_ILLEGAL_CONSTRUCTOR:u}}=r(64385),c=r(96171),{pipeline:h}=r(6729),{destroyer:f}=r(39201),p=r(94906),b=r(17578),y=r(66909),g=e.exports=r(85484).Stream;for(let e of(g.isDisturbed=y.isDisturbed,g.isErrored=y.isErrored,g.isReadable=y.isReadable,g.Readable=r(47950),o(l))){let t=l[e];function w(...e){if(new.target)throw u();return g.Readable.from(a(t,this,e))}n(w,"name",{__proto__:null,value:t.name}),n(w,"length",{__proto__:null,value:t.length}),n(g.Readable.prototype,e,{__proto__:null,value:w,enumerable:!1,configurable:!0,writable:!0})}for(let e of o(d)){let t=d[e];function w(...e){if(new.target)throw u();return a(t,this,e)}n(w,"name",{__proto__:null,value:t.name}),n(w,"length",{__proto__:null,value:t.length}),n(g.Readable.prototype,e,{__proto__:null,value:w,enumerable:!1,configurable:!0,writable:!0})}g.Writable=r(39713),g.Duplex=r(96665),g.Transform=r(88393),g.PassThrough=r(23058),g.pipeline=h;let{addAbortSignal:m}=r(32264);g.addAbortSignal=m,g.finished=p,g.destroy=f,g.compose=c,n(g,"promises",{__proto__:null,configurable:!0,enumerable:!0,get:()=>b}),n(h,s,{__proto__:null,enumerable:!0,get:()=>b.pipeline}),n(p,s,{__proto__:null,enumerable:!0,get:()=>b.finished}),g.Stream=g,g._isUint8Array=function(e){return e instanceof Uint8Array},g._uint8ArrayToBuffer=function(e){return i.from(e.buffer,e.byteOffset,e.byteLength)}},17578:function(e,t,r){"use strict";let{ArrayPrototypePop:i,Promise:n}=r(57156),{isIterable:o,isNodeStream:a,isWebStream:s}=r(66909),{pipelineImpl:l}=r(6729),{finished:d}=r(94906);r(14730),e.exports={finished:d,pipeline:function(...e){return new n((t,r)=>{let n,d;let u=e[e.length-1];if(u&&"object"==typeof u&&!a(u)&&!o(u)&&!s(u)){let t=i(e);n=t.signal,d=t.end}l(e,(e,i)=>{e?r(e):t(i)},{signal:n,end:d})})}}},35796:function(e,t,r){"use strict";r.d(t,{d:function(){return n}});var i=r(85783);class n extends i.J5{async init(e){this.chainConfig||(this.chainConfig=(0,i.h2)(i.EN.EIP155,1))}async authenticateUser(){if(!this.provider||this.status!==i.MP.CONNECTED)throw i.RM.notConnectedError();let{chainNamespace:e,chainId:t}=this.chainConfig,r=await this.provider.request({method:"eth_accounts"});if(r&&r.length>0){let n=(0,i.Cb)(r[0],this.name);if(n&&!(0,i.$E)(n))return{idToken:n};let o={domain:window.location.origin,uri:window.location.href,address:r[0],chainId:parseInt(t,16),version:"1",nonce:Math.random().toString(36).slice(2),issuedAt:new Date().toISOString()},a=await (0,i.tV)(o,e),s=await this.provider.request({method:"personal_sign",params:[a,r[0]]}),l=await (0,i.rn)(e,s,a,this.name,this.sessionTime,this.clientId,this.web3AuthNetwork);return(0,i.Fr)(r[0],this.name,l),{idToken:l}}throw i.RM.notConnectedError("Not connected with wallet, Please login/connect first")}async disconnectSession(){super.checkDisconnectionRequirements();let e=await this.provider.request({method:"eth_accounts"});e&&e.length>0&&(0,i.qz)(e[0],this.name)}async disconnect(){this.rehydrated=!1,this.emit(i.n2.DISCONNECTED)}}},71604:function(e,t,r){"use strict";r.d(t,{TorusWalletAdapter:function(){return ev}});var i=r(1413),n=r(81180),o=r(20917),a=r(81876),s=r(17187),l=r(4445),d=r.n(l),u=r(39428),c=r(12840),h=r.n(c),f=r(30778),p=r.n(f),b=r(74286),y=r.n(b);function g(){}class w extends a.Duplex{constructor(e){let{name:t,target:r,targetWindow:i=window,targetOrigin:o="*"}=e;if(super({objectMode:!0}),(0,n.Z)(this,"_init",void 0),(0,n.Z)(this,"_haveSyn",void 0),(0,n.Z)(this,"_name",void 0),(0,n.Z)(this,"_target",void 0),(0,n.Z)(this,"_targetWindow",void 0),(0,n.Z)(this,"_targetOrigin",void 0),(0,n.Z)(this,"_onMessage",void 0),(0,n.Z)(this,"_synIntervalId",void 0),!t||!r)throw Error("Invalid input.");this._init=!1,this._haveSyn=!1,this._name=t,this._target=r,this._targetWindow=i,this._targetOrigin=o,this._onMessage=this.onMessage.bind(this),this._synIntervalId=null,window.addEventListener("message",this._onMessage,!1),this._handShake()}_break(){this.cork(),this._write("BRK",null,g),this._haveSyn=!1,this._init=!1}_handShake(){this._write("SYN",null,g),this.cork()}_onData(e){if(this._init){if("BRK"===e)this._break();else try{this.push(e)}catch(e){this.emit("error",e)}}else"SYN"===e?(this._haveSyn=!0,this._write("ACK",null,g)):"ACK"===e&&(this._init=!0,this._haveSyn||this._write("ACK",null,g),this.uncork())}_postMessage(e){let t=this._targetOrigin;this._targetWindow.postMessage({target:this._target,data:e},t)}onMessage(e){let t=e.data;("*"===this._targetOrigin||e.origin===this._targetOrigin)&&e.source===this._targetWindow&&"object"==typeof t&&t.target===this._name&&t.data&&this._onData(t.data)}_read(){}_write(e,t,r){this._postMessage(e),r()}_destroy(){window.removeEventListener("message",this._onMessage,!1)}}function m(e,t,r){try{Reflect.apply(e,t,r)}catch(e){setTimeout(()=>{throw e})}}class _ extends s.EventEmitter{emit(e){let t="error"===e,r=this._events;if(void 0!==r)t=t&&void 0===r.error;else if(!t)return!1;for(var i=arguments.length,n=Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];if(t){let e;if(n.length>0&&([e]=n),e instanceof Error)throw e;let t=Error(`Unhandled error.${e?` (${e.message})`:""}`);throw t.context=e,t}let a=r[e];if(void 0===a)return!1;if("function"==typeof a)m(a,this,n);else{let e=a.length,t=function(e){let t=e.length,r=Array(t);for(let i=0;i<t;i+=1)r[i]=e[i];return r}(a);for(let r=0;r<e;r+=1)m(t[r],this,n)}return!0}}class v extends Error{constructor(e){let{code:t,message:r,data:i}=e;if(!Number.isInteger(t))throw Error("code must be an integer");if(!r||"string"!=typeof r)throw Error("message must be string");super(r),(0,n.Z)(this,"code",void 0),(0,n.Z)(this,"data",void 0),this.code=t,void 0!==i&&(this.data=i)}toString(){return d()({code:this.code,message:this.message,data:this.data,stack:this.stack})}}class S extends _{constructor(){super(),(0,n.Z)(this,"_middleware",void 0),this._middleware=[]}static async _runAllMiddleware(e,t,r){let i=[],n=null,o=!1;for(let a of r)if([n,o]=await S._runMiddleware(e,t,a,i),o)break;return[n,o,i.reverse()]}static _runMiddleware(e,t,r,i){return new Promise(n=>{let o=e=>{let r=e||t.error;r&&(t.error=(0,u.Xy)(r)),n([r,!0])};try{r(e,t,e=>{t.error?o(t.error):(e&&("function"!=typeof e&&o(new v({code:-32603,message:"JRPCEngine: 'next' return handlers must be functions"})),i.push(e)),n([null,!1]))},o)}catch(e){o(e)}})}static async _runReturnHandlers(e){for(let t of e)await new Promise((e,r)=>{t(t=>t?r(t):e())})}static _checkForCompletion(e,t,r){if(!("result"in t)&&!("error"in t))throw new v({code:-32603,message:"Response has no error or result for request"});if(!r)throw new v({code:-32603,message:"Nothing ended request"})}push(e){this._middleware.push(e)}handle(e,t){if(t&&"function"!=typeof t)throw Error('"callback" must be a function if provided.');return Array.isArray(e)?t?this._handleBatch(e,t):this._handleBatch(e):t?this._handle(e,t):this._promiseHandle(e)}asMiddleware(){return async(e,t,r,i)=>{try{let[n,o,a]=await S._runAllMiddleware(e,t,this._middleware);if(o)return await S._runReturnHandlers(a),i(n);return r(async e=>{try{await S._runReturnHandlers(a)}catch(t){return e(t)}return e()})}catch(e){return i(e)}}}async _handleBatch(e,t){try{let r=await Promise.all(e.map(this._promiseHandle.bind(this)));if(t)return t(null,r);return r}catch(e){if(t)return t(e);throw e}}_promiseHandle(e){return new Promise(t=>{this._handle(e,(e,r)=>{t(r)})})}async _handle(e,t){if(!e||Array.isArray(e)||"object"!=typeof e){let e=new v({code:-32603,message:"request must be plain object"});return t(e,{id:void 0,jsonrpc:"2.0",error:e})}if("string"!=typeof e.method){let r=new v({code:-32603,message:"method must be string"});return t(r,{id:e.id,jsonrpc:"2.0",error:r})}let r=(0,i.Z)({},e),n={id:r.id,jsonrpc:r.jsonrpc},o=null;try{await this._processRequest(r,n)}catch(e){o=e}return o&&(delete n.result,n.error||(n.error=(0,u.Xy)(o))),t(o,n)}async _processRequest(e,t){let[r,i,n]=await S._runAllMiddleware(e,t,this._middleware);if(S._checkForCompletion(e,t,i),await S._runReturnHandlers(n),r)throw r}}class E extends a.Duplex{constructor(e){let{parent:t,name:r}=e;super({objectMode:!0}),(0,n.Z)(this,"_parent",void 0),(0,n.Z)(this,"_name",void 0),this._parent=t,this._name=r}_read(){}_write(e,t,r){this._parent.push({name:this._name,data:e}),r()}}let A=Symbol("IGNORE_SUBSTREAM");class T extends a.Duplex{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super((0,i.Z)((0,i.Z)({},e),{},{objectMode:!0})),(0,n.Z)(this,"_substreams",void 0),(0,n.Z)(this,"getStream",void 0),this._substreams={}}createStream(e){if(!e)throw Error("ObjectMultiplex - name must not be empty");if(this._substreams[e])throw Error(`ObjectMultiplex - Substream for name "${e}" already exists`);let t=new E({parent:this,name:e});return this._substreams[e]=t,function(e,t){let r=p()(t);h()(e,{readable:!1},r),h()(e,{writable:!1},r)}(this,e=>t.destroy(e||void 0)),t}ignoreStream(e){if(!e)throw Error("ObjectMultiplex - name must not be empty");if(this._substreams[e])throw Error(`ObjectMultiplex - Substream for name "${e}" already exists`);this._substreams[e]=A}_read(){}_write(e,t,r){let{name:i,data:n}=e;if(!i)return window.console.warn(`ObjectMultiplex - malformed chunk without name "${e}"`),r();let o=this._substreams[i];return o?o!==A&&o.push(n):window.console.warn(`ObjectMultiplex - orphaned data for stream "${i}"`),r()}}var R=r(72378),C=r.n(R),D=r(64063),M=r.n(D),I=r(2043),k=r.n(I),P=r(48764).Buffer;let O={GOOGLE:"google",FACEBOOK:"facebook",TWITCH:"twitch",REDDIT:"reddit",DISCORD:"discord",EMAIL_PASSWORDLESS:"torus-auth0-email-passwordless"},N={[O.GOOGLE]:"tkey-google",[O.FACEBOOK]:"tkey-facebook",[O.TWITCH]:"tkey-twitch",[O.REDDIT]:"tkey-reddit",[O.DISCORD]:"tkey-discord",[O.EMAIL_PASSWORDLESS]:"tkey-auth0-email-passwordless"},L={MOONPAY:"moonpay",WYRE:"wyre",RAMPNETWORK:"rampnetwork",XANPOOL:"xanpool",MERCURYO:"mercuryo",TRANSAK:"transak",BANXA:"banxa"},U="mainnet",x="matic",B="bsc_mainnet",W="avalanche_mainnet",j="arbitrum_mainnet",$="optimism_mainnet",H={BOTTOM_LEFT:"bottom-left",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",TOP_RIGHT:"top-right"},K={[L.MOONPAY]:["AUD","BGN","BRL","CAD","CHF","CNY","COP","CZK","DKK","DOP","EGP","EUR","GBP","HKD","HRK","IDR","ILS","JPY","JOD","KES","KRW","KWD","LKR","MAD","MXN","MYR","NGN","NOK","NZD","OMR","PEN","PKR","PLN","RON","RUB","SEK","SGD","THB","TRY","TWD","USD","VND","ZAR"],[L.WYRE]:["USD","EUR","GBP","AUD","CAD","NZD","CNY","ARS","BRL","CHF","CLP","COP","CZK","DKK","HKD","ILS","INR","ISK","JPY","KRW","MXN","MYR","NOK","PHP","PLN","SEK","SGD","THB","VND","ZAR"],[L.RAMPNETWORK]:["USD","EUR","GBP","BMD","BAM","BWP","BRL","BGN","COP","CRC","CZK","DKK","DOP","GEL","GTQ","HNL","HUF","ISK","INR","ILS","KZT","KES","KWD","LAK","MKD","MYR","MXN","MDL","MZN","NZD","NGN","PYG","PEN","PLN","RON","RSD","SGD","ZAR","LKR","SEK","CHF","TJS","THB","UYU"],[L.XANPOOL]:["SGD","HKD","THB","PHP","INR","IDR","MYR","AUD","NZD","KRW"],[L.MERCURYO]:["EUR","USD","GBP","TRY","JPY","BRL","NGN","VND","MXN","KRW","PLN","SEK","CHF","CAD","CZK","DKK","BGN","HKD","AUD","INR"],[L.TRANSAK]:["ARS","AUD","BBD","BGN","BMD","BRL","CAD","CHF","CLP","CRC","CZK","DKK","DOP","EUR","FJD","FKP","GBP","GIP","HRK","HUF","IDR","ILS","ISK","JMD","JPY","KES","KRW","MDL","MXN","MYR","NOK","NZD","PEN","PHP","PLN","PYG","RON","SEK","SGD","THB","TRY","TZS","USD","ZAR"],[L.BANXA]:["AUD","CAD","CZK","DKK","EUR","GBP","HKD","JPY","NOK","NZD","NZD","PLN","RUB","SEK","SGD","TRY","USD"]},Z=new Set(["ETH","USDT","USDC","TUSD","EOSDT","USD","DAI","GUSD","DKKT","PAX","ILS","RUB","BYN","EUR","GBP","JPY","KRW","PLN","MXN","AUD","BRL","CAD","CHF","KPW","LAK","LBP","LKR","XOF","CNHT","DOGE","UAH","TRY","HKD","XJP","SGD","USC","NZD","NGN","RUR","COP","GHS","EGP","IDR","BHD","CRC","PEN","AED","DOP","PKR","HUF","VND","XAR","LTC","RON","OMR","MYR","DKK","UGX","ZMW","SAR","SEK","GEL","RWF","IRR","TZS","CNY","VEF","BDT","HRK","CLP","THB","XAF","ARS","UYU","SZL","KZT","NOK","KES","PAB","INR","CZK","MAD","TWD","PHP","ZAR","BOB","CDF","DASH","VES","ISK","MWK","BAM","TTD","XRP","JOD","RSD","HNL","BGN","GTQ","BWP","XMR","MMK","QAR","AOA","KWD","MUR","WUSD","WEUR","WAVES","WTRY","LRD","LSL","LYD","AWG","MDL","BTO","EURS","CHFT","MKD","MNT","MOP","MRO","MVR","VOLLAR","CKUSD","KHR","VUV","BITCNY","QC","BBD","NAD","NPR","PGK","PYG","BIF","BMD","BND","XLM","BNB","SCR","BAT","CRO","HT","KCS","LEO","LINK","MKR","NPXS","OMG","REP","ZB","ZIL","ZRX","BCH","BZD","CUP","CVE","DJF","DZD","ERN","ETB","FJD","FKP","BUSD","ANCT","ALL","AMD","ANG","CNYX","IQD","UZS","TND","GGP","XAU","KGS","GIP","JMD","ZEC","USDP","BSV","EMC2","SNT","GTO","POWR","EUSD","EURT","BCY","BTS","ATM","BLOCKPAY","ARDR","AMP","B2X","BITGOLD","BITEUR","ATB","BITUSD","AGRS","DFXT","HIKEN","BIX","KNC","EOS","COB","COSS","BMH","NANO","BDG","BNT","XVG","LKK1Y","LKK","USDK","EURN","NZDT","JSE","GMD","GNF","GYD","YER","XPF","HTG","SLL","SOS","WST","SVC","SYP","NEO","KMF","JUMP","AYA","BLAST","WGR","BCN","BTG","URALS","INN","USDQ","CNH","HUSD","BKRW","NZDX","EURX","CADX","USDEX","JPYX","AUDX","VNDC","EON","GBPX","CHFX","USDJ","IDRT","USDS","USDN","BIDR","IDK","BSD","BTN","KYD","NIO","SBD","SDG","SHP","TOP","XCD","XCHF","CNYT","GYEN","ZUSD","GOLD","TRX","TRYB","PLATC","STRAX","UST","GLM","VAI","BRZ","DDRST","XAUT","MIM"]);function V(e){return K[e].filter(e=>Z.has(e))}let F={[L.MOONPAY]:{line1:"Credit/ Debit Card/ Apple Pay",line2:"4.5% or 5 USD",line3:"2,000€/day, 10,000€/mo",supportPage:"https://help.moonpay.io/en/",minOrderValue:24.99,maxOrderValue:5e4,validCurrencies:V(L.MOONPAY),validCryptoCurrenciesByChain:{[U]:[{value:"aave",display:"AAVE"},{value:"bat",display:"BAT"},{value:"dai",display:"DAI"},{value:"eth",display:"ETH"},{value:"mkr",display:"MKR"},{value:"matic",display:"MATIC"},{value:"usdt",display:"USDT"},{value:"uni",display:"UNI"},{value:"usdc",display:"USDC"},{value:"weth",display:"WETH"}],[x]:[{value:"eth_polygon",display:"ETH"},{value:"matic_polygon",display:"MATIC"},{value:"usdc_polygon",display:"USDC"},{value:"usdt_polygon",display:"USDT"}],[B]:[{value:"bnb_bsc",display:"BNB"},{value:"busd_bsc",display:"BUSD"}],[W]:[{value:"avax_cchain",display:"AVAX"},{value:"usdc_cchain",display:"USDC"}],[j]:[{value:"eth_arbitrum",display:"ETH"},{value:"usdc_arbitrum",display:"USDC"}],[$]:[{value:"eth_optimism",display:"ETH"},{value:"usdc_optimism",display:"USDC"}]},includeFees:!0,api:!0,enforceMax:!1},[L.WYRE]:{line1:"Apple Pay/ Debit/ Credit Card",line2:"4.9% + 30\xa2 or 5 USD",line3:"$250/day",supportPage:"https://support.sendwyre.com/en/",minOrderValue:5,maxOrderValue:500,validCurrencies:V(L.WYRE),validCryptoCurrenciesByChain:{[U]:[{value:"AAVE",display:"AAVE"},{value:"COMP",display:"COMP"},{value:"BAT",display:"BAT"},{value:"BUSD",display:"BUSD"},{value:"DAI",display:"DAI"},{value:"ETH",display:"ETH"},{value:"WBTC",display:"WBTC"},{value:"MKR",display:"MKR"},{value:"UNI",display:"UNI"},{value:"WETH",display:"WETH"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"}],[x]:[{value:"mUSDC",display:"USDC"},{value:"MATIC",display:"MATIC"},{value:"MWETH",display:"WETH"}],[W]:[{value:"AVAXC",display:"AVAX"},{value:"AVAXCUSDC",display:"USDC"}],[B]:[{value:"BNB",display:"BNB"},{value:"BBUSD",display:"BUSD"}]},includeFees:!1,api:!0,enforceMax:!1},[L.RAMPNETWORK]:{line1:"Debit Card/ <br>Apple Pay/ Bank transfer",line2:"0.49% - 2.9%",line3:"5,000€/purchase, 20,000€/mo",supportPage:"https://instant.ramp.network/",minOrderValue:50,maxOrderValue:2e4,validCurrencies:V(L.RAMPNETWORK),validCryptoCurrenciesByChain:{[U]:[{value:"ETH",display:"ETH"},{value:"DAI",display:"DAI"},{value:"BAT",display:"BAT"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"}],[x]:[{value:"MATIC_BAT",display:"BAT"},{value:"MATIC_DAI",display:"DAI"},{value:"MATIC_MATIC",display:"MATIC"},{value:"MATIC_USDC",display:"USDC"},{value:"MATIC_USDT",display:"USDT"}],[W]:[{value:"AVAX_AVAX",display:"AVAX"},{value:"AVAX_USDC",display:"USDC"},{value:"AVAX_USDT",display:"USDT"}],[j]:[{value:"ARBITRUM_ETH",display:"ETH"},{value:"ARBITRUM_USDC.e	",display:"USDC"},{value:"ARBITRUM_USDT",display:"USDT"}],[$]:[{value:"OPTIMISM_DAI",display:"DAI"},{value:"OPTIMISM_OPTIMISM",display:"OPTIMISM"},{value:"OPTIMISM_USDC",display:"USDC"},{value:"OPTIMISM_USDT",display:"USDT"}],[B]:[{value:"BSC_BNB",display:"BNB"},{value:"BSC_BUSD",display:"BUSD"}]},includeFees:!0,api:!0,receiveHint:"walletTopUp.receiveHintRamp",enforceMax:!1},[L.XANPOOL]:{line1:"PayNow/ InstaPay/ FPS/ GoJekPay/ UPI/ PromptPay/ <br>ViettelPay/ DuitNow",line2:"2.5% buying, 3% selling",line3:"$2,500 / day",supportPage:"mailto:support@xanpool.com",minOrderValue:100,maxOrderValue:2500,validCurrencies:V(L.XANPOOL),validCryptoCurrenciesByChain:{[U]:[{value:"ETH",display:"ETH"},{value:"USDT",display:"USDT"},{value:"USDC",display:"USDC"}]},includeFees:!0,api:!0,sell:!0,enforceMax:!1},[L.MERCURYO]:{line1:"Credit/ Debit Card/ Apple Pay",line2:"3.95% or 4 USD",line3:"10,000€/day, 25,000€/mo",supportPage:"mailto:support@mercuryo.io",minOrderValue:30,maxOrderValue:5e3,validCurrencies:V(L.MERCURYO),validCryptoCurrenciesByChain:{[U]:[{value:"ETH",display:"ETH"},{value:"BAT",display:"BAT"},{value:"USDT",display:"USDT"},{value:"DAI",display:"DAI"}],[B]:[{value:"BNB",display:"BNB"},{value:"BUSD",display:"BUSD"},{value:"1INCH",display:"1INCH"}],[W]:[{value:"AVAX",display:"AVAX"}],[x]:[{value:"MATIC",display:"MATIC"}]},includeFees:!0,api:!0,enforceMax:!1},[L.TRANSAK]:{line1:"Apple & Google Pay / Credit/Debit Card<br/>Bangkok Bank Mobile & iPay<br/>Bank Transfer (sepa/gbp) / SCB Mobile & Easy",line2:"0.99% - 5.5% or 5 USD",line3:"$5,000/day, $28,000/mo",supportPage:"https://support.transak.com/hc/en-US",minOrderValue:30,maxOrderValue:500,validCurrencies:V(L.TRANSAK),validCryptoCurrenciesByChain:{[U]:[{value:"1INCH",display:"1INCH"},{value:"BAT",display:"BAT"},{value:"AAVE",display:"AAVE"},{value:"DAI",display:"DAI"},{value:"ETH",display:"ETH"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"}],[x]:[{value:"BAT",display:"BAT"},{value:"AAVE",display:"AAVE"},{value:"DAI",display:"DAI"},{value:"MATIC",display:"MATIC"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"},{value:"WETH",display:"WETH"}],[B]:[{value:"BAT",display:"BAT"},{value:"BNB",display:"BNB"},{value:"BUSD",display:"BUSD"}],[W]:[{value:"AVAX",display:"AVAX"}],[$]:[{value:"ETH",display:"ETH"},{value:"USDC",display:"USDC"}],[j]:[{value:"USDC",display:"USDC"},{value:"ETH",display:"ETH"}]},includeFees:!0,enforceMax:!0},[L.BANXA]:{line1:"Debit Card/ <br>Apple Pay/ Bank transfer",line2:"0.49% - 2.9%",line3:"5,000€/purchase, 20,000€/mo",supportPage:"https://support.banxa.com",minOrderValue:20,maxOrderValue:15e3,validCurrencies:V(L.BANXA),validCryptoCurrenciesByChain:{[U]:[{value:"ETH",display:"ETH"},{value:"DAI",display:"DAI"},{value:"MKR",display:"MKR"},{value:"USDT",display:"USDT"},{value:"BUSD",display:"BUSD"},{value:"USDC",display:"USDC"},{value:"BAT",display:"BAT"},{value:"AAVE",display:"AAVE"},{value:"COMP",display:"COMP"},{value:"UNI",display:"UNI"}],[x]:[{value:"MATIC",display:"MATIC"}]},includeFees:!0,enforceMax:!0}};var q={supportedVerifierList:Object.values(O),paymentProviders:F,api:"https://api.tor.us",translations:{en:{embed:{continue:"Continue",actionRequired:"Authorization required",pendingAction:"Click continue to proceed with your request in a popup",cookiesRequired:"Cookies Required",enableCookies:"Please enable cookies in your browser preferences to access Torus",clickHere:"More Info"}},de:{embed:{continue:"Fortsetzen",actionRequired:"Autorisierung erforderlich",pendingAction:"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren",cookiesRequired:"Cookies ben\xf6tigt",enableCookies:"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen",clickHere:"Mehr Info"}},ja:{embed:{continue:"継続する",actionRequired:"認証が必要です",pendingAction:"続行をクリックして、ポップアップでリクエストを続行します",cookiesRequired:"必要なクッキー",enableCookies:"Torusにアクセスするには、ブラウザの設定でCookieを有効にしてください。",clickHere:"詳しくは"}},ko:{embed:{continue:"계속하다",actionRequired:"승인 필요",pendingAction:"팝업에서 요청을 진행하려면 계속을 클릭하십시오.",cookiesRequired:"쿠키 필요",enableCookies:"브라우저 환경 설정에서 쿠키를 활성화하여 Torus에 액세스하십시오.",clickHere:"더 많은 정보"}},zh:{embed:{continue:"继续",actionRequired:"需要授权",pendingAction:"单击继续以在弹出窗口中继续您的请求",cookiesRequired:"必填Cookie",enableCookies:"请在您的浏览器首选项中启用cookie以访问Torus。",clickHere:"更多信息"}}},prodTorusUrl:"",localStorageKeyPrefix:"torus-"};let G=e=>{let t=window.document.createElement("template"),r=e.trim();return t.innerHTML=r,t.content.firstChild},Y=(e,t,r)=>{let i=n=>{r(n),e.removeListener(t,i)};e.on(t,i)};function X(e){return null!==e&&"object"==typeof e&&"function"==typeof e.pipe}var z=k().getLogger("torus-embed"),J={errors:{disconnected:()=>"Torus: Lost connection to Torus.",permanentlyDisconnected:()=>"Torus: Disconnected from iframe. Page reload required.",sendSiteMetadata:()=>"Torus: Failed to send site metadata. This is an internal error, please report this bug.",unsupportedSync:e=>`Torus: The Torus Ethereum provider does not support synchronous methods like ${e} without a callback parameter.`,invalidDuplexStream:()=>"Must provide a Node.js-style duplex stream.",invalidOptions:(e,t)=>`Invalid options. Received: { maxEventListeners: ${e}, shouldSendMetadata: ${t} }`,invalidRequestArgs:()=>"Expected a single, non-array, object argument.",invalidRequestMethod:()=>"'args.method' must be a non-empty string.",invalidRequestParams:()=>"'args.params' must be an object or array if provided.",invalidLoggerObject:()=>"'args.logger' must be an object if provided.",invalidLoggerMethod:e=>`'args.logger' must include required method '${e}'.`},info:{connected:e=>`Torus: Connected to chain with ID "${e}".`}};let{paymentProviders:Q}=q,ee=(e,t)=>{let r={};if(!e)return{errors:r,isValid:!0};if(e&&!Q[e])return r.provider="Invalid Provider",{errors:r,isValid:0===Object.keys(r).length};let i=Q[e],n=t||{};if(n.fiatValue){let e=+parseFloat(n.fiatValue.toString())||0;e<i.minOrderValue&&(r.fiatValue="Requested amount is lower than supported"),e>i.maxOrderValue&&i.enforceMax&&(r.fiatValue="Requested amount is higher than supported")}if(n.selectedCurrency&&!i.validCurrencies.includes(n.selectedCurrency)&&(r.selectedCurrency="Unsupported currency"),n.selectedCryptoCurrency){let t=Object.values(i.validCryptoCurrenciesByChain).flat().map(e=>e.value),o=e===L.MOONPAY?n.selectedCryptoCurrency.toLowerCase():n.selectedCryptoCurrency;t&&!t.includes(o)&&(r.selectedCryptoCurrency="Unsupported cryptoCurrency")}return{errors:r,isValid:0===Object.keys(r).length}},et=()=>Math.random().toString(36).slice(2),er=async(e,t)=>{let r,i;let n="4.0.7",a=t.version||n;try{if(("binance"===e||"production"===e)&&!t.version){let e;a=(e=q.prodTorusUrl?{data:q.prodTorusUrl}:await (0,o.U2)(`${q.api}/latestversion?name=@toruslabs/torus-embed&version=${n}`,{},{useAPIKey:!0})).data,q.prodTorusUrl=e.data}}catch(e){z.error(e,"unable to fetch latest version")}switch(z.info("version used: ",a),e){case"binance":r=`https://binance.tor.us/v${a}`,i="info";break;case"testing":r="https://testing.tor.us",i="debug";break;case"bnb":r="https://bnb.tor.us",i="error";break;case"polygon":r="https://polygon.tor.us",i="error";break;case"lrc":r="https://lrc.tor.us",i="debug";break;case"beta":r="https://beta.tor.us",i="debug";break;case"development":r="http://localhost:4050",i="debug";break;case"alpha":r="https://alpha.tor.us",i="debug";break;default:r=`https://app.tor.us/v${a}`,i="error"}return{torusUrl:r,logLevel:i}},ei=()=>{let e=(window.navigator.language||"en-US").split("-");return Object.prototype.hasOwnProperty.call(q.translations,e[0])?e[0]:"en"},en=["eth_subscription"],eo=()=>{},ea="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=660,width=375",es="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=700,width=450";_.defaultMaxListeners=100;let el=function(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return(i,n)=>i||n.error?t(i||n.error):!r||Array.isArray(n)?e(n):e(n.result)};class ed extends _{constructor(e){var t;let{maxEventListeners:r=100,shouldSendMetadata:o=!0,jsonRpcStreamName:s="provider"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(super(),(0,n.Z)(this,"chainId",void 0),(0,n.Z)(this,"selectedAddress",void 0),(0,n.Z)(this,"_rpcEngine",void 0),(0,n.Z)(this,"networkVersion",void 0),(0,n.Z)(this,"shouldSendMetadata",void 0),(0,n.Z)(this,"isTorus",void 0),(0,n.Z)(this,"tryPreopenHandle",void 0),(0,n.Z)(this,"enable",void 0),(0,n.Z)(this,"_state",void 0),(0,n.Z)(this,"_jsonRpcConnection",void 0),!(X(e)&&!1!==e.writable&&"function"==typeof e._write&&"object"==typeof e._writableState&&X(t=e)&&!1!==t.readable&&"function"==typeof t._read&&"object"==typeof t._readableState))throw Error(J.errors.invalidDuplexStream());this.isTorus=!0,this.setMaxListeners(r),this._state=(0,i.Z)({},ed._defaultState),this.selectedAddress=null,this.networkVersion=null,this.chainId=null,this.shouldSendMetadata=o,this._handleAccountsChanged=this._handleAccountsChanged.bind(this),this._handleChainChanged=this._handleChainChanged.bind(this),this._handleUnlockStateChanged=this._handleUnlockStateChanged.bind(this),this._handleConnect=this._handleConnect.bind(this),this._handleDisconnect=this._handleDisconnect.bind(this),this._handleStreamDisconnect=this._handleStreamDisconnect.bind(this),this._sendSync=this._sendSync.bind(this),this._rpcRequest=this._rpcRequest.bind(this),this._initializeState=this._initializeState.bind(this),this.request=this.request.bind(this),this.send=this.send.bind(this),this.sendAsync=this.sendAsync.bind(this);let l=new T;y()(e,l,e,this._handleStreamDisconnect.bind(this,"MetaMask")),l.ignoreStream("phishing"),this.on("connect",()=>{this._state.isConnected=!0});let d=function(){let e={},t=new _,r=new a.Duplex({objectMode:!0,read:function(){return!1},write:function(r,i,n){let o;try{r.id?!function(t){let r=e[t.id];if(!r)throw Error(`StreamMiddleware - Unknown response id "${t.id}"`);delete e[t.id],Object.assign(r.res,t),setTimeout(r.end)}(r):t.emit("notification",r)}catch(e){o=e}n(o)}});return{events:t,middleware:(t,i,n,o)=>{r.push(t),e[t.id]={req:t,res:i,next:n,end:o}},stream:r}}();y()(d.stream,l.createStream(s),d.stream,this._handleStreamDisconnect.bind(this,"MetaMask RpcProvider"));let c=new S;c.push((e,t,r,i)=>{let n=e.id,o=Math.random().toString(36).slice(2);e.id=o,t.id=o,r(r=>{e.id=n,t.id=n,r()})}),c.push((e,t,r)=>{"string"==typeof e.method&&e.method||(t.error=u.PY.invalidRequest({message:"The request 'method' must be a non-empty string.",data:(0,i.Z)((0,i.Z)({},e||{}),{},{cause:"The request 'method' must be a non-empty string."})})),r(e=>{let{error:r}=t;return r&&z.error(`MetaMask - RPC Error: ${r.message}`,r),e()})}),c.push(d.middleware),this._rpcEngine=c,d.events.on("notification",e=>{let{method:t,params:r}=e;"wallet_accountsChanged"===t?this._handleAccountsChanged(r):"wallet_unlockStateChanged"===t?this._handleUnlockStateChanged(r):"wallet_chainChanged"===t?this._handleChainChanged(r):en.includes(e.method)&&(this.emit("data",e),this.emit("notification",r.result),this.emit("message",{type:t,data:r}))})}isConnected(){return this._state.isConnected}async request(e){if(!e||"object"!=typeof e||Array.isArray(e))throw u.PY.invalidRequest({message:J.errors.invalidRequestArgs(),data:(0,i.Z)((0,i.Z)({},e||{}),{},{cause:J.errors.invalidRequestArgs()})});let{method:t,params:r}=e;if("string"!=typeof t||0===t.length)throw u.PY.invalidRequest({message:J.errors.invalidRequestMethod(),data:(0,i.Z)((0,i.Z)({},e||{}),{},{cause:J.errors.invalidRequestArgs()})});if(void 0!==r&&!Array.isArray(r)&&("object"!=typeof r||null===r))throw u.PY.invalidRequest({message:J.errors.invalidRequestParams(),data:(0,i.Z)((0,i.Z)({},e||{}),{},{cause:J.errors.invalidRequestArgs()})});return new Promise((e,i)=>{this._rpcRequest({method:t,params:r},el(e,i))})}sendAsync(e,t){this._rpcRequest(e,t)}async _initializeState(){try{let{accounts:e,chainId:t,isUnlocked:r,networkVersion:i}=await this.request({method:"wallet_getProviderState"});this.emit("connect",{chainId:t}),this._handleChainChanged({chainId:t,networkVersion:i}),this._handleUnlockStateChanged({accounts:e,isUnlocked:r}),this._handleAccountsChanged(e)}catch(e){z.error("MetaMask: Failed to get initial state. Please report this bug.",e)}finally{z.info("initialized state"),this._state.initialized=!0,this.emit("_initialized")}}_rpcRequest(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t;if(!Array.isArray(e)){if(e.jsonrpc||(e.jsonrpc="2.0"),"eth_accounts"===e.method||"eth_requestAccounts"===e.method)i=(i,n)=>{this._handleAccountsChanged(n.result||[],"eth_accounts"===e.method,r),t(i,n)};else if("wallet_getProviderState"===e.method){this._rpcEngine.handle(e,i);return}}this.tryPreopenHandle(e,i)}send(e,t){return"string"==typeof e&&(!t||Array.isArray(t))?new Promise((r,i)=>{try{this._rpcRequest({method:e,params:t},el(r,i,!1))}catch(e){i(e)}}):e&&"object"==typeof e&&"function"==typeof t?this._rpcRequest(e,t):this._sendSync(e)}_sendSync(e){let t;switch(e.method){case"eth_accounts":t=this.selectedAddress?[this.selectedAddress]:[];break;case"eth_coinbase":t=this.selectedAddress||null;break;case"eth_uninstallFilter":this._rpcRequest(e,eo),t=!0;break;case"net_version":t=this.networkVersion||null;break;default:throw Error(J.errors.unsupportedSync(e.method))}return{id:e.id,jsonrpc:e.jsonrpc,result:t}}_handleConnect(e){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{chainId:e}),z.debug(J.info.connected(e)))}_handleDisconnect(e,t){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!e){let r;this._state.isConnected=!1,e?(r=new u.yd(1013,t||J.errors.disconnected()),z.debug(r)):(r=new u.yd(1011,t||J.errors.permanentlyDisconnected()),z.error(r),this.chainId=null,this._state.accounts=null,this.selectedAddress=null,this._state.isUnlocked=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",r)}}_handleStreamDisconnect(e,t){let r;r=`MetaMask: Lost connection to "${e}".`,null!=t&&t.stack&&(r+=`
${t.stack}`),z.warn(r),this&&this.listenerCount("error")>0&&this.emit("error",r),this._handleDisconnect(!1,t?t.message:void 0)}_handleAccountsChanged(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e;for(let t of(Array.isArray(i)||(z.error("MetaMask: Received non-array accounts parameter. Please report this bug.",i),i=[]),e))if("string"!=typeof t){z.error("MetaMask: Received non-string account. Please report this bug.",e),i=[];break}M()(this._state.accounts,i)||(t&&Array.isArray(this._state.accounts)&&this._state.accounts.length>0&&!r&&z.error('MetaMask: "eth_accounts" unexpectedly updated accounts. Please report this bug.',i),this._state.accounts=i,this.emit("accountsChanged",i)),this.selectedAddress!==i[0]&&(this.selectedAddress=i[0]||null)}_handleChainChanged(){let{chainId:e,networkVersion:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e||!t){z.error("MetaMask: Received invalid network parameters. Please report this bug.",{chainId:e,networkVersion:t});return}"loading"===t?this._handleDisconnect(!0):(this._handleConnect(e),e!==this.chainId&&(this.chainId=e,this._state.initialized&&this.emit("chainChanged",this.chainId)))}_handleUnlockStateChanged(){let{accounts:e,isUnlocked:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("boolean"!=typeof t){z.error("MetaMask: Received invalid isUnlocked parameter. Please report this bug.",{isUnlocked:t});return}t!==this._state.isUnlocked&&(this._state.isUnlocked=t,this._handleAccountsChanged(e||[]))}}(0,n.Z)(ed,"_defaultState",{accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1,hasEmittedConnection:!1});class eu extends _{constructor(e){let{url:t,target:r,features:i,timeout:o=3e4}=e;super(),(0,n.Z)(this,"url",void 0),(0,n.Z)(this,"target",void 0),(0,n.Z)(this,"features",void 0),(0,n.Z)(this,"window",void 0),(0,n.Z)(this,"windowTimer",void 0),(0,n.Z)(this,"iClosedWindow",void 0),(0,n.Z)(this,"timeout",void 0),this.url=t,this.target=r||"_blank",this.features=i||function(){let e=void 0!==window.screenLeft?window.screenLeft:window.screenX,t=void 0!==window.screenTop?window.screenTop:window.screenY,r=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,i=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height;return`titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=700,width=1200,top=${Math.abs((i-700)/2/1+t)},left=${Math.abs((r-1200)/2/1+e)}`}(),this.window=void 0,this.windowTimer=void 0,this.iClosedWindow=!1,this.timeout=o,this._setupTimer()}_setupTimer(){this.windowTimer=Number(setInterval(()=>{this.window&&this.window.closed&&(clearInterval(this.windowTimer),setTimeout(()=>{this.iClosedWindow||this.emit("close"),this.iClosedWindow=!1,this.window=void 0},this.timeout)),void 0===this.window&&clearInterval(this.windowTimer)},500))}open(){var e;this.window=window.open(this.url.href,this.target,this.features),null!==(e=this.window)&&void 0!==e&&e.focus&&this.window.focus()}close(){this.iClosedWindow=!0,this.window&&this.window.close()}redirect(e){e?window.location.replace(this.url.href):window.location.href=this.url.href}}function ec(e){return new Promise((t,r)=>{try{let r=document.createElement("img");r.onload=()=>t(!0),r.onerror=()=>t(!1),r.src=e}catch(e){r(e)}})}let eh=e=>{let{document:t}=e,r=t.querySelector('head > meta[property="og:site_name"]');if(r)return r.content;let i=t.querySelector('head > meta[name="title"]');return i?i.content:t.title&&t.title.length>0?t.title:e.location.hostname};async function ef(e){let{document:t}=e,r=t.querySelector('head > link[rel="shortcut icon"]');return r&&await ec(r.href)||(r=Array.from(t.querySelectorAll('head > link[rel="icon"]')).find(e=>!!e.href))&&await ec(r.href)?r.href:null}let ep=async()=>({name:eh(window),icon:await ef(window)});async function eb(e){try{let t=await ep();e.handle({jsonrpc:"2.0",id:et(),method:"wallet_sendDomainMetadata",params:t},eo)}catch(e){z.error({message:J.errors.sendSiteMetadata(),originalError:e})}}let ey=["host","chainId","networkName"],eg=["eth_sendTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","personal_sign","eth_getEncryptionPublicKey","eth_decrypt","wallet_addEthereumChain","wallet_switchEthereumChain"];!async function(){try{if("undefined"==typeof document)return;let e=document.createElement("link"),{torusUrl:t}=await er("production",{version:""});e.href=`${t}/popup`,e.crossOrigin="anonymous",e.type="text/html",e.rel="prefetch",e.relList&&e.relList.supports&&e.relList.supports("prefetch")&&document.head.appendChild(e)}catch(e){z.warn(e)}}();class ew{constructor(){let{buttonPosition:e=H.BOTTOM_LEFT,buttonSize:t=56,modalZIndex:r=99999,apiKey:i="torus-default"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,n.Z)(this,"buttonPosition",H.BOTTOM_LEFT),(0,n.Z)(this,"buttonSize",void 0),(0,n.Z)(this,"torusUrl",void 0),(0,n.Z)(this,"torusIframe",void 0),(0,n.Z)(this,"styleLink",void 0),(0,n.Z)(this,"isLoggedIn",void 0),(0,n.Z)(this,"isInitialized",void 0),(0,n.Z)(this,"torusWidgetVisibility",void 0),(0,n.Z)(this,"torusAlert",void 0),(0,n.Z)(this,"apiKey",void 0),(0,n.Z)(this,"modalZIndex",void 0),(0,n.Z)(this,"alertZIndex",void 0),(0,n.Z)(this,"torusAlertContainer",void 0),(0,n.Z)(this,"isIframeFullScreen",void 0),(0,n.Z)(this,"whiteLabel",void 0),(0,n.Z)(this,"requestedVerifier",void 0),(0,n.Z)(this,"currentVerifier",void 0),(0,n.Z)(this,"embedTranslations",void 0),(0,n.Z)(this,"ethereum",void 0),(0,n.Z)(this,"provider",void 0),(0,n.Z)(this,"communicationMux",void 0),(0,n.Z)(this,"isLoginCallback",void 0),(0,n.Z)(this,"paymentProviders",q.paymentProviders),(0,n.Z)(this,"loginHint",""),(0,n.Z)(this,"useWalletConnect",void 0),(0,n.Z)(this,"isCustomLogin",!1),this.buttonPosition=e,this.buttonSize=t,this.torusUrl="",this.isLoggedIn=!1,this.isInitialized=!1,this.torusWidgetVisibility=!0,this.requestedVerifier="",this.currentVerifier="",this.apiKey=i,(0,o.ut)(i),this.modalZIndex=r,this.alertZIndex=r+1e3,this.isIframeFullScreen=!1}async init(){let{buildEnv:e="production",enableLogging:t=!1,network:r={host:"mainnet",chainId:null,networkName:"",blockExplorer:"",ticker:"",tickerName:""},loginConfig:i={},showTorusButton:n=!0,integrity:o={version:""},whiteLabel:a,useWalletConnect:s=!1,mfaLevel:l="default"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.isInitialized)throw Error("Already initialized");let{torusUrl:d,logLevel:u}=await er(e,o);z.info(d,"url loaded"),this.torusUrl=d,this.whiteLabel=a,this.useWalletConnect=s,this.isCustomLogin=!!(i&&Object.keys(i).length>0)||!!(a&&Object.keys(a).length>0),z.setDefaultLevel(u),t?z.enableAll():z.disableAll(),this.torusWidgetVisibility=n;let c=new URL(d);c.pathname.endsWith("/")?c.pathname+="popup":c.pathname+="/popup",c.hash=`#isCustomLogin=${this.isCustomLogin}`,this.torusIframe=G(`<iframe
        id="torusIframe"
        allow=${s?"camera":""}
        class="torusIframe"
        src="${c.href}"
        style="display: none; position: fixed; top: 0; right: 0; width: 100%; color-scheme: none;
        height: 100%; border: none; border-radius: 0; z-index: ${this.modalZIndex}"
      ></iframe>`),this.torusAlertContainer=G('<div id="torusAlertContainer"></div>'),this.torusAlertContainer.style.display="none",this.torusAlertContainer.style.setProperty("z-index",this.alertZIndex.toString());let h=window.document.createElement("link");h.setAttribute("rel","stylesheet"),h.setAttribute("type","text/css"),h.setAttribute("href",`${d}/css/widget.css`),this.styleLink=h;let{defaultLanguage:f=ei(),customTranslations:p={}}=this.whiteLabel||{},b=C()(q.translations,p)[f]||q.translations[ei()];return this.embedTranslations=b.embed,new Promise((e,t)=>{this.torusIframe.onload=async()=>{this._setupWeb3();let n=this.communicationMux.getStream("init_stream");n.on("data",r=>{let{name:i,data:n,error:o}=r;"init_complete"===i&&n.success?(this.isInitialized=!0,this._displayIframe(this.isIframeFullScreen),e(void 0)):o&&t(Error(o))}),n.write({name:"init_stream",data:{loginConfig:i,whiteLabel:this.whiteLabel,buttonPosition:this.buttonPosition,buttonSize:this.buttonSize,torusWidgetVisibility:this.torusWidgetVisibility,apiKey:this.apiKey,network:r,mfaLevel:l}})},window.document.head.appendChild(this.styleLink),window.document.body.appendChild(this.torusIframe),window.document.body.appendChild(this.torusAlertContainer)})}login(){let{verifier:e="",login_hint:t=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.isInitialized)throw Error("Call init() first");return this.requestedVerifier=e,this.loginHint=t,this.ethereum.enable()}logout(){return new Promise((e,t)=>{if(!this.isLoggedIn){t(Error("User has not logged in yet"));return}this.communicationMux.getStream("logout").write({name:"logOut"}),Y(this.communicationMux.getStream("status"),"data",r=>{r.loggedIn?t(Error("Some Error Occured")):(this.isLoggedIn=!1,this.currentVerifier="",this.requestedVerifier="",e())})})}async cleanUp(){this.isLoggedIn&&await this.logout(),this.clearInit()}clearInit(){function e(e){return e instanceof Element||e instanceof HTMLDocument}e(this.styleLink)&&window.document.body.contains(this.styleLink)&&(this.styleLink.remove(),this.styleLink=void 0),e(this.torusIframe)&&window.document.body.contains(this.torusIframe)&&(this.torusIframe.remove(),this.torusIframe=void 0),e(this.torusAlertContainer)&&window.document.body.contains(this.torusAlertContainer)&&(this.torusAlert=void 0,this.torusAlertContainer.remove(),this.torusAlertContainer=void 0),this.isInitialized=!1}hideTorusButton(){this.torusWidgetVisibility=!1,this._sendWidgetVisibilityStatus(!1),this._displayIframe()}showTorusButton(){this.torusWidgetVisibility=!0,this._sendWidgetVisibilityStatus(!0),this._displayIframe()}setProvider(e){let{host:t="mainnet",chainId:r=null,networkName:n=""}=e,o=function(e,t){if(null==e)return{};var r,i,n=function(e,t){if(null==e)return{};var r,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,ey);return new Promise((e,a)=>{let s=this.communicationMux.getStream("provider_change");Y(s,"data",t=>{let{err:r,success:i}=t.data;z.info(t),r?a(r):i?e():a(Error("some error occurred"))});let l=et();this._handleWindow(l,{target:"_blank",features:ea}),s.write({name:"show_provider_change",data:{network:(0,i.Z)({host:t,chainId:r,networkName:n},o),preopenInstanceId:l,override:!1}})})}showWallet(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.communicationMux.getStream("show_wallet"),i=e?`/${e}`:"";r.write({name:"show_wallet",data:{path:i}}),Y(r,"data",e=>{if("show_wallet_instance"===e.name){let{instanceId:r}=e.data,n=new URL(`${this.torusUrl}/wallet${i}`);n.searchParams.append("integrity","true"),n.searchParams.append("instanceId",r),Object.keys(t).forEach(e=>{n.searchParams.append(e,t[e])}),n.hash=`#isCustomLogin=${this.isCustomLogin}`,new eu({url:n,features:"directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=740,width=1315"}).open()}})}async getPublicAddress(e){let{verifier:t,verifierId:r,isExtended:i=!1}=e;if(!q.supportedVerifierList.includes(t)||!N[t])throw Error("Unsupported verifier");let n=N[t],a=new URL("https://api.tor.us/lookup/torus");return a.searchParams.append("verifier",n),a.searchParams.append("verifierId",r),a.searchParams.append("walletVerifier",t),a.searchParams.append("network","mainnet"),a.searchParams.append("isExtended",i.toString()),(0,o.U2)(a.href,{headers:{"Content-Type":"application/json; charset=utf-8"}},{useAPIKey:!0})}getUserInfo(e){return new Promise((t,r)=>{if(this.isLoggedIn){let i=this.communicationMux.getStream("user_info_access");i.write({name:"user_info_access_request"}),Y(i,"data",i=>{let{name:n,data:{approved:o,payload:a,rejected:s,newRequest:l}}=i;if("user_info_access_response"===n){if(o)t(a);else if(s)r(Error("User rejected the request"));else if(l){let i=this.communicationMux.getStream("user_info");Y(i,"data",e=>{"user_info_response"===e.name&&(e.data.approved?t(e.data.payload):r(Error("User rejected the request")))});let n=et();this._handleWindow(n,{target:"_blank",features:ea}),i.write({name:"user_info_request",data:{message:e,preopenInstanceId:n}})}}})}else r(Error("User has not logged in yet"))})}initiateTopup(e,t){return new Promise((r,i)=>{if(this.isInitialized){let{errors:n,isValid:o}=ee(e,t);if(!o){i(Error(JSON.stringify(n)));return}let a=this.communicationMux.getStream("topup");Y(a,"data",e=>{"topup_response"===e.name&&(e.data.success?r(e.data.success):i(Error(e.data.error)))});let s=et();this._handleWindow(s),a.write({name:"topup_request",data:{provider:e,params:t,preopenInstanceId:s}})}else i(Error("Torus is not initialized yet"))})}async loginWithPrivateKey(e){let{privateKey:t,userInfo:r}=e;return new Promise((e,i)=>{if(this.isInitialized){if(32!==P.from(t,"hex").length){i(Error("Invalid private key, Please provide a 32 byte valid secp25k1 private key"));return}let n=this.communicationMux.getStream("login_with_private_key");Y(n,"data",t=>{"login_with_private_key_response"===t.name&&(t.data.success?e(t.data.success):i(Error(t.data.error)))}),n.write({name:"login_with_private_key_request",data:{privateKey:t,userInfo:r}})}else i(Error("Torus is not initialized yet"))})}async showWalletConnectScanner(){if(!this.useWalletConnect)throw Error("Set `useWalletConnect` as true in init function options to use wallet connect scanner");return new Promise((e,t)=>{if(this.isLoggedIn){let r=this.communicationMux.getStream("wallet_connect_stream");Y(r,"data",r=>{"wallet_connect_stream_res"===r.name&&(r.data.success?e(r.data.success):t(Error(r.data.error)),this._displayIframe())}),r.write({name:"wallet_connect_stream_req"}),this._displayIframe(!0)}else t(Error("User has not logged in yet"))})}_handleWindow(e){let{url:t,target:r,features:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){let n=this.communicationMux.getStream("window"),o=new URL(t||`${this.torusUrl}/redirect?preopenInstanceId=${e}`);o.hash?o.hash+=`&isCustomLogin=${this.isCustomLogin}`:o.hash=`#isCustomLogin=${this.isCustomLogin}`;let a=new eu({url:o,target:r,features:i});if(a.open(),!a.window){this._createPopupBlockAlert(e,o.href);return}n.write({name:"opened_window",data:{preopenInstanceId:e}});let s=t=>{let{preopenInstanceId:r,close:i}=t;r===e&&i&&(a.close(),n.removeListener("data",s))};n.on("data",s),a.once("close",()=>{n.write({data:{preopenInstanceId:e,closed:!0}}),n.removeListener("data",s)})}}_setEmbedWhiteLabel(e){let{theme:t}=this.whiteLabel||{};if(t){let{isDark:r=!1,colors:i={}}=t;r&&e.classList.add("torus-dark"),i.torusBrand1&&e.style.setProperty("--torus-brand-1",i.torusBrand1),i.torusGray2&&e.style.setProperty("--torus-gray-2",i.torusGray2)}}_getLogoUrl(){var e,t,r;let i=`${this.torusUrl}/images/torus_icon-blue.svg`;return null!==(e=this.whiteLabel)&&void 0!==e&&null!==(e=e.theme)&&void 0!==e&&e.isDark?(null===(t=this.whiteLabel)||void 0===t?void 0:t.logoLight)||i:(null===(r=this.whiteLabel)||void 0===r?void 0:r.logoDark)||i}_sendWidgetVisibilityStatus(e){this.communicationMux.getStream("torus-widget-visibility").write({data:e})}_displayIframe(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t={},r=this.buttonSize+14;if(e)t.display="block",t.width="100%",t.height="100%",t.top="0px",t.right="0px",t.left="0px",t.bottom="0px";else switch(t.display=this.torusWidgetVisibility?"block":"none",t.height=`${r}px`,t.width=`${r}px`,this.buttonPosition){case H.TOP_LEFT:t.top="0px",t.left="0px",t.right="auto",t.bottom="auto";break;case H.TOP_RIGHT:t.top="0px",t.right="0px",t.left="auto",t.bottom="auto";break;case H.BOTTOM_RIGHT:t.bottom="0px",t.right="0px",t.top="auto",t.left="auto";break;case H.BOTTOM_LEFT:default:t.bottom="0px",t.left="0px",t.top="auto",t.right="auto"}Object.assign(this.torusIframe.style,t),this.isIframeFullScreen=e}_setupWeb3(){z.info("setupWeb3 running");let e=new w({name:"embed_metamask",target:"iframe_metamask",targetWindow:this.torusIframe.contentWindow,targetOrigin:new URL(this.torusUrl).origin}),t=new w({name:"embed_comm",target:"iframe_comm",targetWindow:this.torusIframe.contentWindow,targetOrigin:new URL(this.torusUrl).origin}),r=new ed(e),i=e=>{let t=r[e];r[e]=function(e){if(e&&"eth_requestAccounts"===e)return r.enable();for(var i=arguments.length,n=Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];return t.apply(this,[e,...n])}};i("send"),i("sendAsync"),r.enable=()=>new Promise((e,t)=>{r.sendAsync({jsonrpc:"2.0",id:et(),method:"eth_requestAccounts",params:[]},(r,i)=>{let{result:n}=i||{};if(r)setTimeout(()=>{t(r)},50);else if(Array.isArray(n)&&n.length>0){let r=()=>{if(""!==this.requestedVerifier&&this.currentVerifier!==this.requestedVerifier){let{requestedVerifier:r}=this;this.logout().then(i=>{this.requestedVerifier=r,this._showLoginPopup(!0,e,t)}).catch(e=>t(e))}else e(n)};this.isLoggedIn?r():this.isLoginCallback=r}else this._showLoginPopup(!0,e,t)})}),r.tryPreopenHandle=(e,t)=>{if(!Array.isArray(e)&&eg.includes(e.method)){let t=et();this._handleWindow(t,{target:"_blank",features:es}),e.preopenInstanceId=t}r._rpcEngine.handle(e,t)};let n=new Proxy(r,{deleteProperty:()=>!0});this.ethereum=n;let o=function(e){let t=new T;return t.getStream=function(e){return this._substreams[e]?this._substreams[e]:this.createStream(e)},y()(e,t,e,e=>{e&&window.console.error(e)}),t}(t);this.communicationMux=o,o.getStream("window").on("data",e=>{"create_window"===e.name&&this._createPopupBlockAlert(e.data.preopenInstanceId,e.data.url)}),o.getStream("widget").on("data",e=>{let{data:t}=e;this._displayIframe(t)}),o.getStream("status").on("data",e=>{e.loggedIn?(this.isLoggedIn=e.loggedIn,this.currentVerifier=e.verifier):this._displayIframe(),this.isLoginCallback&&(this.isLoginCallback(),delete this.isLoginCallback)}),this.provider=n,this.provider.shouldSendMetadata&&eb(this.provider._rpcEngine),r._initializeState(),z.debug("Torus - injected provider")}_showLoginPopup(e,t,r){let i=e=>{let{err:i,selectedAddress:n}=e;i?(z.error(i),r&&r(i)):t&&t([n]),this.isIframeFullScreen&&this._displayIframe()},n=this.communicationMux.getStream("oauth");if(this.requestedVerifier){Y(n,"data",i);let t=et();this._handleWindow(t),n.write({name:"oauth",data:{calledFromEmbed:e,verifier:this.requestedVerifier,preopenInstanceId:t,login_hint:this.loginHint}})}else this._displayIframe(!0),Y(n,"data",i),n.write({name:"oauth_modal",data:{calledFromEmbed:e}})}_createPopupBlockAlert(e,t){let r=this._getLogoUrl(),i=G(`<div id="torusAlert" class="torus-alert--v2"><div id="torusAlert__logo"><img src="${r}" /></div><div><h1 id="torusAlert__title">${this.embedTranslations.actionRequired}</h1><p id="torusAlert__desc">${this.embedTranslations.pendingAction}</p></div></div>`),n=G(`<div><a id="torusAlert__btn">${this.embedTranslations.continue}</a></div>`),o=G('<div id="torusAlert__btn-container"></div>');o.appendChild(n),i.appendChild(o),this._setEmbedWhiteLabel(i),this.torusAlertContainer.style.display="block",this.torusAlertContainer.appendChild(i),n.addEventListener("click",()=>{this._handleWindow(e,{url:t,target:"_blank",features:es}),i.remove(),0===this.torusAlertContainer.children.length&&(this.torusAlertContainer.style.display="none")})}}var em=r(85783),e_=r(35796);class ev extends e_.d{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),(0,n.Z)(this,"name",em.rW.TORUS_EVM),(0,n.Z)(this,"adapterNamespace",em.yk.EIP155),(0,n.Z)(this,"currentChainNamespace",em.EN.EIP155),(0,n.Z)(this,"type",em.hN.EXTERNAL),(0,n.Z)(this,"status",em.MP.NOT_READY),(0,n.Z)(this,"torusInstance",null),(0,n.Z)(this,"torusWalletOptions",void 0),(0,n.Z)(this,"initParams",void 0),(0,n.Z)(this,"loginSettings",{}),this.torusWalletOptions=e.adapterSettings||{},this.initParams=e.initParams||{},this.loginSettings=e.loginSettings||{}}get provider(){return this.status!==em.MP.NOT_READY&&this.torusInstance?this.torusInstance.provider:null}set provider(e){throw Error("Not implemented")}async init(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await super.init(e),super.checkInitializationRequirements();let{chainId:t,blockExplorer:r,displayName:n,rpcTarget:o,ticker:a,tickerName:s}=this.chainConfig,l={chainId:Number.parseInt(t,16),host:o,blockExplorer:r,networkName:n,ticker:a,tickerName:s};this.torusInstance=new ew(this.torusWalletOptions),em.cM.debug("initializing torus evm adapter init"),await this.torusInstance.init((0,i.Z)((0,i.Z)({showTorusButton:!1},this.initParams),{},{network:l})),this.status=em.MP.READY,this.emit(em.n2.READY,em.rW.TORUS_EVM);try{em.cM.debug("initializing torus evm adapter"),e.autoConnect&&(this.rehydrated=!0,await this.connect())}catch(e){em.cM.error("Failed to connect with torus evm provider",e),this.emit(em.n2.ERRORED,e)}}async connect(){if(super.checkConnectionRequirements(),!this.torusInstance)throw em.Ty.notReady("Torus wallet is not initialized");this.status=em.MP.CONNECTING,this.emit(em.n2.CONNECTING,{adapter:em.rW.TORUS_EVM});try{await this.torusInstance.login(this.loginSettings);let e=await this.torusInstance.provider.request({method:"eth_chainId"});if(e&&parseInt(e)!==parseInt(this.chainConfig.chainId,16)){let{chainId:e,blockExplorer:t,displayName:r,rpcTarget:n,ticker:o,tickerName:a}=this.chainConfig,s={chainId:Number.parseInt(e,16),host:n,blockExplorer:t,networkName:r,tickerName:a,ticker:o};await this.torusInstance.setProvider((0,i.Z)({},s));let l=await this.torusInstance.ethereum.request({method:"eth_chainId"});if(l&&parseInt(l)!==parseInt(this.chainConfig.chainId,16))throw em.Ty.fromCode(5e3,`Not connected to correct chainId. Expected: ${this.chainConfig.chainId}, Current: ${l}`)}return this.status=em.MP.CONNECTED,this.torusInstance.showTorusButton(),this.emit(em.MP.CONNECTED,{adapter:em.rW.TORUS_EVM,reconnected:this.rehydrated}),this.provider}catch(e){throw this.status=em.MP.READY,this.rehydrated=!1,this.emit(em.MP.ERRORED,e),e instanceof em.up?e:em.RM.connectionError("Failed to login with torus wallet")}}async disconnect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cleanup:!1};if(await super.disconnectSession(),!this.torusInstance)throw em.Ty.notReady("Torus wallet is not initialized");await this.torusInstance.logout(),this.torusInstance.hideTorusButton(),e.cleanup?(this.status=em.MP.NOT_READY,this.torusInstance=null):this.status=em.MP.READY,await super.disconnect()}async getUserInfo(){if(this.status!==em.MP.CONNECTED)throw em.RM.notConnectedError("Not connected with wallet");if(!this.torusInstance)throw em.Ty.notReady("Torus wallet is not initialized");return await this.torusInstance.getUserInfo("")}async addChain(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.checkAddChainRequirements(e,t),this.addChainConfig(e)}async switchChain(e){var t;let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.checkSwitchChainRequirements(e,r);let i=this.getChainConfig(e.chainId);await (null===(t=this.torusInstance)||void 0===t?void 0:t.setProvider({host:i.rpcTarget,chainId:parseInt(i.chainId,16),networkName:i.displayName,blockExplorer:i.blockExplorer,ticker:i.ticker,tickerName:i.tickerName})),this.setAdapterSettings({chainConfig:this.getChainConfig(e.chainId)})}}},64063:function(e){"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;if(Array.isArray(t)){if((i=t.length)!=r.length)return!1;for(n=i;0!=n--;)if(!e(t[n],r[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((i=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(n=i;0!=n--;)if(!Object.prototype.hasOwnProperty.call(r,o[n]))return!1;for(n=i;0!=n--;){var i,n,o,a=o[n];if(!e(t[a],r[a]))return!1}return!0}return t!=t&&r!=r}}}]);