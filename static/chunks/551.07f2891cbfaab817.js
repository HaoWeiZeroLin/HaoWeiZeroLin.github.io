(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[551],{31050:function(i,r,o){"use strict";r.Xx=r._w=r.aP=r.KS=r.jQ=void 0,o(31416);let c=o(93350);function gf(i){let r=new Float64Array(16);if(i)for(let o=0;o<i.length;o++)r[o]=i[o];return r}o(17309),r.jQ=64,r.KS=64,r.aP=32;let l=new Uint8Array(32);l[0]=9;let f=gf(),m=gf([1]),v=(gf([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),gf([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222])),w=gf([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),E=gf([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]);function set25519(i,r){for(let o=0;o<16;o++)i[o]=0|r[o]}function car25519(i){let r=1;for(let o=0;o<16;o++){let c=i[o]+r+65535;r=Math.floor(c/65536),i[o]=c-65536*r}i[0]+=r-1+37*(r-1)}function sel25519(i,r,o){let c=~(o-1);for(let o=0;o<16;o++){let l=c&(i[o]^r[o]);i[o]^=l,r[o]^=l}}function pack25519(i,r){let o=gf(),c=gf();for(let i=0;i<16;i++)c[i]=r[i];car25519(c),car25519(c),car25519(c);for(let i=0;i<2;i++){o[0]=c[0]-65517;for(let i=1;i<15;i++)o[i]=c[i]-65535-(o[i-1]>>16&1),o[i-1]&=65535;o[15]=c[15]-32767-(o[14]>>16&1);let i=o[15]>>16&1;o[14]&=65535,sel25519(c,o,1-i)}for(let r=0;r<16;r++)i[2*r]=255&c[r],i[2*r+1]=c[r]>>8}gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function add(i,r,o){for(let c=0;c<16;c++)i[c]=r[c]+o[c]}function sub(i,r,o){for(let c=0;c<16;c++)i[c]=r[c]-o[c]}function mul(i,r,o){let c,l,f=0,m=0,v=0,w=0,E=0,I=0,P=0,R=0,x=0,N=0,C=0,T=0,A=0,D=0,L=0,M=0,V=0,U=0,$=0,H=0,J=0,G=0,F=0,Z=0,W=0,Q=0,Y=0,ee=0,et=0,ei=0,es=0,en=o[0],eo=o[1],ea=o[2],ec=o[3],el=o[4],eh=o[5],eu=o[6],ed=o[7],ep=o[8],eg=o[9],ef=o[10],ey=o[11],em=o[12],e_=o[13],ev=o[14],ew=o[15];f+=(c=r[0])*en,m+=c*eo,v+=c*ea,w+=c*ec,E+=c*el,I+=c*eh,P+=c*eu,R+=c*ed,x+=c*ep,N+=c*eg,C+=c*ef,T+=c*ey,A+=c*em,D+=c*e_,L+=c*ev,M+=c*ew,m+=(c=r[1])*en,v+=c*eo,w+=c*ea,E+=c*ec,I+=c*el,P+=c*eh,R+=c*eu,x+=c*ed,N+=c*ep,C+=c*eg,T+=c*ef,A+=c*ey,D+=c*em,L+=c*e_,M+=c*ev,V+=c*ew,v+=(c=r[2])*en,w+=c*eo,E+=c*ea,I+=c*ec,P+=c*el,R+=c*eh,x+=c*eu,N+=c*ed,C+=c*ep,T+=c*eg,A+=c*ef,D+=c*ey,L+=c*em,M+=c*e_,V+=c*ev,U+=c*ew,w+=(c=r[3])*en,E+=c*eo,I+=c*ea,P+=c*ec,R+=c*el,x+=c*eh,N+=c*eu,C+=c*ed,T+=c*ep,A+=c*eg,D+=c*ef,L+=c*ey,M+=c*em,V+=c*e_,U+=c*ev,$+=c*ew,E+=(c=r[4])*en,I+=c*eo,P+=c*ea,R+=c*ec,x+=c*el,N+=c*eh,C+=c*eu,T+=c*ed,A+=c*ep,D+=c*eg,L+=c*ef,M+=c*ey,V+=c*em,U+=c*e_,$+=c*ev,H+=c*ew,I+=(c=r[5])*en,P+=c*eo,R+=c*ea,x+=c*ec,N+=c*el,C+=c*eh,T+=c*eu,A+=c*ed,D+=c*ep,L+=c*eg,M+=c*ef,V+=c*ey,U+=c*em,$+=c*e_,H+=c*ev,J+=c*ew,P+=(c=r[6])*en,R+=c*eo,x+=c*ea,N+=c*ec,C+=c*el,T+=c*eh,A+=c*eu,D+=c*ed,L+=c*ep,M+=c*eg,V+=c*ef,U+=c*ey,$+=c*em,H+=c*e_,J+=c*ev,G+=c*ew,R+=(c=r[7])*en,x+=c*eo,N+=c*ea,C+=c*ec,T+=c*el,A+=c*eh,D+=c*eu,L+=c*ed,M+=c*ep,V+=c*eg,U+=c*ef,$+=c*ey,H+=c*em,J+=c*e_,G+=c*ev,F+=c*ew,x+=(c=r[8])*en,N+=c*eo,C+=c*ea,T+=c*ec,A+=c*el,D+=c*eh,L+=c*eu,M+=c*ed,V+=c*ep,U+=c*eg,$+=c*ef,H+=c*ey,J+=c*em,G+=c*e_,F+=c*ev,Z+=c*ew,N+=(c=r[9])*en,C+=c*eo,T+=c*ea,A+=c*ec,D+=c*el,L+=c*eh,M+=c*eu,V+=c*ed,U+=c*ep,$+=c*eg,H+=c*ef,J+=c*ey,G+=c*em,F+=c*e_,Z+=c*ev,W+=c*ew,C+=(c=r[10])*en,T+=c*eo,A+=c*ea,D+=c*ec,L+=c*el,M+=c*eh,V+=c*eu,U+=c*ed,$+=c*ep,H+=c*eg,J+=c*ef,G+=c*ey,F+=c*em,Z+=c*e_,W+=c*ev,Q+=c*ew,T+=(c=r[11])*en,A+=c*eo,D+=c*ea,L+=c*ec,M+=c*el,V+=c*eh,U+=c*eu,$+=c*ed,H+=c*ep,J+=c*eg,G+=c*ef,F+=c*ey,Z+=c*em,W+=c*e_,Q+=c*ev,Y+=c*ew,A+=(c=r[12])*en,D+=c*eo,L+=c*ea,M+=c*ec,V+=c*el,U+=c*eh,$+=c*eu,H+=c*ed,J+=c*ep,G+=c*eg,F+=c*ef,Z+=c*ey,W+=c*em,Q+=c*e_,Y+=c*ev,ee+=c*ew,D+=(c=r[13])*en,L+=c*eo,M+=c*ea,V+=c*ec,U+=c*el,$+=c*eh,H+=c*eu,J+=c*ed,G+=c*ep,F+=c*eg,Z+=c*ef,W+=c*ey,Q+=c*em,Y+=c*e_,ee+=c*ev,et+=c*ew,L+=(c=r[14])*en,M+=c*eo,V+=c*ea,U+=c*ec,$+=c*el,H+=c*eh,J+=c*eu,G+=c*ed,F+=c*ep,Z+=c*eg,W+=c*ef,Q+=c*ey,Y+=c*em,ee+=c*e_,et+=c*ev,ei+=c*ew,M+=(c=r[15])*en,V+=c*eo,U+=c*ea,$+=c*ec,H+=c*el,J+=c*eh,G+=c*eu,F+=c*ed,Z+=c*ep,W+=c*eg,Q+=c*ef,Y+=c*ey,ee+=c*em,et+=c*e_,ei+=c*ev,es+=c*ew,f+=38*V,m+=38*U,v+=38*$,w+=38*H,E+=38*J,I+=38*G,P+=38*F,R+=38*Z,x+=38*W,N+=38*Q,C+=38*Y,T+=38*ee,A+=38*et,D+=38*ei,L+=38*es,l=Math.floor((c=f+(l=1)+65535)/65536),f=c-65536*l,l=Math.floor((c=m+l+65535)/65536),m=c-65536*l,l=Math.floor((c=v+l+65535)/65536),v=c-65536*l,l=Math.floor((c=w+l+65535)/65536),w=c-65536*l,l=Math.floor((c=E+l+65535)/65536),E=c-65536*l,l=Math.floor((c=I+l+65535)/65536),I=c-65536*l,l=Math.floor((c=P+l+65535)/65536),P=c-65536*l,l=Math.floor((c=R+l+65535)/65536),R=c-65536*l,l=Math.floor((c=x+l+65535)/65536),x=c-65536*l,l=Math.floor((c=N+l+65535)/65536),N=c-65536*l,l=Math.floor((c=C+l+65535)/65536),C=c-65536*l,l=Math.floor((c=T+l+65535)/65536),T=c-65536*l,l=Math.floor((c=A+l+65535)/65536),A=c-65536*l,l=Math.floor((c=D+l+65535)/65536),D=c-65536*l,l=Math.floor((c=L+l+65535)/65536),L=c-65536*l,l=Math.floor((c=M+l+65535)/65536),M=c-65536*l,f+=l-1+37*(l-1),l=Math.floor((c=f+(l=1)+65535)/65536),f=c-65536*l,l=Math.floor((c=m+l+65535)/65536),m=c-65536*l,l=Math.floor((c=v+l+65535)/65536),v=c-65536*l,l=Math.floor((c=w+l+65535)/65536),w=c-65536*l,l=Math.floor((c=E+l+65535)/65536),E=c-65536*l,l=Math.floor((c=I+l+65535)/65536),I=c-65536*l,l=Math.floor((c=P+l+65535)/65536),P=c-65536*l,l=Math.floor((c=R+l+65535)/65536),R=c-65536*l,l=Math.floor((c=x+l+65535)/65536),x=c-65536*l,l=Math.floor((c=N+l+65535)/65536),N=c-65536*l,l=Math.floor((c=C+l+65535)/65536),C=c-65536*l,l=Math.floor((c=T+l+65535)/65536),T=c-65536*l,l=Math.floor((c=A+l+65535)/65536),A=c-65536*l,l=Math.floor((c=D+l+65535)/65536),D=c-65536*l,l=Math.floor((c=L+l+65535)/65536),L=c-65536*l,l=Math.floor((c=M+l+65535)/65536),M=c-65536*l,f+=l-1+37*(l-1),i[0]=f,i[1]=m,i[2]=v,i[3]=w,i[4]=E,i[5]=I,i[6]=P,i[7]=R,i[8]=x,i[9]=N,i[10]=C,i[11]=T,i[12]=A,i[13]=D,i[14]=L,i[15]=M}function edadd(i,r){let o=gf(),c=gf(),l=gf(),f=gf(),m=gf(),w=gf(),E=gf(),I=gf(),P=gf();sub(o,i[1],i[0]),sub(P,r[1],r[0]),mul(o,o,P),add(c,i[0],i[1]),add(P,r[0],r[1]),mul(c,c,P),mul(l,i[3],r[3]),mul(l,l,v),mul(f,i[2],r[2]),add(f,f,f),sub(m,c,o),sub(w,f,l),add(E,f,l),add(I,c,o),mul(i[0],m,w),mul(i[1],I,E),mul(i[2],E,w),mul(i[3],m,I)}function cswap(i,r,o){for(let c=0;c<4;c++)sel25519(i[c],r[c],o)}function pack(i,r){let o=gf(),c=gf(),l=gf();(function(i,r){let o;let c=gf();for(o=0;o<16;o++)c[o]=r[o];for(o=253;o>=0;o--)mul(c,c,c),2!==o&&4!==o&&mul(c,c,r);for(o=0;o<16;o++)i[o]=c[o]})(l,r[2]),mul(o,r[0],l),mul(c,r[1],l),pack25519(i,c),i[31]^=function(i){let r=new Uint8Array(32);return pack25519(r,i),1&r[0]}(o)<<7}function scalarbase(i,r){let o=[gf(),gf(),gf(),gf()];set25519(o[0],w),set25519(o[1],E),set25519(o[2],m),mul(o[3],w,E),function(i,r,o){set25519(i[0],f),set25519(i[1],m),set25519(i[2],m),set25519(i[3],f);for(let c=255;c>=0;--c){let l=o[c/8|0]>>(7&c)&1;cswap(i,r,l),edadd(r,i),edadd(i,i),cswap(i,r,l)}}(i,o,r)}r._w=function(i){if(i.length!==r.aP)throw Error(`ed25519: seed must be ${r.aP} bytes`);let o=(0,c.hash)(i);o[0]&=248,o[31]&=127,o[31]|=64;let l=new Uint8Array(32),f=[gf(),gf(),gf(),gf()];scalarbase(f,o),pack(l,f);let m=new Uint8Array(64);return m.set(i),m.set(l,32),{publicKey:l,secretKey:m}};let I=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function modL(i,r){let o,c,l,f;for(c=63;c>=32;--c){for(o=0,l=c-32,f=c-12;l<f;++l)r[l]+=o-16*r[c]*I[l-(c-32)],o=Math.floor((r[l]+128)/256),r[l]-=256*o;r[l]+=o,r[c]=0}for(l=0,o=0;l<32;l++)r[l]+=o-(r[31]>>4)*I[l],o=r[l]>>8,r[l]&=255;for(l=0;l<32;l++)r[l]-=o*I[l];for(c=0;c<32;c++)r[c+1]+=r[c]>>8,i[c]=255&r[c]}function reduce(i){let r=new Float64Array(64);for(let o=0;o<64;o++)r[o]=i[o];for(let r=0;r<64;r++)i[r]=0;modL(i,r)}r.Xx=function(i,r){let o=new Float64Array(64),l=[gf(),gf(),gf(),gf()],f=(0,c.hash)(i.subarray(0,32));f[0]&=248,f[31]&=127,f[31]|=64;let m=new Uint8Array(64);m.set(f.subarray(32),32);let v=new c.SHA512;v.update(m.subarray(32)),v.update(r);let w=v.digest();v.clean(),reduce(w),scalarbase(l,w),pack(m,l),v.reset(),v.update(m.subarray(0,32)),v.update(i.subarray(32)),v.update(r);let E=v.digest();reduce(E);for(let i=0;i<32;i++)o[i]=w[i];for(let i=0;i<32;i++)for(let r=0;r<32;r++)o[i+r]+=E[i]*f[r];return modL(m.subarray(32),o),m}},93350:function(i,r,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var c=o(98099),l=o(17309);r.DIGEST_LENGTH=64,r.BLOCK_SIZE=128;var f=function(){function SHA512(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return SHA512.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},SHA512.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},SHA512.prototype.clean=function(){l.wipe(this._buffer),l.wipe(this._tempHi),l.wipe(this._tempLo),this.reset()},SHA512.prototype.update=function(i,o){if(void 0===o&&(o=i.length),this._finished)throw Error("SHA512: can't update because hash was finished.");var c=0;if(this._bytesHashed+=o,this._bufferLength>0){for(;this._bufferLength<r.BLOCK_SIZE&&o>0;)this._buffer[this._bufferLength++]=i[c++],o--;this._bufferLength===this.blockSize&&(hashBlocks(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(o>=this.blockSize&&(c=hashBlocks(this._tempHi,this._tempLo,this._stateHi,this._stateLo,i,c,o),o%=this.blockSize);o>0;)this._buffer[this._bufferLength++]=i[c++],o--;return this},SHA512.prototype.finish=function(i){if(!this._finished){var r=this._bytesHashed,o=this._bufferLength,l=r%128<112?128:256;this._buffer[o]=128;for(var f=o+1;f<l-8;f++)this._buffer[f]=0;c.writeUint32BE(r/536870912|0,this._buffer,l-8),c.writeUint32BE(r<<3,this._buffer,l-4),hashBlocks(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,l),this._finished=!0}for(var f=0;f<this.digestLength/8;f++)c.writeUint32BE(this._stateHi[f],i,8*f),c.writeUint32BE(this._stateLo[f],i,8*f+4);return this},SHA512.prototype.digest=function(){var i=new Uint8Array(this.digestLength);return this.finish(i),i},SHA512.prototype.saveState=function(){if(this._finished)throw Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},SHA512.prototype.restoreState=function(i){return this._stateHi.set(i.stateHi),this._stateLo.set(i.stateLo),this._bufferLength=i.bufferLength,i.buffer&&this._buffer.set(i.buffer),this._bytesHashed=i.bytesHashed,this._finished=!1,this},SHA512.prototype.cleanSavedState=function(i){l.wipe(i.stateHi),l.wipe(i.stateLo),i.buffer&&l.wipe(i.buffer),i.bufferLength=0,i.bytesHashed=0},SHA512}();r.SHA512=f;var m=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function hashBlocks(i,r,o,l,f,v,w){for(var E,I,P,R,x,N,C,T,A=o[0],D=o[1],L=o[2],M=o[3],V=o[4],U=o[5],$=o[6],H=o[7],J=l[0],G=l[1],F=l[2],Z=l[3],W=l[4],Q=l[5],Y=l[6],ee=l[7];w>=128;){for(var et=0;et<16;et++){var ei=8*et+v;i[et]=c.readUint32BE(f,ei),r[et]=c.readUint32BE(f,ei+4)}for(var et=0;et<80;et++){var es=A,en=D,eo=L,ea=M,ec=V,el=U,eh=$,eu=H,ed=J,ep=G,eg=F,ef=Z,ey=W,em=Q,e_=Y,ev=ee;if(E=H,x=65535&(I=ee),N=I>>>16,C=65535&E,T=E>>>16,E=(V>>>14|W<<18)^(V>>>18|W<<14)^(W>>>9|V<<23),x+=65535&(I=(W>>>14|V<<18)^(W>>>18|V<<14)^(V>>>9|W<<23)),N+=I>>>16,C+=65535&E,T+=E>>>16,E=V&U^~V&$,x+=65535&(I=W&Q^~W&Y),N+=I>>>16,C+=65535&E,T+=E>>>16,E=m[2*et],x+=65535&(I=m[2*et+1]),N+=I>>>16,C+=65535&E,T+=E>>>16,E=i[et%16],x+=65535&(I=r[et%16]),N+=I>>>16,C+=65535&E,T+=E>>>16,N+=x>>>16,C+=N>>>16,T+=C>>>16,P=65535&C|T<<16,R=65535&x|N<<16,E=P,x=65535&(I=R),N=I>>>16,C=65535&E,T=E>>>16,E=(A>>>28|J<<4)^(J>>>2|A<<30)^(J>>>7|A<<25),x+=65535&(I=(J>>>28|A<<4)^(A>>>2|J<<30)^(A>>>7|J<<25)),N+=I>>>16,C+=65535&E,T+=E>>>16,E=A&D^A&L^D&L,x+=65535&(I=J&G^J&F^G&F),N+=I>>>16,C+=65535&E,T+=E>>>16,N+=x>>>16,C+=N>>>16,T+=C>>>16,eu=65535&C|T<<16,ev=65535&x|N<<16,E=ea,x=65535&(I=ef),N=I>>>16,C=65535&E,T=E>>>16,E=P,x+=65535&(I=R),N+=I>>>16,C+=65535&E,T+=E>>>16,N+=x>>>16,C+=N>>>16,T+=C>>>16,ea=65535&C|T<<16,ef=65535&x|N<<16,D=es,L=en,M=eo,V=ea,U=ec,$=el,H=eh,A=eu,G=ed,F=ep,Z=eg,W=ef,Q=ey,Y=em,ee=e_,J=ev,et%16==15)for(var ei=0;ei<16;ei++)E=i[ei],x=65535&(I=r[ei]),N=I>>>16,C=65535&E,T=E>>>16,E=i[(ei+9)%16],x+=65535&(I=r[(ei+9)%16]),N+=I>>>16,C+=65535&E,T+=E>>>16,E=((P=i[(ei+1)%16])>>>1|(R=r[(ei+1)%16])<<31)^(P>>>8|R<<24)^P>>>7,x+=65535&(I=(R>>>1|P<<31)^(R>>>8|P<<24)^(R>>>7|P<<25)),N+=I>>>16,C+=65535&E,T+=E>>>16,E=((P=i[(ei+14)%16])>>>19|(R=r[(ei+14)%16])<<13)^(R>>>29|P<<3)^P>>>6,x+=65535&(I=(R>>>19|P<<13)^(P>>>29|R<<3)^(R>>>6|P<<26)),N+=I>>>16,C+=65535&E,T+=E>>>16,N+=x>>>16,C+=N>>>16,T+=C>>>16,i[ei]=65535&C|T<<16,r[ei]=65535&x|N<<16}E=A,x=65535&(I=J),N=I>>>16,C=65535&E,T=E>>>16,E=o[0],x+=65535&(I=l[0]),N+=I>>>16,C+=65535&E,T+=E>>>16,N+=x>>>16,C+=N>>>16,T+=C>>>16,o[0]=A=65535&C|T<<16,l[0]=J=65535&x|N<<16,E=D,x=65535&(I=G),N=I>>>16,C=65535&E,T=E>>>16,E=o[1],x+=65535&(I=l[1]),N+=I>>>16,C+=65535&E,T+=E>>>16,N+=x>>>16,C+=N>>>16,T+=C>>>16,o[1]=D=65535&C|T<<16,l[1]=G=65535&x|N<<16,E=L,x=65535&(I=F),N=I>>>16,C=65535&E,T=E>>>16,E=o[2],x+=65535&(I=l[2]),N+=I>>>16,C+=65535&E,T+=E>>>16,N+=x>>>16,C+=N>>>16,T+=C>>>16,o[2]=L=65535&C|T<<16,l[2]=F=65535&x|N<<16,E=M,x=65535&(I=Z),N=I>>>16,C=65535&E,T=E>>>16,E=o[3],x+=65535&(I=l[3]),N+=I>>>16,C+=65535&E,T+=E>>>16,N+=x>>>16,C+=N>>>16,T+=C>>>16,o[3]=M=65535&C|T<<16,l[3]=Z=65535&x|N<<16,E=V,x=65535&(I=W),N=I>>>16,C=65535&E,T=E>>>16,E=o[4],x+=65535&(I=l[4]),N+=I>>>16,C+=65535&E,T+=E>>>16,N+=x>>>16,C+=N>>>16,T+=C>>>16,o[4]=V=65535&C|T<<16,l[4]=W=65535&x|N<<16,E=U,x=65535&(I=Q),N=I>>>16,C=65535&E,T=E>>>16,E=o[5],x+=65535&(I=l[5]),N+=I>>>16,C+=65535&E,T+=E>>>16,N+=x>>>16,C+=N>>>16,T+=C>>>16,o[5]=U=65535&C|T<<16,l[5]=Q=65535&x|N<<16,E=$,x=65535&(I=Y),N=I>>>16,C=65535&E,T=E>>>16,E=o[6],x+=65535&(I=l[6]),N+=I>>>16,C+=65535&E,T+=E>>>16,N+=x>>>16,C+=N>>>16,T+=C>>>16,o[6]=$=65535&C|T<<16,l[6]=Y=65535&x|N<<16,E=H,x=65535&(I=ee),N=I>>>16,C=65535&E,T=E>>>16,E=o[7],x+=65535&(I=l[7]),N+=I>>>16,C+=65535&E,T+=E>>>16,N+=x>>>16,C+=N>>>16,T+=C>>>16,o[7]=H=65535&C|T<<16,l[7]=ee=65535&x|N<<16,v+=128,w-=128}return v}r.hash=function(i){var r=new f;r.update(i);var o=r.digest();return r.clean(),o}},40926:function(i,r,o){"use strict";function getBrowerCrypto(){return(null===o.g||void 0===o.g?void 0:o.g.crypto)||(null===o.g||void 0===o.g?void 0:o.g.msCrypto)||{}}function getSubtleCrypto(){let i=getBrowerCrypto();return i.subtle||i.webkitSubtle}Object.defineProperty(r,"__esModule",{value:!0}),r.isBrowserCryptoAvailable=r.getSubtleCrypto=r.getBrowerCrypto=void 0,r.getBrowerCrypto=getBrowerCrypto,r.getSubtleCrypto=getSubtleCrypto,r.isBrowserCryptoAvailable=function(){return!!getBrowerCrypto()&&!!getSubtleCrypto()}},88618:function(i,r,o){"use strict";var c=o(34155);function isReactNative(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product}function isNode(){return void 0!==c&&void 0!==c.versions&&void 0!==c.versions.node}Object.defineProperty(r,"__esModule",{value:!0}),r.isBrowser=r.isNode=r.isReactNative=void 0,r.isReactNative=isReactNative,r.isNode=isNode,r.isBrowser=function(){return!isReactNative()&&!isNode()}},1468:function(i,r,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0});let c=o(34308);c.__exportStar(o(40926),r),c.__exportStar(o(88618),r)},34308:function(i,r,o){"use strict";o.r(r),o.d(r,{__assign:function(){return __assign},__asyncDelegator:function(){return __asyncDelegator},__asyncGenerator:function(){return __asyncGenerator},__asyncValues:function(){return __asyncValues},__await:function(){return __await},__awaiter:function(){return __awaiter},__classPrivateFieldGet:function(){return __classPrivateFieldGet},__classPrivateFieldSet:function(){return __classPrivateFieldSet},__createBinding:function(){return __createBinding},__decorate:function(){return __decorate},__exportStar:function(){return __exportStar},__extends:function(){return __extends},__generator:function(){return __generator},__importDefault:function(){return __importDefault},__importStar:function(){return __importStar},__makeTemplateObject:function(){return __makeTemplateObject},__metadata:function(){return __metadata},__param:function(){return __param},__read:function(){return __read},__rest:function(){return __rest},__spread:function(){return __spread},__spreadArrays:function(){return __spreadArrays},__values:function(){return __values}});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(i,r){return(extendStatics=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])})(i,r)};function __extends(i,r){function __(){this.constructor=i}extendStatics(i,r),i.prototype=null===r?Object.create(r):(__.prototype=r.prototype,new __)}var __assign=function(){return(__assign=Object.assign||function(i){for(var r,o=1,c=arguments.length;o<c;o++)for(var l in r=arguments[o])Object.prototype.hasOwnProperty.call(r,l)&&(i[l]=r[l]);return i}).apply(this,arguments)};function __rest(i,r){var o={};for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&0>r.indexOf(c)&&(o[c]=i[c]);if(null!=i&&"function"==typeof Object.getOwnPropertySymbols)for(var l=0,c=Object.getOwnPropertySymbols(i);l<c.length;l++)0>r.indexOf(c[l])&&Object.prototype.propertyIsEnumerable.call(i,c[l])&&(o[c[l]]=i[c[l]]);return o}function __decorate(i,r,o,c){var l,f=arguments.length,m=f<3?r:null===c?c=Object.getOwnPropertyDescriptor(r,o):c;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(i,r,o,c);else for(var v=i.length-1;v>=0;v--)(l=i[v])&&(m=(f<3?l(m):f>3?l(r,o,m):l(r,o))||m);return f>3&&m&&Object.defineProperty(r,o,m),m}function __param(i,r){return function(o,c){r(o,c,i)}}function __metadata(i,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(i,r)}function __awaiter(i,r,o,c){return new(o||(o=Promise))(function(l,f){function fulfilled(i){try{step(c.next(i))}catch(i){f(i)}}function rejected(i){try{step(c.throw(i))}catch(i){f(i)}}function step(i){var r;i.done?l(i.value):((r=i.value)instanceof o?r:new o(function(i){i(r)})).then(fulfilled,rejected)}step((c=c.apply(i,r||[])).next())})}function __generator(i,r){var o,c,l,f,m={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return f={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function verb(f){return function(v){return function(f){if(o)throw TypeError("Generator is already executing.");for(;m;)try{if(o=1,c&&(l=2&f[0]?c.return:f[0]?c.throw||((l=c.return)&&l.call(c),0):c.next)&&!(l=l.call(c,f[1])).done)return l;switch(c=0,l&&(f=[2&f[0],l.value]),f[0]){case 0:case 1:l=f;break;case 4:return m.label++,{value:f[1],done:!1};case 5:m.label++,c=f[1],f=[0];continue;case 7:f=m.ops.pop(),m.trys.pop();continue;default:if(!(l=(l=m.trys).length>0&&l[l.length-1])&&(6===f[0]||2===f[0])){m=0;continue}if(3===f[0]&&(!l||f[1]>l[0]&&f[1]<l[3])){m.label=f[1];break}if(6===f[0]&&m.label<l[1]){m.label=l[1],l=f;break}if(l&&m.label<l[2]){m.label=l[2],m.ops.push(f);break}l[2]&&m.ops.pop(),m.trys.pop();continue}f=r.call(i,m)}catch(i){f=[6,i],c=0}finally{o=l=0}if(5&f[0])throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}([f,v])}}}function __createBinding(i,r,o,c){void 0===c&&(c=o),i[c]=r[o]}function __exportStar(i,r){for(var o in i)"default"===o||r.hasOwnProperty(o)||(r[o]=i[o])}function __values(i){var r="function"==typeof Symbol&&Symbol.iterator,o=r&&i[r],c=0;if(o)return o.call(i);if(i&&"number"==typeof i.length)return{next:function(){return i&&c>=i.length&&(i=void 0),{value:i&&i[c++],done:!i}}};throw TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(i,r){var o="function"==typeof Symbol&&i[Symbol.iterator];if(!o)return i;var c,l,f=o.call(i),m=[];try{for(;(void 0===r||r-- >0)&&!(c=f.next()).done;)m.push(c.value)}catch(i){l={error:i}}finally{try{c&&!c.done&&(o=f.return)&&o.call(f)}finally{if(l)throw l.error}}return m}function __spread(){for(var i=[],r=0;r<arguments.length;r++)i=i.concat(__read(arguments[r]));return i}function __spreadArrays(){for(var i=0,r=0,o=arguments.length;r<o;r++)i+=arguments[r].length;for(var c=Array(i),l=0,r=0;r<o;r++)for(var f=arguments[r],m=0,v=f.length;m<v;m++,l++)c[l]=f[m];return c}function __await(i){return this instanceof __await?(this.v=i,this):new __await(i)}function __asyncGenerator(i,r,o){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var c,l=o.apply(i,r||[]),f=[];return c={},verb("next"),verb("throw"),verb("return"),c[Symbol.asyncIterator]=function(){return this},c;function verb(i){l[i]&&(c[i]=function(r){return new Promise(function(o,c){f.push([i,r,o,c])>1||resume(i,r)})})}function resume(i,r){try{var o;(o=l[i](r)).value instanceof __await?Promise.resolve(o.value.v).then(fulfill,reject):settle(f[0][2],o)}catch(i){settle(f[0][3],i)}}function fulfill(i){resume("next",i)}function reject(i){resume("throw",i)}function settle(i,r){i(r),f.shift(),f.length&&resume(f[0][0],f[0][1])}}function __asyncDelegator(i){var r,o;return r={},verb("next"),verb("throw",function(i){throw i}),verb("return"),r[Symbol.iterator]=function(){return this},r;function verb(c,l){r[c]=i[c]?function(r){return(o=!o)?{value:__await(i[c](r)),done:"return"===c}:l?l(r):r}:l}}function __asyncValues(i){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var r,o=i[Symbol.asyncIterator];return o?o.call(i):(i=__values(i),r={},verb("next"),verb("throw"),verb("return"),r[Symbol.asyncIterator]=function(){return this},r);function verb(o){r[o]=i[o]&&function(r){return new Promise(function(c,l){!function(i,r,o,c){Promise.resolve(c).then(function(r){i({value:r,done:o})},r)}(c,l,(r=i[o](r)).done,r.value)})}}}function __makeTemplateObject(i,r){return Object.defineProperty?Object.defineProperty(i,"raw",{value:r}):i.raw=r,i}function __importStar(i){if(i&&i.__esModule)return i;var r={};if(null!=i)for(var o in i)Object.hasOwnProperty.call(i,o)&&(r[o]=i[o]);return r.default=i,r}function __importDefault(i){return i&&i.__esModule?i:{default:i}}function __classPrivateFieldGet(i,r){if(!r.has(i))throw TypeError("attempted to get private field on non-instance");return r.get(i)}function __classPrivateFieldSet(i,r,o){if(!r.has(i))throw TypeError("attempted to set private field on non-instance");return r.set(i,o),o}},38200:function(i,r,o){"use strict";o.d(r,{q:function(){return IEvents}});let IEvents=class IEvents{}},30997:function(i,r,o){"use strict";o.r(r),o.d(r,{IEvents:function(){return c.q}});var c=o(38200)},32568:function(i,r,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.HEARTBEAT_EVENTS=r.HEARTBEAT_INTERVAL=void 0;let c=o(66736);r.HEARTBEAT_INTERVAL=c.FIVE_SECONDS,r.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"}},53401:function(i,r,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0});let c=o(39653);c.__exportStar(o(32568),r)},38969:function(i,r,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.HeartBeat=void 0;let c=o(39653),l=o(17187),f=o(66736),m=o(1614),v=o(53401);let HeartBeat=class HeartBeat extends m.IHeartBeat{constructor(i){super(i),this.events=new l.EventEmitter,this.interval=v.HEARTBEAT_INTERVAL,this.interval=(null==i?void 0:i.interval)||v.HEARTBEAT_INTERVAL}static init(i){return c.__awaiter(this,void 0,void 0,function*(){let r=new HeartBeat(i);return yield r.init(),r})}init(){return c.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}initialize(){return c.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),f.toMiliseconds(this.interval))})}pulse(){this.events.emit(v.HEARTBEAT_EVENTS.pulse)}};r.HeartBeat=HeartBeat},90772:function(i,r,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0});let c=o(39653);c.__exportStar(o(38969),r),c.__exportStar(o(1614),r),c.__exportStar(o(53401),r)},44174:function(i,r,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.IHeartBeat=void 0;let c=o(30997);let IHeartBeat=class IHeartBeat extends c.IEvents{constructor(i){super()}};r.IHeartBeat=IHeartBeat},1614:function(i,r,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0});let c=o(39653);c.__exportStar(o(44174),r)},39653:function(i,r,o){"use strict";o.r(r),o.d(r,{__assign:function(){return __assign},__asyncDelegator:function(){return __asyncDelegator},__asyncGenerator:function(){return __asyncGenerator},__asyncValues:function(){return __asyncValues},__await:function(){return __await},__awaiter:function(){return __awaiter},__classPrivateFieldGet:function(){return __classPrivateFieldGet},__classPrivateFieldSet:function(){return __classPrivateFieldSet},__createBinding:function(){return __createBinding},__decorate:function(){return __decorate},__exportStar:function(){return __exportStar},__extends:function(){return __extends},__generator:function(){return __generator},__importDefault:function(){return __importDefault},__importStar:function(){return __importStar},__makeTemplateObject:function(){return __makeTemplateObject},__metadata:function(){return __metadata},__param:function(){return __param},__read:function(){return __read},__rest:function(){return __rest},__spread:function(){return __spread},__spreadArrays:function(){return __spreadArrays},__values:function(){return __values}});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(i,r){return(extendStatics=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])})(i,r)};function __extends(i,r){function __(){this.constructor=i}extendStatics(i,r),i.prototype=null===r?Object.create(r):(__.prototype=r.prototype,new __)}var __assign=function(){return(__assign=Object.assign||function(i){for(var r,o=1,c=arguments.length;o<c;o++)for(var l in r=arguments[o])Object.prototype.hasOwnProperty.call(r,l)&&(i[l]=r[l]);return i}).apply(this,arguments)};function __rest(i,r){var o={};for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&0>r.indexOf(c)&&(o[c]=i[c]);if(null!=i&&"function"==typeof Object.getOwnPropertySymbols)for(var l=0,c=Object.getOwnPropertySymbols(i);l<c.length;l++)0>r.indexOf(c[l])&&Object.prototype.propertyIsEnumerable.call(i,c[l])&&(o[c[l]]=i[c[l]]);return o}function __decorate(i,r,o,c){var l,f=arguments.length,m=f<3?r:null===c?c=Object.getOwnPropertyDescriptor(r,o):c;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(i,r,o,c);else for(var v=i.length-1;v>=0;v--)(l=i[v])&&(m=(f<3?l(m):f>3?l(r,o,m):l(r,o))||m);return f>3&&m&&Object.defineProperty(r,o,m),m}function __param(i,r){return function(o,c){r(o,c,i)}}function __metadata(i,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(i,r)}function __awaiter(i,r,o,c){return new(o||(o=Promise))(function(l,f){function fulfilled(i){try{step(c.next(i))}catch(i){f(i)}}function rejected(i){try{step(c.throw(i))}catch(i){f(i)}}function step(i){var r;i.done?l(i.value):((r=i.value)instanceof o?r:new o(function(i){i(r)})).then(fulfilled,rejected)}step((c=c.apply(i,r||[])).next())})}function __generator(i,r){var o,c,l,f,m={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return f={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function verb(f){return function(v){return function(f){if(o)throw TypeError("Generator is already executing.");for(;m;)try{if(o=1,c&&(l=2&f[0]?c.return:f[0]?c.throw||((l=c.return)&&l.call(c),0):c.next)&&!(l=l.call(c,f[1])).done)return l;switch(c=0,l&&(f=[2&f[0],l.value]),f[0]){case 0:case 1:l=f;break;case 4:return m.label++,{value:f[1],done:!1};case 5:m.label++,c=f[1],f=[0];continue;case 7:f=m.ops.pop(),m.trys.pop();continue;default:if(!(l=(l=m.trys).length>0&&l[l.length-1])&&(6===f[0]||2===f[0])){m=0;continue}if(3===f[0]&&(!l||f[1]>l[0]&&f[1]<l[3])){m.label=f[1];break}if(6===f[0]&&m.label<l[1]){m.label=l[1],l=f;break}if(l&&m.label<l[2]){m.label=l[2],m.ops.push(f);break}l[2]&&m.ops.pop(),m.trys.pop();continue}f=r.call(i,m)}catch(i){f=[6,i],c=0}finally{o=l=0}if(5&f[0])throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}([f,v])}}}function __createBinding(i,r,o,c){void 0===c&&(c=o),i[c]=r[o]}function __exportStar(i,r){for(var o in i)"default"===o||r.hasOwnProperty(o)||(r[o]=i[o])}function __values(i){var r="function"==typeof Symbol&&Symbol.iterator,o=r&&i[r],c=0;if(o)return o.call(i);if(i&&"number"==typeof i.length)return{next:function(){return i&&c>=i.length&&(i=void 0),{value:i&&i[c++],done:!i}}};throw TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(i,r){var o="function"==typeof Symbol&&i[Symbol.iterator];if(!o)return i;var c,l,f=o.call(i),m=[];try{for(;(void 0===r||r-- >0)&&!(c=f.next()).done;)m.push(c.value)}catch(i){l={error:i}}finally{try{c&&!c.done&&(o=f.return)&&o.call(f)}finally{if(l)throw l.error}}return m}function __spread(){for(var i=[],r=0;r<arguments.length;r++)i=i.concat(__read(arguments[r]));return i}function __spreadArrays(){for(var i=0,r=0,o=arguments.length;r<o;r++)i+=arguments[r].length;for(var c=Array(i),l=0,r=0;r<o;r++)for(var f=arguments[r],m=0,v=f.length;m<v;m++,l++)c[l]=f[m];return c}function __await(i){return this instanceof __await?(this.v=i,this):new __await(i)}function __asyncGenerator(i,r,o){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var c,l=o.apply(i,r||[]),f=[];return c={},verb("next"),verb("throw"),verb("return"),c[Symbol.asyncIterator]=function(){return this},c;function verb(i){l[i]&&(c[i]=function(r){return new Promise(function(o,c){f.push([i,r,o,c])>1||resume(i,r)})})}function resume(i,r){try{var o;(o=l[i](r)).value instanceof __await?Promise.resolve(o.value.v).then(fulfill,reject):settle(f[0][2],o)}catch(i){settle(f[0][3],i)}}function fulfill(i){resume("next",i)}function reject(i){resume("throw",i)}function settle(i,r){i(r),f.shift(),f.length&&resume(f[0][0],f[0][1])}}function __asyncDelegator(i){var r,o;return r={},verb("next"),verb("throw",function(i){throw i}),verb("return"),r[Symbol.iterator]=function(){return this},r;function verb(c,l){r[c]=i[c]?function(r){return(o=!o)?{value:__await(i[c](r)),done:"return"===c}:l?l(r):r}:l}}function __asyncValues(i){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var r,o=i[Symbol.asyncIterator];return o?o.call(i):(i=__values(i),r={},verb("next"),verb("throw"),verb("return"),r[Symbol.asyncIterator]=function(){return this},r);function verb(o){r[o]=i[o]&&function(r){return new Promise(function(c,l){!function(i,r,o,c){Promise.resolve(c).then(function(r){i({value:r,done:o})},r)}(c,l,(r=i[o](r)).done,r.value)})}}}function __makeTemplateObject(i,r){return Object.defineProperty?Object.defineProperty(i,"raw",{value:r}):i.raw=r,i}function __importStar(i){if(i&&i.__esModule)return i;var r={};if(null!=i)for(var o in i)Object.hasOwnProperty.call(i,o)&&(r[o]=i[o]);return r.default=i,r}function __importDefault(i){return i&&i.__esModule?i:{default:i}}function __classPrivateFieldGet(i,r){if(!r.has(i))throw TypeError("attempted to get private field on non-instance");return r.get(i)}function __classPrivateFieldSet(i,r,o){if(!r.has(i))throw TypeError("attempted to set private field on non-instance");return r.set(i,o),o}},72030:function(i){"use strict";i.exports=function(){throw Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},65727:function(i,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PINO_CUSTOM_CONTEXT_KEY=r.PINO_LOGGER_DEFAULTS=void 0,r.PINO_LOGGER_DEFAULTS={level:"info"},r.PINO_CUSTOM_CONTEXT_KEY="custom_context"},9107:function(i,r,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.pino=void 0;let c=o(57121),l=c.__importDefault(o(36559));Object.defineProperty(r,"pino",{enumerable:!0,get:function(){return l.default}}),c.__exportStar(o(65727),r),c.__exportStar(o(58048),r)},58048:function(i,r,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.generateChildLogger=r.formatChildLoggerContext=r.getLoggerContext=r.setBrowserLoggerContext=r.getBrowserLoggerContext=r.getDefaultLoggerOptions=void 0;let c=o(65727);function getBrowserLoggerContext(i,r=c.PINO_CUSTOM_CONTEXT_KEY){return i[r]||""}function setBrowserLoggerContext(i,r,o=c.PINO_CUSTOM_CONTEXT_KEY){return i[o]=r,i}function getLoggerContext(i,r=c.PINO_CUSTOM_CONTEXT_KEY){return void 0===i.bindings?getBrowserLoggerContext(i,r):i.bindings().context||""}function formatChildLoggerContext(i,r,o=c.PINO_CUSTOM_CONTEXT_KEY){let l=getLoggerContext(i,o),f=l.trim()?`${l}/${r}`:r;return f}r.getDefaultLoggerOptions=function(i){return Object.assign(Object.assign({},i),{level:(null==i?void 0:i.level)||c.PINO_LOGGER_DEFAULTS.level})},r.getBrowserLoggerContext=getBrowserLoggerContext,r.setBrowserLoggerContext=setBrowserLoggerContext,r.getLoggerContext=getLoggerContext,r.formatChildLoggerContext=formatChildLoggerContext,r.generateChildLogger=function(i,r,o=c.PINO_CUSTOM_CONTEXT_KEY){let l=formatChildLoggerContext(i,r,o),f=i.child({context:l});return setBrowserLoggerContext(f,l,o)}},57121:function(i,r,o){"use strict";o.r(r),o.d(r,{__assign:function(){return __assign},__asyncDelegator:function(){return __asyncDelegator},__asyncGenerator:function(){return __asyncGenerator},__asyncValues:function(){return __asyncValues},__await:function(){return __await},__awaiter:function(){return __awaiter},__classPrivateFieldGet:function(){return __classPrivateFieldGet},__classPrivateFieldSet:function(){return __classPrivateFieldSet},__createBinding:function(){return __createBinding},__decorate:function(){return __decorate},__exportStar:function(){return __exportStar},__extends:function(){return __extends},__generator:function(){return __generator},__importDefault:function(){return __importDefault},__importStar:function(){return __importStar},__makeTemplateObject:function(){return __makeTemplateObject},__metadata:function(){return __metadata},__param:function(){return __param},__read:function(){return __read},__rest:function(){return __rest},__spread:function(){return __spread},__spreadArrays:function(){return __spreadArrays},__values:function(){return __values}});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(i,r){return(extendStatics=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])})(i,r)};function __extends(i,r){function __(){this.constructor=i}extendStatics(i,r),i.prototype=null===r?Object.create(r):(__.prototype=r.prototype,new __)}var __assign=function(){return(__assign=Object.assign||function(i){for(var r,o=1,c=arguments.length;o<c;o++)for(var l in r=arguments[o])Object.prototype.hasOwnProperty.call(r,l)&&(i[l]=r[l]);return i}).apply(this,arguments)};function __rest(i,r){var o={};for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&0>r.indexOf(c)&&(o[c]=i[c]);if(null!=i&&"function"==typeof Object.getOwnPropertySymbols)for(var l=0,c=Object.getOwnPropertySymbols(i);l<c.length;l++)0>r.indexOf(c[l])&&Object.prototype.propertyIsEnumerable.call(i,c[l])&&(o[c[l]]=i[c[l]]);return o}function __decorate(i,r,o,c){var l,f=arguments.length,m=f<3?r:null===c?c=Object.getOwnPropertyDescriptor(r,o):c;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(i,r,o,c);else for(var v=i.length-1;v>=0;v--)(l=i[v])&&(m=(f<3?l(m):f>3?l(r,o,m):l(r,o))||m);return f>3&&m&&Object.defineProperty(r,o,m),m}function __param(i,r){return function(o,c){r(o,c,i)}}function __metadata(i,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(i,r)}function __awaiter(i,r,o,c){return new(o||(o=Promise))(function(l,f){function fulfilled(i){try{step(c.next(i))}catch(i){f(i)}}function rejected(i){try{step(c.throw(i))}catch(i){f(i)}}function step(i){var r;i.done?l(i.value):((r=i.value)instanceof o?r:new o(function(i){i(r)})).then(fulfilled,rejected)}step((c=c.apply(i,r||[])).next())})}function __generator(i,r){var o,c,l,f,m={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return f={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function verb(f){return function(v){return function(f){if(o)throw TypeError("Generator is already executing.");for(;m;)try{if(o=1,c&&(l=2&f[0]?c.return:f[0]?c.throw||((l=c.return)&&l.call(c),0):c.next)&&!(l=l.call(c,f[1])).done)return l;switch(c=0,l&&(f=[2&f[0],l.value]),f[0]){case 0:case 1:l=f;break;case 4:return m.label++,{value:f[1],done:!1};case 5:m.label++,c=f[1],f=[0];continue;case 7:f=m.ops.pop(),m.trys.pop();continue;default:if(!(l=(l=m.trys).length>0&&l[l.length-1])&&(6===f[0]||2===f[0])){m=0;continue}if(3===f[0]&&(!l||f[1]>l[0]&&f[1]<l[3])){m.label=f[1];break}if(6===f[0]&&m.label<l[1]){m.label=l[1],l=f;break}if(l&&m.label<l[2]){m.label=l[2],m.ops.push(f);break}l[2]&&m.ops.pop(),m.trys.pop();continue}f=r.call(i,m)}catch(i){f=[6,i],c=0}finally{o=l=0}if(5&f[0])throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}([f,v])}}}function __createBinding(i,r,o,c){void 0===c&&(c=o),i[c]=r[o]}function __exportStar(i,r){for(var o in i)"default"===o||r.hasOwnProperty(o)||(r[o]=i[o])}function __values(i){var r="function"==typeof Symbol&&Symbol.iterator,o=r&&i[r],c=0;if(o)return o.call(i);if(i&&"number"==typeof i.length)return{next:function(){return i&&c>=i.length&&(i=void 0),{value:i&&i[c++],done:!i}}};throw TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(i,r){var o="function"==typeof Symbol&&i[Symbol.iterator];if(!o)return i;var c,l,f=o.call(i),m=[];try{for(;(void 0===r||r-- >0)&&!(c=f.next()).done;)m.push(c.value)}catch(i){l={error:i}}finally{try{c&&!c.done&&(o=f.return)&&o.call(f)}finally{if(l)throw l.error}}return m}function __spread(){for(var i=[],r=0;r<arguments.length;r++)i=i.concat(__read(arguments[r]));return i}function __spreadArrays(){for(var i=0,r=0,o=arguments.length;r<o;r++)i+=arguments[r].length;for(var c=Array(i),l=0,r=0;r<o;r++)for(var f=arguments[r],m=0,v=f.length;m<v;m++,l++)c[l]=f[m];return c}function __await(i){return this instanceof __await?(this.v=i,this):new __await(i)}function __asyncGenerator(i,r,o){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var c,l=o.apply(i,r||[]),f=[];return c={},verb("next"),verb("throw"),verb("return"),c[Symbol.asyncIterator]=function(){return this},c;function verb(i){l[i]&&(c[i]=function(r){return new Promise(function(o,c){f.push([i,r,o,c])>1||resume(i,r)})})}function resume(i,r){try{var o;(o=l[i](r)).value instanceof __await?Promise.resolve(o.value.v).then(fulfill,reject):settle(f[0][2],o)}catch(i){settle(f[0][3],i)}}function fulfill(i){resume("next",i)}function reject(i){resume("throw",i)}function settle(i,r){i(r),f.shift(),f.length&&resume(f[0][0],f[0][1])}}function __asyncDelegator(i){var r,o;return r={},verb("next"),verb("throw",function(i){throw i}),verb("return"),r[Symbol.iterator]=function(){return this},r;function verb(c,l){r[c]=i[c]?function(r){return(o=!o)?{value:__await(i[c](r)),done:"return"===c}:l?l(r):r}:l}}function __asyncValues(i){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var r,o=i[Symbol.asyncIterator];return o?o.call(i):(i=__values(i),r={},verb("next"),verb("throw"),verb("return"),r[Symbol.asyncIterator]=function(){return this},r);function verb(o){r[o]=i[o]&&function(r){return new Promise(function(c,l){!function(i,r,o,c){Promise.resolve(c).then(function(r){i({value:r,done:o})},r)}(c,l,(r=i[o](r)).done,r.value)})}}}function __makeTemplateObject(i,r){return Object.defineProperty?Object.defineProperty(i,"raw",{value:r}):i.raw=r,i}function __importStar(i){if(i&&i.__esModule)return i;var r={};if(null!=i)for(var o in i)Object.hasOwnProperty.call(i,o)&&(r[o]=i[o]);return r.default=i,r}function __importDefault(i){return i&&i.__esModule?i:{default:i}}function __classPrivateFieldGet(i,r){if(!r.has(i))throw TypeError("attempted to get private field on non-instance");return r.get(i)}function __classPrivateFieldSet(i,r,o){if(!r.has(i))throw TypeError("attempted to set private field on non-instance");return r.set(i,o),o}},43014:function(){},35796:function(i,r,o){"use strict";o.d(r,{d:function(){return BaseEvmAdapter}});var c=o(85783);let BaseEvmAdapter=class BaseEvmAdapter extends c.J5{async init(i){this.chainConfig||(this.chainConfig=(0,c.h2)(c.EN.EIP155,1))}async authenticateUser(){if(!this.provider||this.status!==c.MP.CONNECTED)throw c.RM.notConnectedError();let{chainNamespace:i,chainId:r}=this.chainConfig,o=await this.provider.request({method:"eth_accounts"});if(o&&o.length>0){let l=(0,c.Cb)(o[0],this.name);if(l){let i=(0,c.$E)(l);if(!i)return{idToken:l}}let f={domain:window.location.origin,uri:window.location.href,address:o[0],chainId:parseInt(r,16),version:"1",nonce:Math.random().toString(36).slice(2),issuedAt:new Date().toISOString()},m=await (0,c.tV)(f,i),v=await this.provider.request({method:"personal_sign",params:[m,o[0]]}),w=await (0,c.rn)(i,v,m,this.name,this.sessionTime,this.clientId,this.web3AuthNetwork);return(0,c.Fr)(o[0],this.name,w),{idToken:w}}throw c.RM.notConnectedError("Not connected with wallet, Please login/connect first")}async disconnectSession(){super.checkDisconnectionRequirements();let i=await this.provider.request({method:"eth_accounts"});i&&i.length>0&&(0,c.qz)(i[0],this.name)}async disconnect(){this.rehydrated=!1,this.emit(c.n2.DISCONNECTED)}}},68551:function(i,r,o){"use strict";let c;o.d(r,{WalletConnectV2Adapter:function(){return WalletConnectV2Adapter}});var l,f,m=o(85783),v=o(1413),w=o(81180),E=o(17187),I=o.n(E);let P=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,R=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,x=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function jsonParseTransform(i,r){if("__proto__"===i||"constructor"===i&&r&&"object"==typeof r&&"prototype"in r){console.warn(`[destr] Dropping "${i}" key to prevent prototype pollution.`);return}return r}function destr(i,r={}){if("string"!=typeof i)return i;let o=i.trim();if('"'===i[0]&&'"'===i.at(-1)&&!i.includes("\\"))return o.slice(1,-1);if(o.length<=9){let i=o.toLowerCase();if("true"===i)return!0;if("false"===i)return!1;if("undefined"===i)return;if("null"===i)return null;if("nan"===i)return Number.NaN;if("infinity"===i)return Number.POSITIVE_INFINITY;if("-infinity"===i)return Number.NEGATIVE_INFINITY}if(!x.test(i)){if(r.strict)throw SyntaxError("[destr] Invalid JSON");return i}try{if(P.test(i)||R.test(i)){if(r.strict)throw Error("[destr] Possible prototype pollution");return JSON.parse(i,jsonParseTransform)}return JSON.parse(i)}catch(o){if(r.strict)throw o;return i}}var N=o(48764).Buffer;function asyncCall(i,...r){try{var o;return(o=i(...r))&&"function"==typeof o.then?o:Promise.resolve(o)}catch(i){return Promise.reject(i)}}function stringify(i){if(function(i){let r=typeof i;return null===i||"object"!==r&&"function"!==r}(i))return String(i);if(function(i){let r=Object.getPrototypeOf(i);return!r||r.isPrototypeOf(Object)}(i)||Array.isArray(i))return JSON.stringify(i);if("function"==typeof i.toJSON)return stringify(i.toJSON());throw Error("[unstorage] Cannot stringify value!")}let C="base64:";function normalizeKey(i){return i?i.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function unstorage_8581f561_normalizeBaseKey(i){return(i=normalizeKey(i))?i+":":""}let memory=()=>{let i=new Map;return{name:"memory",options:{},hasItem:r=>i.has(r),getItem:r=>i.get(r)??null,getItemRaw:r=>i.get(r)??null,setItem(r,o){i.set(r,o)},setItemRaw(r,o){i.set(r,o)},removeItem(r){i.delete(r)},getKeys:()=>Array.from(i.keys()),clear(){i.clear()},dispose(){i.clear()}}};function watch(i,r,o){return i.watch?i.watch((i,c)=>r(i,o+c)):()=>{}}async function dispose(i){"function"==typeof i.dispose&&await asyncCall(i.dispose)}function promisifyRequest(i){return new Promise((r,o)=>{i.oncomplete=i.onsuccess=()=>r(i.result),i.onabort=i.onerror=()=>o(i.error)})}function createStore(i,r){let o=indexedDB.open(i);o.onupgradeneeded=()=>o.result.createObjectStore(r);let c=promisifyRequest(o);return(i,o)=>c.then(c=>o(c.transaction(r,i).objectStore(r)))}function defaultGetStore(){return c||(c=createStore("keyval-store","keyval")),c}function get(i,r=defaultGetStore()){return r("readonly",r=>promisifyRequest(r.get(i)))}let JSONStringify=i=>JSON.stringify(i,(i,r)=>"bigint"==typeof r?r.toString()+"n":r),JSONParse=i=>{let r=i.replace(/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,'$1"$2n"$3');return JSON.parse(r,(i,r)=>{let o="string"==typeof r&&r.match(/^\d+n$/);return o?BigInt(r.substring(0,r.length-1)):r})};function esm_safeJsonParse(i){if("string"!=typeof i)throw Error(`Cannot safe json parse value of type ${typeof i}`);try{return JSONParse(i)}catch(r){return i}}function safeJsonStringify(i){return"string"==typeof i?i:JSONStringify(i)||""}var z=(i={})=>{let r;let o=i.base&&i.base.length>0?`${i.base}:`:"",e=i=>o+i;return i.dbName&&i.storeName&&(r=createStore(i.dbName,i.storeName)),{name:"idb-keyval",options:i,hasItem:async i=>!(typeof await get(e(i),r)>"u"),getItem:async i=>await get(e(i),r)??null,setItem:(i,o)=>(function(i,r,o=defaultGetStore()){return o("readwrite",o=>(o.put(r,i),promisifyRequest(o.transaction)))})(e(i),o,r),removeItem:i=>(function(i,r=defaultGetStore()){return r("readwrite",r=>(r.delete(i),promisifyRequest(r.transaction)))})(e(i),r),getKeys:()=>(function(i=defaultGetStore()){return i("readonly",i=>{var r;if(i.getAllKeys)return promisifyRequest(i.getAllKeys());let o=[];return(r=i=>o.push(i.key),i.openCursor().onsuccess=function(){this.result&&(r(this.result),this.result.continue())},promisifyRequest(i.transaction)).then(()=>o)})})(r),clear:()=>(function(i=defaultGetStore()){return i("readwrite",i=>(i.clear(),promisifyRequest(i.transaction)))})(r)}};let _=class _{constructor(){this.indexedDb=function(i={}){let r={mounts:{"":i.driver||memory()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},getMount=i=>{for(let o of r.mountpoints)if(i.startsWith(o))return{base:o,relativeKey:i.slice(o.length),driver:r.mounts[o]};return{base:"",relativeKey:i,driver:r.mounts[""]}},getMounts=(i,o)=>r.mountpoints.filter(r=>r.startsWith(i)||o&&i.startsWith(r)).map(o=>({relativeBase:i.length>o.length?i.slice(o.length):void 0,mountpoint:o,driver:r.mounts[o]})),onChange=(i,o)=>{if(r.watching)for(let c of(o=normalizeKey(o),r.watchListeners))c(i,o)},startWatch=async()=>{if(!r.watching)for(let i in r.watching=!0,r.mounts)r.unwatch[i]=await watch(r.mounts[i],onChange,i)},stopWatch=async()=>{if(r.watching){for(let i in r.unwatch)await r.unwatch[i]();r.unwatch={},r.watching=!1}},runBatch=(i,r,o)=>{let c=new Map,getBatch=i=>{let r=c.get(i.base);return r||(r={driver:i.driver,base:i.base,items:[]},c.set(i.base,r)),r};for(let o of i){let i="string"==typeof o,c=normalizeKey(i?o:o.key),l=i?void 0:o.value,f=i||!o.options?r:{...r,...o.options},m=getMount(c);getBatch(m).items.push({key:c,value:l,relativeKey:m.relativeKey,options:f})}return Promise.all([...c.values()].map(i=>o(i))).then(i=>i.flat())},o={hasItem(i,r={}){i=normalizeKey(i);let{relativeKey:o,driver:c}=getMount(i);return asyncCall(c.hasItem,o,r)},getItem(i,r={}){i=normalizeKey(i);let{relativeKey:o,driver:c}=getMount(i);return asyncCall(c.getItem,o,r).then(i=>destr(i))},getItems:(i,r)=>runBatch(i,r,i=>i.driver.getItems?asyncCall(i.driver.getItems,i.items.map(i=>({key:i.relativeKey,options:i.options})),r).then(r=>r.map(r=>({key:function(...i){return normalizeKey(i.join(":"))}(i.base,r.key),value:destr(r.value)}))):Promise.all(i.items.map(r=>asyncCall(i.driver.getItem,r.relativeKey,r.options).then(i=>({key:r.key,value:destr(i)}))))),getItemRaw(i,r={}){i=normalizeKey(i);let{relativeKey:o,driver:c}=getMount(i);return c.getItemRaw?asyncCall(c.getItemRaw,o,r):asyncCall(c.getItem,o,r).then(i=>"string"==typeof i&&i.startsWith(C)?N.from(i.slice(C.length),"base64"):i)},async setItem(i,r,c={}){if(void 0===r)return o.removeItem(i);i=normalizeKey(i);let{relativeKey:l,driver:f}=getMount(i);f.setItem&&(await asyncCall(f.setItem,l,stringify(r),c),f.watch||onChange("update",i))},async setItems(i,r){await runBatch(i,r,async i=>{i.driver.setItems&&await asyncCall(i.driver.setItems,i.items.map(i=>({key:i.relativeKey,value:stringify(i.value),options:i.options})),r),i.driver.setItem&&await Promise.all(i.items.map(r=>asyncCall(i.driver.setItem,r.relativeKey,stringify(r.value),r.options)))})},async setItemRaw(i,r,c={}){if(void 0===r)return o.removeItem(i,c);i=normalizeKey(i);let{relativeKey:l,driver:f}=getMount(i);if(f.setItemRaw)await asyncCall(f.setItemRaw,l,r,c);else{if(!f.setItem)return;await asyncCall(f.setItem,l,function(i){if("string"==typeof i)return i;let r=N.from(i).toString("base64");return C+r}(r),c)}f.watch||onChange("update",i)},async removeItem(i,r={}){"boolean"==typeof r&&(r={removeMeta:r}),i=normalizeKey(i);let{relativeKey:o,driver:c}=getMount(i);c.removeItem&&(await asyncCall(c.removeItem,o,r),(r.removeMeta||r.removeMata)&&await asyncCall(c.removeItem,o+"$",r),c.watch||onChange("remove",i))},async getMeta(i,r={}){"boolean"==typeof r&&(r={nativeOnly:r}),i=normalizeKey(i);let{relativeKey:o,driver:c}=getMount(i),l=Object.create(null);if(c.getMeta&&Object.assign(l,await asyncCall(c.getMeta,o,r)),!r.nativeOnly){let i=await asyncCall(c.getItem,o+"$",r).then(i=>destr(i));i&&"object"==typeof i&&("string"==typeof i.atime&&(i.atime=new Date(i.atime)),"string"==typeof i.mtime&&(i.mtime=new Date(i.mtime)),Object.assign(l,i))}return l},setMeta(i,r,o={}){return this.setItem(i+"$",r,o)},removeMeta(i,r={}){return this.removeItem(i+"$",r)},async getKeys(i,r={}){i=unstorage_8581f561_normalizeBaseKey(i);let o=getMounts(i,!0),c=[],l=[];for(let i of o){let o=await asyncCall(i.driver.getKeys,i.relativeBase,r),f=o.map(r=>i.mountpoint+normalizeKey(r)).filter(i=>!c.some(r=>i.startsWith(r)));l.push(...f),c=[i.mountpoint,...c.filter(r=>!r.startsWith(i.mountpoint))]}return i?l.filter(r=>r.startsWith(i)&&!r.endsWith("$")):l.filter(i=>!i.endsWith("$"))},async clear(i,r={}){i=unstorage_8581f561_normalizeBaseKey(i),await Promise.all(getMounts(i,!1).map(async i=>{if(i.driver.clear)return asyncCall(i.driver.clear,i.relativeBase,r);if(i.driver.removeItem){let o=await i.driver.getKeys(i.relativeBase||"",r);return Promise.all(o.map(o=>i.driver.removeItem(o,r)))}}))},async dispose(){await Promise.all(Object.values(r.mounts).map(i=>dispose(i)))},watch:async i=>(await startWatch(),r.watchListeners.push(i),async()=>{r.watchListeners=r.watchListeners.filter(r=>r!==i),0===r.watchListeners.length&&await stopWatch()}),async unwatch(){r.watchListeners=[],await stopWatch()},mount(i,c){if((i=unstorage_8581f561_normalizeBaseKey(i))&&r.mounts[i])throw Error(`already mounted at ${i}`);return i&&(r.mountpoints.push(i),r.mountpoints.sort((i,r)=>r.length-i.length)),r.mounts[i]=c,r.watching&&Promise.resolve(watch(c,onChange,i)).then(o=>{r.unwatch[i]=o}).catch(console.error),o},async unmount(i,o=!0){(i=unstorage_8581f561_normalizeBaseKey(i))&&r.mounts[i]&&(r.watching&&i in r.unwatch&&(r.unwatch[i](),delete r.unwatch[i]),o&&await dispose(r.mounts[i]),r.mountpoints=r.mountpoints.filter(r=>r!==i),delete r.mounts[i])},getMount(i=""){i=normalizeKey(i)+":";let r=getMount(i);return{driver:r.driver,base:r.base}},getMounts(i="",r={}){i=normalizeKey(i);let o=getMounts(i,r.parents);return o.map(i=>({driver:i.driver,base:i.mountpoint}))}};return o}({driver:z({dbName:"WALLET_CONNECT_V2_INDEXED_DB",storeName:"keyvaluestorage"})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(i=>[i.key,i.value])}async getItem(i){let r=await this.indexedDb.getItem(i);if(null!==r)return r}async setItem(i,r){await this.indexedDb.setItem(i,safeJsonStringify(r))}async removeItem(i){await this.indexedDb.removeItem(i)}};var T="u">typeof globalThis?globalThis:"u">typeof window?window:"u">typeof o.g?o.g:"u">typeof self?self:{},A={exports:{}};function k(i){var r;return[i[0],esm_safeJsonParse(null!=(r=i[1])?r:"")]}!function(){function t(){}t.prototype.getItem=function(i){return this.hasOwnProperty(i)?String(this[i]):null},t.prototype.setItem=function(i,r){this[i]=String(r)},t.prototype.removeItem=function(i){delete this[i]},t.prototype.clear=function(){let i=this;Object.keys(i).forEach(function(r){i[r]=void 0,delete i[r]})},t.prototype.key=function(i){return i=i||0,Object.keys(this)[i]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),"u">typeof T&&T.localStorage?A.exports=T.localStorage:"u">typeof window&&window.localStorage?A.exports=window.localStorage:A.exports=new t}();let K=class K{constructor(){this.localStorage=A.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(k)}async getItem(i){let r=this.localStorage.getItem(i);if(null!==r)return esm_safeJsonParse(r)}async setItem(i,r){this.localStorage.setItem(i,safeJsonStringify(r))}async removeItem(i){this.localStorage.removeItem(i)}};let O=async(i,r,o)=>{let c="wc_storage_version",l=await r.getItem(c);if(l&&l>=1){o(r);return}let f=await i.getKeys();if(!f.length){o(r);return}let m=[];for(;f.length;){let o=f.shift();if(!o)continue;let c=o.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){let c=await i.getItem(o);await r.setItem(o,c),m.push(o)}}await r.setItem(c,1),o(r),j(i,m)},j=async(i,r)=>{r.length&&r.forEach(async r=>{await i.removeItem(r)})};let h=class h{constructor(){this.initialized=!1,this.setInitialized=i=>{this.storage=i,this.initialized=!0};let i=new K;this.storage=i;try{let r=new _;O(i,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(i){return await this.initialize(),this.storage.getItem(i)}async setItem(i,r){return await this.initialize(),this.storage.setItem(i,r)}async removeItem(i){return await this.initialize(),this.storage.removeItem(i)}async initialize(){this.initialized||await new Promise(i=>{let r=setInterval(()=>{this.initialized&&(clearInterval(r),i())},20)})}};var D=o(90772),L=o(9107),M=o(38200);let n=class n extends M.q{constructor(i){super(),this.opts=i,this.protocol="wc",this.version=2}};let index_es_h=class index_es_h extends M.q{constructor(i,r){super(),this.core=i,this.logger=r,this.records=new Map}};let a=class a{constructor(i,r){this.logger=i,this.core=r}};let u=class u extends M.q{constructor(i,r){super(),this.relayer=i,this.logger=r}};let g=class g extends M.q{constructor(i){super()}};let p=class p{constructor(i,r,o,c){this.core=i,this.logger=r,this.name=o}};let d=class d extends M.q{constructor(i,r){super(),this.relayer=i,this.logger=r}};let index_es_E=class index_es_E extends M.q{constructor(i,r){super(),this.core=i,this.logger=r}};let index_es_y=class index_es_y{constructor(i,r){this.projectId=i,this.logger=r}};let b=class b{constructor(i){this.opts=i,this.protocol="wc",this.version=2}};let S=class S{constructor(i){this.client=i}};var V=o(31050),U=o(31416),$=o(66736);let H="base64url",J="base58btc";var G=o(20605),F=o(92263),Z=o(52217);function encodeJSON(i){return(0,F.B)((0,Z.m)(safeJsonStringify(i),"utf8"),H)}function encodeIss(i){let r=(0,Z.m)("K36",J),o="z"+(0,F.B)((0,G.z)([r,i]),J);return["did","key",o].join(":")}function generateKeyPair(i=(0,U.randomBytes)(32)){return V._w(i)}async function signJWT(i,r,o,c,l=(0,$.fromMiliseconds)(Date.now())){var f,m,v;let w={alg:"EdDSA",typ:"JWT"},E=encodeIss(c.publicKey),I={iss:E,sub:i,aud:r,iat:l,exp:l+o},P=(f={header:w,payload:I},(0,Z.m)([encodeJSON(f.header),encodeJSON(f.payload)].join("."),"utf8")),R=V.Xx(c.secretKey,P);return[encodeJSON((m={header:w,payload:I,signature:R}).header),encodeJSON(m.payload),(v=m.signature,(0,F.B)(v,H))].join(".")}o(43014);var W=o(5015),Q=o(37466);let Y="INTERNAL_ERROR",ee="SERVER_ERROR",et=[-32700,-32600,-32601,-32602,-32603],ei={PARSE_ERROR:{code:-32700,message:"Parse error"},INVALID_REQUEST:{code:-32600,message:"Invalid Request"},METHOD_NOT_FOUND:{code:-32601,message:"Method not found"},INVALID_PARAMS:{code:-32602,message:"Invalid params"},[Y]:{code:-32603,message:"Internal error"},[ee]:{code:-32e3,message:"Server error"}};function getError(i){return Object.keys(ei).includes(i)?ei[i]:ei[ee]}var es=o(1468);function payloadId(i=3){let r=Date.now()*Math.pow(10,i);return r+Math.floor(Math.random()*Math.pow(10,i))}function getBigIntRpcId(i=6){return BigInt(payloadId(i))}function formatJsonRpcRequest(i,r,o){return{id:o||payloadId(),jsonrpc:"2.0",method:i,params:r}}function formatJsonRpcResult(i,r){return{id:i,jsonrpc:"2.0",result:r}}function formatJsonRpcError(i,r,o){var c,l;return{id:i,jsonrpc:"2.0",error:void 0===(c=r)?getError(Y):("string"==typeof c&&(c=Object.assign(Object.assign({},getError(ee)),{message:c})),void 0!==o&&(c.data=o),l=c.code,et.includes(l)&&(c=function(i){let r=Object.values(ei).find(r=>r.code===i);return r||ei[ee]}(c.code)),c)}}let misc_IEvents=class misc_IEvents{};let IBaseJsonRpcProvider=class IBaseJsonRpcProvider extends misc_IEvents{constructor(){super()}};let IJsonRpcProvider=class IJsonRpcProvider extends IBaseJsonRpcProvider{constructor(i){super()}};function isWsUrl(i){return function(i,r){let o=function(i){let r=i.match(RegExp(/^\w+:/,"gi"));if(r&&r.length)return r[0]}(i);return void 0!==o&&new RegExp(r).test(o)}(i,"^wss?:")}function isJsonRpcPayload(i){return"object"==typeof i&&"id"in i&&"jsonrpc"in i&&"2.0"===i.jsonrpc}function isJsonRpcRequest(i){return isJsonRpcPayload(i)&&"method"in i}function isJsonRpcResponse(i){return isJsonRpcPayload(i)&&(isJsonRpcResult(i)||isJsonRpcError(i))}function isJsonRpcResult(i){return"result"in i}function isJsonRpcError(i){return"error"in i}let JsonRpcProvider=class JsonRpcProvider extends IJsonRpcProvider{constructor(i){super(i),this.events=new E.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(i),this.connection.connected&&this.registerEventListeners()}async connect(i=this.connection){await this.open(i)}async disconnect(){await this.close()}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async request(i,r){return this.requestStrict(formatJsonRpcRequest(i.method,i.params||[],i.id||getBigIntRpcId().toString()),r)}async requestStrict(i,r){return new Promise(async(o,c)=>{if(!this.connection.connected)try{await this.open()}catch(i){c(i)}this.events.on(`${i.id}`,i=>{isJsonRpcError(i)?c(i.error):o(i.result)});try{await this.connection.send(i,r)}catch(i){c(i)}})}setConnection(i=this.connection){return i}onPayload(i){this.events.emit("payload",i),isJsonRpcResponse(i)?this.events.emit(`${i.id}`,i):this.events.emit("message",{type:i.method,data:i.params})}onClose(i){i&&3e3===i.code&&this.events.emit("error",Error(`WebSocket connection closed abnormally with code: ${i.code} ${i.reason?`(${i.reason})`:""}`)),this.events.emit("disconnect")}async open(i=this.connection){this.connection===i&&this.connection.connected||(this.connection.connected&&this.close(),"string"==typeof i&&(await this.connection.open(i),i=this.connection),this.connection=this.setConnection(i),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",i=>this.onPayload(i)),this.connection.on("close",i=>this.onClose(i)),this.connection.on("error",i=>this.events.emit("error",i)),this.connection.on("register_error",i=>this.onClose()),this.hasRegisteredEventListeners=!0)}};let hasBuiltInWebSocket=()=>"undefined"!=typeof WebSocket||void 0!==o.g&&void 0!==o.g.WebSocket||"undefined"!=typeof window&&void 0!==window.WebSocket||"undefined"!=typeof self&&void 0!==self.WebSocket,truncateQuery=i=>i.split("?")[0],en="undefined"!=typeof WebSocket?WebSocket:void 0!==o.g&&void 0!==o.g.WebSocket?o.g.WebSocket:"undefined"!=typeof window&&void 0!==window.WebSocket?window.WebSocket:"undefined"!=typeof self&&void 0!==self.WebSocket?self.WebSocket:o(72030);var eo=class{constructor(i){if(this.url=i,this.events=new E.EventEmitter,this.registering=!1,!isWsUrl(i))throw Error(`Provided URL is not compatible with WebSocket connection: ${i}`);this.url=i}get connected(){return void 0!==this.socket}get connecting(){return this.registering}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async open(i=this.url){await this.register(i)}async close(){return new Promise((i,r)=>{if(void 0===this.socket){r(Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),i()},this.socket.close()})}async send(i,r){void 0===this.socket&&(this.socket=await this.register());try{this.socket.send(safeJsonStringify(i))}catch(r){this.onError(i.id,r)}}register(i=this.url){if(!isWsUrl(i))throw Error(`Provided URL is not compatible with WebSocket connection: ${i}`);if(this.registering){let i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((i,r)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),r(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),void 0===this.socket)return r(Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=i,this.registering=!0,new Promise((r,o)=>{let c=(0,es.isReactNative)()?void 0:{rejectUnauthorized:!RegExp("wss?://localhost(:d{2,5})?").test(i)},l=new en(i,[],c);hasBuiltInWebSocket()?l.onerror=i=>{o(this.emitError(i.error))}:l.on("error",i=>{o(this.emitError(i))}),l.onopen=()=>{this.onOpen(l),r(l)}})}onOpen(i){i.onmessage=i=>this.onPayload(i),i.onclose=i=>this.onClose(i),this.socket=i,this.registering=!1,this.events.emit("open")}onClose(i){this.socket=void 0,this.registering=!1,this.events.emit("close",i)}onPayload(i){if(void 0===i.data)return;let r="string"==typeof i.data?esm_safeJsonParse(i.data):i.data;this.events.emit("payload",r)}onError(i,r){let o=this.parseError(r),c=o.message||o.toString(),l=formatJsonRpcError(i,c);this.events.emit("payload",l)}parseError(i,r=this.url){var o;return o=truncateQuery(r),i.message.includes("getaddrinfo ENOTFOUND")||i.message.includes("connect ECONNREFUSED")?Error(`Unavailable WS RPC url at ${o}`):i}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}emitError(i){let r=this.parseError(Error((null==i?void 0:i.message)||`WebSocket connection failed for host: ${truncateQuery(this.url)}`));return this.events.emit("register_error",r),r}},ea=o(72307),ec=o.n(ea),el=o(34155),qi=function(i,r){if(i.length>=255)throw TypeError("Alphabet too long");for(var o=new Uint8Array(256),c=0;c<o.length;c++)o[c]=255;for(var l=0;l<i.length;l++){var f=i.charAt(l),m=f.charCodeAt(0);if(255!==o[m])throw TypeError(f+" is ambiguous");o[m]=l}var v=i.length,w=i.charAt(0),E=Math.log(v)/Math.log(256),I=Math.log(256)/Math.log(v);function y(i){if("string"!=typeof i)throw TypeError("Expected String");if(0===i.length)return new Uint8Array;var r=0;if(" "!==i[0]){for(var c=0,l=0;i[r]===w;)c++,r++;for(var f=(i.length-r)*E+1>>>0,m=new Uint8Array(f);i[r];){var I=o[i.charCodeAt(r)];if(255===I)return;for(var P=0,R=f-1;(0!==I||P<l)&&-1!==R;R--,P++)I+=v*m[R]>>>0,m[R]=I%256>>>0,I=I/256>>>0;if(0!==I)throw Error("Non-zero carry");l=P,r++}if(" "!==i[r]){for(var x=f-l;x!==f&&0===m[x];)x++;for(var N=new Uint8Array(c+(f-x)),C=c;x!==f;)N[C++]=m[x++];return N}}}return{encode:function(r){if(r instanceof Uint8Array||(ArrayBuffer.isView(r)?r=new Uint8Array(r.buffer,r.byteOffset,r.byteLength):Array.isArray(r)&&(r=Uint8Array.from(r))),!(r instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===r.length)return"";for(var o=0,c=0,l=0,f=r.length;l!==f&&0===r[l];)l++,o++;for(var m=(f-l)*I+1>>>0,E=new Uint8Array(m);l!==f;){for(var P=r[l],R=0,x=m-1;(0!==P||R<c)&&-1!==x;x--,R++)P+=256*E[x]>>>0,E[x]=P%v>>>0,P=P/v>>>0;if(0!==P)throw Error("Non-zero carry");c=R,l++}for(var N=m-c;N!==m&&0===E[N];)N++;for(var C=w.repeat(o);N<m;++N)C+=i.charAt(E[N]);return C},decodeUnsafe:y,decode:function(i){var o=y(i);if(o)return o;throw Error(`Non-${r} character`)}}};let ze=i=>{if(i instanceof Uint8Array&&"Uint8Array"===i.constructor.name)return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw Error("Unknown type, must be binary type")},ji=i=>new TextEncoder().encode(i),Yi=i=>new TextDecoder().decode(i);let Gi=class Gi{constructor(i,r,o){this.name=i,this.prefix=r,this.baseEncode=o}encode(i){if(i instanceof Uint8Array)return`${this.prefix}${this.baseEncode(i)}`;throw Error("Unknown type, must be binary type")}};let Hi=class Hi{constructor(i,r,o){if(this.name=i,this.prefix=r,void 0===r.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=o}decode(i){if("string"==typeof i){if(i.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(i)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(i.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(i){return Ne(this,i)}};let Ji=class Ji{constructor(i){this.decoders=i}or(i){return Ne(this,i)}decode(i){let r=i[0],o=this.decoders[r];if(o)return o.decode(i);throw RangeError(`Unable to decode multibase string ${JSON.stringify(i)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};let Ne=(i,r)=>new Ji({...i.decoders||{[i.prefix]:i},...r.decoders||{[r.prefix]:r}});let Wi=class Wi{constructor(i,r,o,c){this.name=i,this.prefix=r,this.baseEncode=o,this.baseDecode=c,this.encoder=new Gi(i,r,o),this.decoder=new Hi(i,r,c)}encode(i){return this.encoder.encode(i)}decode(i){return this.decoder.decode(i)}};let X=({name:i,prefix:r,encode:o,decode:c})=>new Wi(i,r,o,c),B=({prefix:i,name:r,alphabet:o})=>{let{encode:c,decode:l}=qi(o,r);return X({prefix:i,name:r,encode:c,decode:i=>ze(l(i))})},Xi=(i,r,o,c)=>{let l={};for(let i=0;i<r.length;++i)l[r[i]]=i;let f=i.length;for(;"="===i[f-1];)--f;let m=new Uint8Array(f*o/8|0),v=0,w=0,E=0;for(let r=0;r<f;++r){let f=l[i[r]];if(void 0===f)throw SyntaxError(`Non-${c} character`);w=w<<o|f,(v+=o)>=8&&(v-=8,m[E++]=255&w>>v)}if(v>=o||255&w<<8-v)throw SyntaxError("Unexpected end of data");return m},Qi=(i,r,o)=>{let c="="===r[r.length-1],l=(1<<o)-1,f="",m=0,v=0;for(let c=0;c<i.length;++c)for(v=v<<8|i[c],m+=8;m>o;)m-=o,f+=r[l&v>>m];if(m&&(f+=r[l&v<<o-m]),c)for(;f.length*o&7;)f+="=";return f},index_es_g=({name:i,prefix:r,bitsPerChar:o,alphabet:c})=>X({prefix:r,name:i,encode:i=>Qi(i,c,o),decode:r=>Xi(r,c,o,i)}),eh=X({prefix:"\x00",name:"identity",encode:i=>Yi(i),decode:i=>ji(i)});var eu=Object.freeze({__proto__:null,identity:eh});let ed=index_es_g({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ep=Object.freeze({__proto__:null,base2:ed});let eg=index_es_g({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ef=Object.freeze({__proto__:null,base8:eg});let ey=B({prefix:"9",name:"base10",alphabet:"0123456789"});var em=Object.freeze({__proto__:null,base10:ey});let e_=index_es_g({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ev=index_es_g({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var ew=Object.freeze({__proto__:null,base16:e_,base16upper:ev});let eb=index_es_g({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),eE=index_es_g({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),eS=index_es_g({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),eI=index_es_g({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),eP=index_es_g({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),eR=index_es_g({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ex=index_es_g({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),eO=index_es_g({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),eN=index_es_g({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var eC=Object.freeze({__proto__:null,base32:eb,base32upper:eE,base32pad:eS,base32padupper:eI,base32hex:eP,base32hexupper:eR,base32hexpad:ex,base32hexpadupper:eO,base32z:eN});let eT=B({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),eA=B({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var eD=Object.freeze({__proto__:null,base36:eT,base36upper:eA});let eL=B({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),eq=B({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var eM=Object.freeze({__proto__:null,base58btc:eL,base58flickr:eq});let ez=index_es_g({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ek=index_es_g({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ej=index_es_g({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),eV=index_es_g({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var eU=Object.freeze({__proto__:null,base64:ez,base64pad:ek,base64url:ej,base64urlpad:eV});let eK=Array.from("\uD83D\uDE80\uD83E\uDE90\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B\uD83E\uDD19\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81\uD83C\uDF1E\uD83C\uDF88\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74\uD83D\uDC8E\uD83D\uDCB8\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),e$=eK.reduce((i,r,o)=>(i[o]=r,i),[]),eB=eK.reduce((i,r,o)=>(i[r.codePointAt(0)]=o,i),[]),eH=X({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(i){return i.reduce((i,r)=>i+=e$[r],"")},decode:function(i){let r=[];for(let o of i){let i=eB[o.codePointAt(0)];if(void 0===i)throw Error(`Non-base256emoji character: ${o}`);r.push(i)}return new Uint8Array(r)}});var eJ=Object.freeze({__proto__:null,base256emoji:eH});function Fe(i,r,o){r=r||[],o=o||0;for(var c=o;i>=2147483648;)r[o++]=255&i|128,i/=128;for(;-128&i;)r[o++]=255&i|128,i>>>=7;return r[o]=0|i,Fe.bytes=o-c+1,r}function he(i,r){var o,c=0,r=r||0,l=0,f=r,m=i.length;do{if(f>=m)throw he.bytes=0,RangeError("Could not decode varint");o=i[f++],c+=l<28?(127&o)<<l:(127&o)*Math.pow(2,l),l+=7}while(o>=128);return he.bytes=f-r,c}var eG={encode:Fe,decode:he,encodingLength:function(i){return i<128?1:i<16384?2:i<2097152?3:i<268435456?4:i<34359738368?5:i<4398046511104?6:i<562949953421312?7:i<72057594037927940?8:i<0x7fffffffffffffff?9:10}};let ke=(i,r,o=0)=>(eG.encode(i,r,o),r),Ke=i=>eG.encodingLength(i),ce=(i,r)=>{let o=r.byteLength,c=Ke(i),l=c+Ke(o),f=new Uint8Array(l+o);return ke(i,f,0),ke(o,f,c),f.set(r,l),new er(i,o,r,f)};let er=class er{constructor(i,r,o,c){this.code=i,this.size=r,this.digest=o,this.bytes=c}};let Be=({name:i,code:r,encode:o})=>new tr(i,r,o);let tr=class tr{constructor(i,r,o){this.name=i,this.code=r,this.encode=o}digest(i){if(i instanceof Uint8Array){let r=this.encode(i);return r instanceof Uint8Array?ce(this.code,r):r.then(i=>ce(this.code,i))}throw Error("Unknown type, must be binary type")}};let Ve=i=>async r=>new Uint8Array(await crypto.subtle.digest(i,r)),eF=Be({name:"sha2-256",code:18,encode:Ve("SHA-256")}),eZ=Be({name:"sha2-512",code:19,encode:Ve("SHA-512")});var eW=Object.freeze({__proto__:null,sha256:eF,sha512:eZ}),eQ=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:ze,digest:i=>ce(0,ze(i))}});new TextEncoder,new TextDecoder;let eY={...eu,...ep,...ef,...em,...ew,...eC,...eD,...eM,...eU,...eJ};function Ge(i){return null!=globalThis.Buffer?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function He(i,r,o,c){return{name:i,prefix:r,encoder:{name:i,prefix:r,encode:o},decoder:{decode:c}}}({...eW,...eQ});let eX=He("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),e0=He("ascii","a",i=>{let r="a";for(let o=0;o<i.length;o++)r+=String.fromCharCode(i[o]);return r},i=>{i=i.substring(1);let r=function(i=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?Ge(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}(i.length);for(let o=0;o<i.length;o++)r[o]=i.charCodeAt(o);return r}),e1={utf8:eX,"utf-8":eX,hex:eY.base16,latin1:e0,ascii:e0,binary:e0,...eY},e5="core",e6=`wc@2:${e5}:`,e3={logger:"error"},e2={database:":memory:"},e7="client_ed25519_seed",e4=$.ONE_DAY,e8=$.SIX_HOURS,e9="wss://relay.walletconnect.com",tt="wss://relay.walletconnect.org",ti={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",publish:"relayer_publish"},ts={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},tn=$.ONE_SECOND,to={created:"subscription_created",deleted:"subscription_deleted",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},ta=1e3*$.FIVE_SECONDS,tc={wc_pairingDelete:{req:{ttl:$.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:$.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:$.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:$.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:$.ONE_DAY,prompt:!1,tag:0},res:{ttl:$.ONE_DAY,prompt:!1,tag:0}}},tl={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},th={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},tu={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},td="verify-api",tp="https://verify.walletconnect.com",tg="https://verify.walletconnect.org",tf=[tp,tg];let _t=class _t{constructor(i,r){this.core=i,this.logger=r,this.keychain=new Map,this.name="keychain",this.version="0.3",this.initialized=!1,this.storagePrefix=e6,this.init=async()=>{if(!this.initialized){let i=await this.getKeyChain();"u">typeof i&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,r)=>{this.isInitialized(),this.keychain.set(i,r),await this.persist()},this.get=i=>{this.isInitialized();let r=this.keychain.get(i);if(typeof r>"u"){let{message:r}=(0,W.Z7)("NO_MATCHING_KEY",`${this.name}: ${i}`);throw Error(r)}return r},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=i,this.logger=(0,L.generateChildLogger)(r,this.name)}get context(){return(0,L.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(i){await this.core.storage.setItem(this.storageKey,(0,W.KC)(i))}async getKeyChain(){let i=await this.core.storage.getItem(this.storageKey);return"u">typeof i?(0,W.IP)(i):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:i}=(0,W.Z7)("NOT_INITIALIZED",this.name);throw Error(i)}}};let St=class St{constructor(i,r,o){this.core=i,this.logger=r,this.name="crypto",this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();let i=await this.getClientSeed(),r=generateKeyPair(i);return encodeIss(r.publicKey)},this.generateKeyPair=()=>{this.isInitialized();let i=(0,W.Au)();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();let r=await this.getClientSeed(),o=generateKeyPair(r),c=(0,W.jd)();return await signJWT(c,i,e4,o)},this.generateSharedKey=(i,r,o)=>{this.isInitialized();let c=this.getPrivateKey(i),l=(0,W.m$)(c,r);return this.setSymKey(l,o)},this.setSymKey=async(i,r)=>{this.isInitialized();let o=r||(0,W.Ym)(i);return await this.keychain.set(o,i),o},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,r,o)=>{this.isInitialized();let c=(0,W.EN)(o),l=safeJsonStringify(r);if((0,W.Q8)(c)){let r=c.senderPublicKey,o=c.receiverPublicKey;i=await this.generateSharedKey(r,o)}let f=this.getSymKey(i),{type:m,senderPublicKey:v}=c;return(0,W.HI)({type:m,symKey:f,message:l,senderPublicKey:v})},this.decode=async(i,r,o)=>{this.isInitialized();let c=(0,W.Ll)(r,o);if((0,W.Q8)(c)){let r=c.receiverPublicKey,o=c.senderPublicKey;i=await this.generateSharedKey(r,o)}try{let o=this.getSymKey(i),c=(0,W.pe)({symKey:o,encoded:r});return esm_safeJsonParse(c)}catch(r){this.logger.error(`Failed to decode message from topic: '${i}', clientId: '${await this.getClientId()}'`),this.logger.error(r)}},this.getPayloadType=i=>{let r=(0,W.vB)(i);return(0,W.WG)(r.type)},this.getPayloadSenderPublicKey=i=>{let r=(0,W.vB)(i);return r.senderPublicKey?(0,Q.BB)(r.senderPublicKey,W.AW):void 0},this.core=i,this.logger=(0,L.generateChildLogger)(r,this.name),this.keychain=o||new _t(this.core,this.logger)}get context(){return(0,L.getLoggerContext)(this.logger)}async setPrivateKey(i,r){return await this.keychain.set(i,r),i}getPrivateKey(i){return this.keychain.get(i)}async getClientSeed(){let i="";try{i=this.keychain.get(e7)}catch{i=(0,W.jd)(),await this.keychain.set(e7,i)}return function(i,r="utf8"){let o=e1[r];if(!o)throw Error(`Unsupported encoding "${r}"`);return("utf8"===r||"utf-8"===r)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?Ge(globalThis.Buffer.from(i,"utf-8")):o.decoder.decode(`${o.prefix}${i}`)}(i,"base16")}getSymKey(i){return this.keychain.get(i)}isInitialized(){if(!this.initialized){let{message:i}=(0,W.Z7)("NOT_INITIALIZED",this.name);throw Error(i)}}};let Tt=class Tt extends a{constructor(i,r){super(i,r),this.logger=i,this.core=r,this.messages=new Map,this.name="messages",this.version="0.3",this.initialized=!1,this.storagePrefix=e6,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let i=await this.getRelayerMessages();"u">typeof i&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,r)=>{this.isInitialized();let o=(0,W.rj)(r),c=this.messages.get(i);return typeof c>"u"&&(c={}),"u">typeof c[o]||(c[o]=r,this.messages.set(i,c),await this.persist()),o},this.get=i=>{this.isInitialized();let r=this.messages.get(i);return typeof r>"u"&&(r={}),r},this.has=(i,r)=>{this.isInitialized();let o=this.get(i),c=(0,W.rj)(r);return"u">typeof o[c]},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=(0,L.generateChildLogger)(i,this.name),this.core=r}get context(){return(0,L.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(i){await this.core.storage.setItem(this.storageKey,(0,W.KC)(i))}async getRelayerMessages(){let i=await this.core.storage.getItem(this.storageKey);return"u">typeof i?(0,W.IP)(i):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){let{message:i}=(0,W.Z7)("NOT_INITIALIZED",this.name);throw Error(i)}}};let yr=class yr extends u{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.events=new E.EventEmitter,this.name="publisher",this.queue=new Map,this.publishTimeout=(0,$.toMiliseconds)($.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(i,r,o)=>{var c;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:r,opts:o}});try{let l=o?.ttl||e8,f=(0,W._H)(o),m=o?.prompt||!1,v=o?.tag||0,w=o?.id||getBigIntRpcId().toString(),E={topic:i,message:r,opts:{ttl:l,relay:f,prompt:m,tag:v,id:w}},I=setTimeout(()=>this.queue.set(w,E),this.publishTimeout);try{await await (0,W.hF)(this.rpcPublish(i,r,l,f,m,v,w),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(w),this.relayer.events.emit(ti.publish,E)}catch(i){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,null!=(c=o?.internal)&&c.throwOnFailedPublish)throw this.removeRequestFromQueue(w),i;return}finally{clearTimeout(I)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:r,opts:o}})}catch(i){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(i),i}},this.on=(i,r)=>{this.events.on(i,r)},this.once=(i,r)=>{this.events.once(i,r)},this.off=(i,r)=>{this.events.off(i,r)},this.removeListener=(i,r)=>{this.events.removeListener(i,r)},this.relayer=i,this.logger=(0,L.generateChildLogger)(r,this.name),this.registerEventListeners()}get context(){return(0,L.getLoggerContext)(this.logger)}rpcPublish(i,r,o,c,l,f,m){var v,w,E,I;let P={method:(0,W.cO)(c.protocol).publish,params:{topic:i,message:r,ttl:o,prompt:l,tag:f},id:m};return(0,W.o8)(null==(v=P.params)?void 0:v.prompt)&&(null==(w=P.params)||delete w.prompt),(0,W.o8)(null==(E=P.params)?void 0:E.tag)&&(null==(I=P.params)||delete I.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:P}),this.relayer.request(P)}removeRequestFromQueue(i){this.queue.delete(i)}checkQueue(){this.queue.forEach(async i=>{let{topic:r,message:o,opts:c}=i;await this.publish(r,o,c)})}registerEventListeners(){this.relayer.core.heartbeat.on(D.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(ti.connection_stalled);return}this.checkQueue()}),this.relayer.on(ti.message_ack,i=>{this.removeRequestFromQueue(i.id.toString())})}};let mr=class mr{constructor(){this.map=new Map,this.set=(i,r)=>{let o=this.get(i);this.exists(i,r)||this.map.set(i,[...o,r])},this.get=i=>this.map.get(i)||[],this.exists=(i,r)=>this.get(i).includes(r),this.delete=(i,r)=>{if(typeof r>"u"){this.map.delete(i);return}if(!this.map.has(i))return;let o=this.get(i);if(!this.exists(i,r))return;let c=o.filter(i=>i!==r);if(!c.length){this.map.delete(i);return}this.map.set(i,c)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}};var ty=Object.defineProperty,tm=Object.defineProperties,t_=Object.getOwnPropertyDescriptors,tv=Object.getOwnPropertySymbols,tw=Object.prototype.hasOwnProperty,tb=Object.prototype.propertyIsEnumerable,xt=(i,r,o)=>r in i?ty(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,q=(i,r)=>{for(var o in r||(r={}))tw.call(r,o)&&xt(i,o,r[o]);if(tv)for(var o of tv(r))tb.call(r,o)&&xt(i,o,r[o]);return i},De=(i,r)=>tm(i,t_(r));let Ot=class Ot extends d{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.subscriptions=new Map,this.topicMap=new mr,this.events=new E.EventEmitter,this.name="subscription",this.version="0.3",this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=e6,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(i,r)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:r}});try{let o=(0,W._H)(r),c={topic:i,relay:o};this.pending.set(i,c);let l=await this.rpcSubscribe(i,o);return this.onSubscribe(l,c),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:r}}),l}catch(i){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(i),i}},this.unsubscribe=async(i,r)=>{await this.restartToComplete(),this.isInitialized(),"u">typeof r?.id?await this.unsubscribeById(i,r.id,r):await this.unsubscribeByTopic(i,r)},this.isSubscribed=async i=>!!this.topics.includes(i)||await new Promise((r,o)=>{let c=new $.Watch;c.start(this.pendingSubscriptionWatchLabel);let l=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(l),c.stop(this.pendingSubscriptionWatchLabel),r(!0)),c.elapsed(this.pendingSubscriptionWatchLabel)>=ta&&(clearInterval(l),c.stop(this.pendingSubscriptionWatchLabel),o(Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(i,r)=>{this.events.on(i,r)},this.once=(i,r)=>{this.events.once(i,r)},this.off=(i,r)=>{this.events.off(i,r)},this.removeListener=(i,r)=>{this.events.removeListener(i,r)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=i,this.logger=(0,L.generateChildLogger)(r,this.name),this.clientId=""}get context(){return(0,L.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(i,r){let o=!1;try{o=this.getSubscription(i).topic===r}catch{}return o}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(i,r){let o=this.topicMap.get(i);await Promise.all(o.map(async o=>await this.unsubscribeById(i,o,r)))}async unsubscribeById(i,r,o){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:o}});try{let c=(0,W._H)(o);await this.rpcUnsubscribe(i,r,c);let l=(0,W.D6)("USER_DISCONNECTED",`${this.name}, ${i}`);await this.onUnsubscribe(i,r,l),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:o}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(i,r){let o={method:(0,W.cO)(r.protocol).subscribe,params:{topic:i}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o});try{await await (0,W.hF)(this.relayer.request(o),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(ti.connection_stalled)}return(0,W.rj)(i+this.clientId)}async rpcBatchSubscribe(i){if(!i.length)return;let r=i[0].relay,o={method:(0,W.cO)(r.protocol).batchSubscribe,params:{topics:i.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o});try{return await await (0,W.hF)(this.relayer.request(o),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(ti.connection_stalled)}}rpcUnsubscribe(i,r,o){let c={method:(0,W.cO)(o.protocol).unsubscribe,params:{topic:i,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:c}),this.relayer.request(c)}onSubscribe(i,r){this.setSubscription(i,De(q({},r),{id:i})),this.pending.delete(r.topic)}onBatchSubscribe(i){i.length&&i.forEach(i=>{this.setSubscription(i.id,q({},i)),this.pending.delete(i.topic)})}async onUnsubscribe(i,r,o){this.events.removeAllListeners(r),this.hasSubscription(r,i)&&this.deleteSubscription(r,o),await this.relayer.messages.del(i)}async setRelayerSubscriptions(i){await this.relayer.core.storage.setItem(this.storageKey,i)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(i,r){this.subscriptions.has(i)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:i,subscription:r}),this.addSubscription(i,r))}addSubscription(i,r){this.subscriptions.set(i,q({},r)),this.topicMap.set(r.topic,i),this.events.emit(to.created,r)}getSubscription(i){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:i});let r=this.subscriptions.get(i);if(!r){let{message:r}=(0,W.Z7)("NO_MATCHING_KEY",`${this.name}: ${i}`);throw Error(r)}return r}deleteSubscription(i,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:i,reason:r});let o=this.getSubscription(i);this.subscriptions.delete(i),this.topicMap.delete(o.topic,i),this.events.emit(to.deleted,De(q({},o),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(to.sync)}async reset(){if(this.cached.length){let i=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<i;r++){let i=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(to.resubscribed)}async restore(){try{let i=await this.getRelayerSubscriptions();if(typeof i>"u"||!i.length)return;if(this.subscriptions.size){let{message:i}=(0,W.Z7)("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),Error(i)}this.cached=i,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(i){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(i)}}async batchSubscribe(i){if(!i.length)return;let r=await this.rpcBatchSubscribe(i);(0,W.qt)(r)&&this.onBatchSubscribe(r.map((r,o)=>De(q({},i[o]),{id:r})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;let i=[];this.pending.forEach(r=>{i.push(r)}),await this.batchSubscribe(i)}registerEventListeners(){this.relayer.core.heartbeat.on(D.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(ti.connect,async()=>{await this.onConnect()}),this.relayer.on(ti.disconnect,()=>{this.onDisconnect()}),this.events.on(to.created,async i=>{let r=to.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()}),this.events.on(to.deleted,async i=>{let r=to.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()})}isInitialized(){if(!this.initialized){let{message:i}=(0,W.Z7)("NOT_INITIALIZED",this.name);throw Error(i)}}async restartToComplete(){this.restartInProgress&&await new Promise(i=>{let r=setInterval(()=>{this.restartInProgress||(clearInterval(r),i())},this.pollingInterval)})}};var tE=Object.defineProperty,tS=Object.getOwnPropertySymbols,tI=Object.prototype.hasOwnProperty,tP=Object.prototype.propertyIsEnumerable,zt=(i,r,o)=>r in i?tE(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,_r=(i,r)=>{for(var o in r||(r={}))tI.call(r,o)&&zt(i,o,r[o]);if(tS)for(var o of tS(r))tP.call(r,o)&&zt(i,o,r[o]);return i};let Nt=class Nt extends g{constructor(i){super(i),this.protocol="wc",this.version=2,this.events=new E.EventEmitter,this.name="relayer",this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async i=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(i)}catch(i){throw this.logger.debug("Failed to Publish Request"),this.logger.error(i),i}},this.onPayloadHandler=i=>{this.onProviderPayload(i)},this.onConnectHandler=()=>{this.events.emit(ti.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=i=>{this.logger.error(i),this.events.emit(ti.error,i),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(ts.payload,this.onPayloadHandler),this.provider.on(ts.connect,this.onConnectHandler),this.provider.on(ts.disconnect,this.onDisconnectHandler),this.provider.on(ts.error,this.onProviderErrorHandler)},this.core=i.core,this.logger="u">typeof i.logger&&"string"!=typeof i.logger?(0,L.generateChildLogger)(i.logger,this.name):(0,L.pino)((0,L.getDefaultLoggerOptions)({level:i.logger||"error"})),this.messages=new Tt(this.logger,i.core),this.subscriber=new Ot(this,this.logger),this.publisher=new yr(this,this.logger),this.relayUrl=i?.relayUrl||e9,this.projectId=i.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${tt}...`),await this.restartTransport(tt)}this.initialized=!0,setTimeout(async()=>{0===this.subscriber.topics.length&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},1e4)}get context(){return(0,L.getLoggerContext)(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(i,r,o){this.isInitialized(),await this.publisher.publish(i,r,o),await this.recordMessageEvent({topic:i,message:r,publishedAt:Date.now()})}async subscribe(i,r){var o;let c;this.isInitialized();let l=(null==(o=this.subscriber.topicMap.get(i))?void 0:o[0])||"";if(l)return l;let a=r=>{r.topic===i&&(this.subscriber.off(to.created,a),c())};return await Promise.all([new Promise(i=>{c=i,this.subscriber.on(to.created,a)}),new Promise(async o=>{l=await this.subscriber.subscribe(i,r),o()})]),l}async unsubscribe(i,r){this.isInitialized(),await this.subscriber.unsubscribe(i,r)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await (0,W.hF)(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(i){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){i&&i!==this.relayUrl&&(this.relayUrl=i,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(i=>{if(!this.initialized)return i();this.subscriber.once(to.resubscribed,()=>{i()})}),new Promise(async(i,r)=>{try{await (0,W.hF)(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(i){r(i);return}i()})])}catch(i){if(this.logger.error(i),!this.isConnectionStalled(i.message))throw i;this.provider.events.emit(ts.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(i){await this.confirmOnlineStateOrThrow(),this.connectionAttemptInProgress||(this.relayUrl=i||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await (0,W.Gg)())throw Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(i){return this.staleConnectionErrors.some(r=>i.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();let i=await this.core.crypto.signJWT(this.relayUrl);this.provider=new JsonRpcProvider(new eo((0,W.$0)({sdkVersion:"2.10.4",protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:i,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(i){let{topic:r,message:o}=i;await this.messages.set(r,o)}async shouldIgnoreMessageEvent(i){let{topic:r,message:o}=i;if(!o||0===o.length)return this.logger.debug(`Ignoring invalid/empty message: ${o}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;let c=this.messages.has(r,o);return c&&this.logger.debug(`Ignoring duplicate message: ${o}`),c}async onProviderPayload(i){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:i}),isJsonRpcRequest(i)){if(!i.method.endsWith("_subscription"))return;let r=i.params,{topic:o,message:c,publishedAt:l}=r.data,f={topic:o,message:c,publishedAt:l};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(_r({type:"event",event:r.id},f)),this.events.emit(r.id,f),await this.acknowledgePayload(i),await this.onMessageEvent(f)}else isJsonRpcResponse(i)&&this.events.emit(ti.message_ack,i)}async onMessageEvent(i){await this.shouldIgnoreMessageEvent(i)||(this.events.emit(ti.message,i),await this.recordMessageEvent(i))}async acknowledgePayload(i){let r=formatJsonRpcResult(i.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(ts.payload,this.onPayloadHandler),this.provider.off(ts.connect,this.onConnectHandler),this.provider.off(ts.disconnect,this.onDisconnectHandler),this.provider.off(ts.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(ti.connection_stalled,()=>{this.restartTransport().catch(i=>this.logger.error(i))});let i=await (0,W.Gg)();(0,W.uw)(async r=>{this.initialized&&i!==r&&(i=r,r?await this.restartTransport().catch(i=>this.logger.error(i)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(i=>this.logger.error(i))))})}onProviderDisconnect(){this.events.emit(ti.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(i=>this.logger.error(i))},(0,$.toMiliseconds)(tn)))}isInitialized(){if(!this.initialized){let{message:i}=(0,W.Z7)("NOT_INITIALIZED",this.name);throw Error(i)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(i=>{let r=setInterval(()=>{this.connected&&(clearInterval(r),i())},this.connectionStatusPollingInterval)});await this.restartTransport()}}};var tR=Object.defineProperty,tx=Object.getOwnPropertySymbols,tO=Object.prototype.hasOwnProperty,tN=Object.prototype.propertyIsEnumerable,Lt=(i,r,o)=>r in i?tR(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Ft=(i,r)=>{for(var o in r||(r={}))tO.call(r,o)&&Lt(i,o,r[o]);if(tx)for(var o of tx(r))tN.call(r,o)&&Lt(i,o,r[o]);return i};let $t=class $t extends p{constructor(i,r,o,c=e6,l){super(i,r,o,c),this.core=i,this.logger=r,this.name=o,this.map=new Map,this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=e6,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>{this.getKey&&null!==i&&!(0,W.o8)(i)?this.map.set(this.getKey(i),i):(0,W.xW)(i)?this.map.set(i.id,i):(0,W.h1)(i)&&this.map.set(i.topic,i)}),this.cached=[],this.initialized=!0)},this.set=async(i,r)=>{this.isInitialized(),this.map.has(i)?await this.update(i,r):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:i,value:r}),this.map.set(i,r),await this.persist())},this.get=i=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:i}),this.getData(i)),this.getAll=i=>(this.isInitialized(),i?this.values.filter(r=>Object.keys(i).every(o=>ec()(r[o],i[o]))):this.values),this.update=async(i,r)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:i,update:r});let o=Ft(Ft({},this.getData(i)),r);this.map.set(i,o),await this.persist()},this.delete=async(i,r)=>{this.isInitialized(),this.map.has(i)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:i,reason:r}),this.map.delete(i),await this.persist())},this.logger=(0,L.generateChildLogger)(r,this.name),this.storagePrefix=c,this.getKey=l}get context(){return(0,L.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(i){await this.core.storage.setItem(this.storageKey,i)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(i){let r=this.map.get(i);if(!r){let{message:r}=(0,W.Z7)("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(r),Error(r)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{let i=await this.getDataStore();if(typeof i>"u"||!i.length)return;if(this.map.size){let{message:i}=(0,W.Z7)("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),Error(i)}this.cached=i,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(i){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(i)}}isInitialized(){if(!this.initialized){let{message:i}=(0,W.Z7)("NOT_INITIALIZED",this.name);throw Error(i)}}};let Mt=class Mt{constructor(i,r){this.core=i,this.logger=r,this.name="pairing",this.version="0.3",this.events=new(I()),this.initialized=!1,this.storagePrefix=e6,this.ignoredPayloadTypes=[W.rV],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();let i=(0,W.jd)(),r=await this.core.crypto.setSymKey(i),o=(0,W.gn)($.FIVE_MINUTES),c={protocol:"irn"},l=(0,W.Bv)({protocol:this.core.protocol,version:this.core.version,topic:r,symKey:i,relay:c});return await this.pairings.set(r,{topic:r,expiry:o,relay:c,active:!1}),await this.core.relayer.subscribe(r),this.core.expirer.set(r,o),{topic:r,uri:l}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);let{topic:r,symKey:o,relay:c}=(0,W.he)(i.uri);if(this.pairings.keys.includes(r)&&this.pairings.get(r).active)throw Error(`Pairing already exists: ${r}. Please try again with a new connection URI.`);this.core.crypto.keychain.has(r)||(await this.core.crypto.setSymKey(o,r),await this.core.relayer.subscribe(r,{relay:c}));let l=(0,W.gn)($.FIVE_MINUTES),f={topic:r,relay:c,expiry:l,active:!1};return await this.pairings.set(r,f),this.core.expirer.set(r,l),i.activatePairing&&await this.activate({topic:r}),this.events.emit(tl.create,f),f},this.activate=async({topic:i})=>{this.isInitialized();let r=(0,W.gn)($.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:r}),this.core.expirer.set(i,r)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);let{topic:r}=i;if(this.pairings.keys.includes(r)){let i=await this.sendRequest(r,"wc_pairingPing",{}),{done:o,resolve:c,reject:l}=(0,W.H1)();this.events.once((0,W.E0)("pairing_ping",i),({error:i})=>{i?l(i):c()}),await o()}},this.updateExpiry=async({topic:i,expiry:r})=>{this.isInitialized(),await this.pairings.update(i,{expiry:r})},this.updateMetadata=async({topic:i,metadata:r})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:r})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);let{topic:r}=i;this.pairings.keys.includes(r)&&(await this.sendRequest(r,"wc_pairingDelete",(0,W.D6)("USER_DISCONNECTED")),await this.deletePairing(r))},this.sendRequest=async(i,r,o)=>{let c=formatJsonRpcRequest(r,o),l=await this.core.crypto.encode(i,c),f=tc[r].req;return this.core.history.set(i,c),this.core.relayer.publish(i,l,f),c.id},this.sendResult=async(i,r,o)=>{let c=formatJsonRpcResult(i,o),l=await this.core.crypto.encode(r,c),f=await this.core.history.get(r,i),m=tc[f.request.method].res;await this.core.relayer.publish(r,l,m),await this.core.history.resolve(c)},this.sendError=async(i,r,o)=>{let c=formatJsonRpcError(i,o),l=await this.core.crypto.encode(r,c),f=await this.core.history.get(r,i),m=tc[f.request.method]?tc[f.request.method].res:tc.unregistered_method.res;await this.core.relayer.publish(r,l,m),await this.core.history.resolve(c)},this.deletePairing=async(i,r)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,(0,W.D6)("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),r?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{let i=this.pairings.getAll().filter(i=>(0,W.Bw)(i.expiry));await Promise.all(i.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=i=>{let{topic:r,payload:o}=i;switch(o.method){case"wc_pairingPing":return this.onPairingPingRequest(r,o);case"wc_pairingDelete":return this.onPairingDeleteRequest(r,o);default:return this.onUnknownRpcMethodRequest(r,o)}},this.onRelayEventResponse=async i=>{let{topic:r,payload:o}=i,c=(await this.core.history.get(r,o.id)).request.method;return"wc_pairingPing"===c?this.onPairingPingResponse(r,o):this.onUnknownRpcMethodResponse(c)},this.onPairingPingRequest=async(i,r)=>{let{id:o}=r;try{this.isValidPing({topic:i}),await this.sendResult(o,i,!0),this.events.emit(tl.ping,{id:o,topic:i})}catch(r){await this.sendError(o,i,r),this.logger.error(r)}},this.onPairingPingResponse=(i,r)=>{let{id:o}=r;setTimeout(()=>{isJsonRpcResult(r)?this.events.emit((0,W.E0)("pairing_ping",o),{}):isJsonRpcError(r)&&this.events.emit((0,W.E0)("pairing_ping",o),{error:r.error})},500)},this.onPairingDeleteRequest=async(i,r)=>{let{id:o}=r;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit(tl.delete,{id:o,topic:i})}catch(r){await this.sendError(o,i,r),this.logger.error(r)}},this.onUnknownRpcMethodRequest=async(i,r)=>{let{id:o,method:c}=r;try{if(this.registeredMethods.includes(c))return;let r=(0,W.D6)("WC_METHOD_UNSUPPORTED",c);await this.sendError(o,i,r),this.logger.error(r)}catch(r){await this.sendError(o,i,r),this.logger.error(r)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error((0,W.D6)("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!(0,W.EJ)(i)){let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`pair() params: ${i}`);throw Error(r)}if(!(0,W.jv)(i.uri)){let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw Error(r)}},this.isValidPing=async i=>{if(!(0,W.EJ)(i)){let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`ping() params: ${i}`);throw Error(r)}let{topic:r}=i;await this.isValidPairingTopic(r)},this.isValidDisconnect=async i=>{if(!(0,W.EJ)(i)){let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw Error(r)}let{topic:r}=i;await this.isValidPairingTopic(r)},this.isValidPairingTopic=async i=>{if(!(0,W.M_)(i,!1)){let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw Error(r)}if(!this.pairings.keys.includes(i)){let{message:r}=(0,W.Z7)("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw Error(r)}if((0,W.Bw)(this.pairings.get(i).expiry)){await this.deletePairing(i);let{message:r}=(0,W.Z7)("EXPIRED",`pairing topic: ${i}`);throw Error(r)}},this.core=i,this.logger=(0,L.generateChildLogger)(r,this.name),this.pairings=new $t(this.core,this.logger,this.name,this.storagePrefix)}get context(){return(0,L.getLoggerContext)(this.logger)}isInitialized(){if(!this.initialized){let{message:i}=(0,W.Z7)("NOT_INITIALIZED",this.name);throw Error(i)}}registerRelayerEvents(){this.core.relayer.on(ti.message,async i=>{let{topic:r,message:o}=i;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(o)))return;let c=await this.core.crypto.decode(r,o);try{isJsonRpcRequest(c)?(this.core.history.set(r,c),this.onRelayEventRequest({topic:r,payload:c})):isJsonRpcResponse(c)&&(await this.core.history.resolve(c),await this.onRelayEventResponse({topic:r,payload:c}),this.core.history.delete(r,c.id))}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(tu.expired,async i=>{let{topic:r}=(0,W.iP)(i.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(tl.expire,{topic:r}))})}};let kt=class kt extends index_es_h{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.records=new Map,this.events=new E.EventEmitter,this.name="history",this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=e6,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,r,o)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:r,chainId:o}),this.records.has(r.id))return;let c={id:r.id,topic:i,request:{method:r.method,params:r.params||null},chainId:o,expiry:(0,W.gn)($.THIRTY_DAYS)};this.records.set(c.id,c),this.events.emit(th.created,c)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;let r=await this.getRecord(i.id);typeof r.response>"u"&&(r.response=isJsonRpcError(i)?{error:i.error}:{result:i.result},this.records.set(r.id,r),this.events.emit(th.updated,r))},this.get=async(i,r)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:r}),await this.getRecord(r)),this.delete=(i,r)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:r}),this.values.forEach(o=>{o.topic!==i||"u">typeof r&&o.id!==r||(this.records.delete(o.id),this.events.emit(th.deleted,o))})},this.exists=async(i,r)=>(this.isInitialized(),!!this.records.has(r)&&(await this.getRecord(r)).topic===i),this.on=(i,r)=>{this.events.on(i,r)},this.once=(i,r)=>{this.events.once(i,r)},this.off=(i,r)=>{this.events.off(i,r)},this.removeListener=(i,r)=>{this.events.removeListener(i,r)},this.logger=(0,L.generateChildLogger)(r,this.name)}get context(){return(0,L.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let i=[];return this.values.forEach(r=>{if("u">typeof r.response)return;let o={topic:r.topic,request:formatJsonRpcRequest(r.request.method,r.request.params,r.id),chainId:r.chainId};return i.push(o)}),i}async setJsonRpcRecords(i){await this.core.storage.setItem(this.storageKey,i)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(i){this.isInitialized();let r=this.records.get(i);if(!r){let{message:r}=(0,W.Z7)("NO_MATCHING_KEY",`${this.name}: ${i}`);throw Error(r)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(th.sync)}async restore(){try{let i=await this.getJsonRpcRecords();if(typeof i>"u"||!i.length)return;if(this.records.size){let{message:i}=(0,W.Z7)("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),Error(i)}this.cached=i,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}}registerEventListeners(){this.events.on(th.created,i=>{let r=th.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(th.updated,i=>{let r=th.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(th.deleted,i=>{let r=th.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.core.heartbeat.on(D.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(i=>{(0,$.toMiliseconds)(i.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${i.id}`),this.delete(i.topic,i.id))})}catch(i){this.logger.warn(i)}}isInitialized(){if(!this.initialized){let{message:i}=(0,W.Z7)("NOT_INITIALIZED",this.name);throw Error(i)}}};let Kt=class Kt extends index_es_E{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.expirations=new Map,this.events=new E.EventEmitter,this.name="expirer",this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=e6,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{let r=this.formatTarget(i);return"u">typeof this.getExpiration(r)}catch{return!1}},this.set=(i,r)=>{this.isInitialized();let o=this.formatTarget(i),c={target:o,expiry:r};this.expirations.set(o,c),this.checkExpiry(o,c),this.events.emit(tu.created,{target:o,expiration:c})},this.get=i=>{this.isInitialized();let r=this.formatTarget(i);return this.getExpiration(r)},this.del=i=>{if(this.isInitialized(),this.has(i)){let r=this.formatTarget(i),o=this.getExpiration(r);this.expirations.delete(r),this.events.emit(tu.deleted,{target:r,expiration:o})}},this.on=(i,r)=>{this.events.on(i,r)},this.once=(i,r)=>{this.events.once(i,r)},this.off=(i,r)=>{this.events.off(i,r)},this.removeListener=(i,r)=>{this.events.removeListener(i,r)},this.logger=(0,L.generateChildLogger)(r,this.name)}get context(){return(0,L.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(i){if("string"==typeof i)return(0,W.Z4)(i);if("number"==typeof i)return(0,W.Gq)(i);let{message:r}=(0,W.Z7)("UNKNOWN_TYPE",`Target type: ${typeof i}`);throw Error(r)}async setExpirations(i){await this.core.storage.setItem(this.storageKey,i)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(tu.sync)}async restore(){try{let i=await this.getExpirations();if(typeof i>"u"||!i.length)return;if(this.expirations.size){let{message:i}=(0,W.Z7)("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),Error(i)}this.cached=i,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(i){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(i)}}getExpiration(i){let r=this.expirations.get(i);if(!r){let{message:r}=(0,W.Z7)("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(r),Error(r)}return r}checkExpiry(i,r){let{expiry:o}=r;(0,$.toMiliseconds)(o)-Date.now()<=0&&this.expire(i,r)}expire(i,r){this.expirations.delete(i),this.events.emit(tu.expired,{target:i,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((i,r)=>this.checkExpiry(r,i))}registerEventListeners(){this.core.heartbeat.on(D.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(tu.created,i=>{let r=tu.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(tu.expired,i=>{let r=tu.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(tu.deleted,i=>{let r=tu.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()})}isInitialized(){if(!this.initialized){let{message:i}=(0,W.Z7)("NOT_INITIALIZED",this.name);throw Error(i)}}};let Bt=class Bt extends index_es_y{constructor(i,r){super(i,r),this.projectId=i,this.logger=r,this.name=td,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async i=>{if(this.verifyDisabled||(0,W.b$)()||!(0,W.jU)())return;let r=this.getVerifyUrl(i?.verifyUrl);this.verifyUrl!==r&&this.removeIframe(),this.verifyUrl=r;try{await this.createIframe()}catch(i){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(i)}if(!this.initialized){this.removeIframe(),this.verifyUrl=tg;try{await this.createIframe()}catch(i){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(i),this.verifyDisabled=!0}}},this.register=async i=>{this.initialized?this.sendPost(i.attestationId):(this.addToQueue(i.attestationId),await this.init())},this.resolve=async i=>{let r;if(this.isDevEnv)return"";let o=this.getVerifyUrl(i?.verifyUrl);try{r=await this.fetchAttestation(i.attestationId,o)}catch(c){this.logger.info(`failed to resolve attestation: ${i.attestationId} from url: ${o}`),this.logger.info(c),r=await this.fetchAttestation(i.attestationId,tg)}return r},this.fetchAttestation=async(i,r)=>{this.logger.info(`resolving attestation: ${i} from url: ${r}`);let o=this.startAbortTimer(2*$.ONE_SECOND),c=await fetch(`${r}/attestation/${i}`,{signal:this.abortController.signal});return clearTimeout(o),200===c.status?await c.json():void 0},this.addToQueue=i=>{this.queue.push(i)},this.processQueue=()=>{0!==this.queue.length&&(this.queue.forEach(i=>this.sendPost(i)),this.queue=[])},this.sendPost=i=>{var r;try{if(!this.iframe)return;null==(r=this.iframe.contentWindow)||r.postMessage(i,"*"),this.logger.info(`postMessage sent: ${i} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let i;let s=r=>{"verify_ready"===r.data&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",s),i())};await Promise.race([new Promise(r=>{if(document.getElementById(td))return r();window.addEventListener("message",s);let o=document.createElement("iframe");o.id=td,o.src=`${this.verifyUrl}/${this.projectId}`,o.style.display="none",document.body.append(o),this.iframe=o,i=r}),new Promise((i,r)=>setTimeout(()=>{window.removeEventListener("message",s),r("verify iframe load timeout")},(0,$.toMiliseconds)($.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=i=>{let r=i||tp;return tf.includes(r)||(this.logger.info(`verify url: ${r}, not included in trusted list, assigning default: ${tp}`),r=tp),r},this.logger=(0,L.generateChildLogger)(r,this.name),this.verifyUrl=tp,this.abortController=new AbortController,this.isDevEnv=(0,W.UG)()&&el.env.IS_VITEST}get context(){return(0,L.getLoggerContext)(this.logger)}startAbortTimer(i){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,$.toMiliseconds)(i))}};var tC=Object.defineProperty,tT=Object.getOwnPropertySymbols,tA=Object.prototype.hasOwnProperty,tD=Object.prototype.propertyIsEnumerable,qt=(i,r,o)=>r in i?tC(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,jt=(i,r)=>{for(var o in r||(r={}))tA.call(r,o)&&qt(i,o,r[o]);if(tT)for(var o of tT(r))tD.call(r,o)&&qt(i,o,r[o]);return i};let te=class te extends n{constructor(i){super(i),this.protocol="wc",this.version=2,this.name=e5,this.events=new E.EventEmitter,this.initialized=!1,this.on=(i,r)=>this.events.on(i,r),this.once=(i,r)=>this.events.once(i,r),this.off=(i,r)=>this.events.off(i,r),this.removeListener=(i,r)=>this.events.removeListener(i,r),this.projectId=i?.projectId,this.relayUrl=i?.relayUrl||e9,this.customStoragePrefix=null!=i&&i.customStoragePrefix?`:${i.customStoragePrefix}`:"";let r="u">typeof i?.logger&&"string"!=typeof i?.logger?i.logger:(0,L.pino)((0,L.getDefaultLoggerOptions)({level:i?.logger||e3.logger}));this.logger=(0,L.generateChildLogger)(r,this.name),this.heartbeat=new D.HeartBeat,this.crypto=new St(this,this.logger,i?.keychain),this.history=new kt(this,this.logger),this.expirer=new Kt(this,this.logger),this.storage=null!=i&&i.storage?i.storage:new h(jt(jt({},e2),i?.storageOptions)),this.relayer=new Nt({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Mt(this,this.logger),this.verify=new Bt(this.projectId||"",this.logger)}static async init(i){let r=new te(i);await r.initialize();let o=await r.crypto.getClientId();return await r.storage.setItem("WALLETCONNECT_CLIENT_ID",o),r}get context(){return(0,L.getLoggerContext)(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(i){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,i),this.logger.error(i.message),i}}};let tL="client",tq=`wc@2:${tL}:`,tM={name:tL,logger:"error"},tz="WALLETCONNECT_DEEPLINK_CHOICE",tk=$.SEVEN_DAYS,tj={wc_sessionPropose:{req:{ttl:$.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:$.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:$.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:$.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:$.ONE_DAY,prompt:!1,tag:1104},res:{ttl:$.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:$.ONE_DAY,prompt:!1,tag:1106},res:{ttl:$.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:$.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:$.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:$.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:$.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:$.ONE_DAY,prompt:!1,tag:1112},res:{ttl:$.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:$.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:$.THIRTY_SECONDS,prompt:!1,tag:1115}}},tV={min:$.FIVE_MINUTES,max:$.SEVEN_DAYS},tU={idle:"IDLE",active:"ACTIVE"},tK=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var t$=Object.defineProperty,tB=Object.defineProperties,tH=Object.getOwnPropertyDescriptors,tJ=Object.getOwnPropertySymbols,tG=Object.prototype.hasOwnProperty,tF=Object.prototype.propertyIsEnumerable,index_es_de=(i,r,o)=>r in i?t$(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,dist_index_es_g=(i,r)=>{for(var o in r||(r={}))tG.call(r,o)&&index_es_de(i,o,r[o]);if(tJ)for(var o of tJ(r))tF.call(r,o)&&index_es_de(i,o,r[o]);return i},index_es_b=(i,r)=>tB(i,tH(r));let index_es_ps=class index_es_ps extends S{constructor(i){super(i),this.name="engine",this.events=new(I()),this.initialized=!1,this.ignoredPayloadTypes=[W.rV],this.requestQueue={state:tU.idle,queue:[]},this.sessionRequestQueue={state:tU.idle,queue:[]},this.requestQueueDelay=$.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(tj)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,$.toMiliseconds)(this.requestQueueDelay)))},this.connect=async i=>{await this.isInitialized();let r=index_es_b(dist_index_es_g({},i),{requiredNamespaces:i.requiredNamespaces||{},optionalNamespaces:i.optionalNamespaces||{}});await this.isValidConnect(r);let{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:l,sessionProperties:f,relays:m}=r,v=o,w,E=!1;if(v&&(E=this.client.core.pairing.pairings.get(v).active),!v||!E){let{topic:i,uri:r}=await this.client.core.pairing.create();v=i,w=r}let I=await this.client.core.crypto.generateKeyPair(),P=dist_index_es_g({requiredNamespaces:c,optionalNamespaces:l,relays:m??[{protocol:"irn"}],proposer:{publicKey:I,metadata:this.client.metadata}},f&&{sessionProperties:f}),{reject:R,resolve:x,done:N}=(0,W.H1)($.FIVE_MINUTES,"Proposal expired");if(this.events.once((0,W.E0)("session_connect"),async({error:i,session:r})=>{if(i)R(i);else if(r){r.self.publicKey=I;let i=index_es_b(dist_index_es_g({},r),{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces});await this.client.session.set(r.topic,i),await this.setExpiry(r.topic,r.expiry),v&&await this.client.core.pairing.updateMetadata({topic:v,metadata:r.peer.metadata}),x(i)}}),!v){let{message:i}=(0,W.Z7)("NO_MATCHING_KEY",`connect() pairing topic: ${v}`);throw Error(i)}let C=await this.sendRequest({topic:v,method:"wc_sessionPropose",params:P}),T=(0,W.gn)($.FIVE_MINUTES);return await this.setProposal(C,dist_index_es_g({id:C,expiry:T},P)),{uri:w,approval:N}},this.pair=async i=>(await this.isInitialized(),await this.client.core.pairing.pair(i)),this.approve=async i=>{await this.isInitialized(),await this.isValidApprove(i);let{id:r,relayProtocol:o,namespaces:c,sessionProperties:l}=i,f=this.client.proposal.get(r),{pairingTopic:m,proposer:v,requiredNamespaces:w,optionalNamespaces:E}=f;m=m||"",(0,W.L5)(w)||(w=(0,W.fc)(c,"approve()"));let I=await this.client.core.crypto.generateKeyPair(),P=v.publicKey,R=await this.client.core.crypto.generateSharedKey(I,P);m&&r&&(await this.client.core.pairing.updateMetadata({topic:m,metadata:v.metadata}),await this.sendResult({id:r,topic:m,result:{relay:{protocol:o??"irn"},responderPublicKey:I}}),await this.client.proposal.delete(r,(0,W.D6)("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:m}));let x=dist_index_es_g({relay:{protocol:o??"irn"},namespaces:c,requiredNamespaces:w,optionalNamespaces:E,pairingTopic:m,controller:{publicKey:I,metadata:this.client.metadata},expiry:(0,W.gn)(tk)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(R),await this.sendRequest({topic:R,method:"wc_sessionSettle",params:x,throwOnFailedPublish:!0});let N=index_es_b(dist_index_es_g({},x),{topic:R,pairingTopic:m,acknowledged:!1,self:x.controller,peer:{publicKey:v.publicKey,metadata:v.metadata},controller:I});return await this.client.session.set(R,N),await this.setExpiry(R,(0,W.gn)(tk)),{topic:R,acknowledged:()=>new Promise(i=>setTimeout(()=>i(this.client.session.get(R)),500))}},this.reject=async i=>{await this.isInitialized(),await this.isValidReject(i);let{id:r,reason:o}=i,{pairingTopic:c}=this.client.proposal.get(r);c&&(await this.sendError(r,c,o),await this.client.proposal.delete(r,(0,W.D6)("USER_DISCONNECTED")))},this.update=async i=>{await this.isInitialized(),await this.isValidUpdate(i);let{topic:r,namespaces:o}=i,c=await this.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:l,resolve:f,reject:m}=(0,W.H1)();return this.events.once((0,W.E0)("session_update",c),({error:i})=>{i?m(i):f()}),await this.client.session.update(r,{namespaces:o}),{acknowledged:l}},this.extend=async i=>{await this.isInitialized(),await this.isValidExtend(i);let{topic:r}=i,o=await this.sendRequest({topic:r,method:"wc_sessionExtend",params:{}}),{done:c,resolve:l,reject:f}=(0,W.H1)();return this.events.once((0,W.E0)("session_extend",o),({error:i})=>{i?f(i):l()}),await this.setExpiry(r,(0,W.gn)(tk)),{acknowledged:c}},this.request=async i=>{await this.isInitialized(),await this.isValidRequest(i);let{chainId:r,request:o,topic:c,expiry:l}=i,f=payloadId(),{done:m,resolve:v,reject:w}=(0,W.H1)(l,"Request expired. Please try again.");return this.events.once((0,W.E0)("session_request",f),({error:i,result:r})=>{i?w(i):v(r)}),await Promise.all([new Promise(async i=>{await this.sendRequest({clientRpcId:f,topic:c,method:"wc_sessionRequest",params:{request:o,chainId:r},expiry:l,throwOnFailedPublish:!0}).catch(i=>w(i)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:r,id:f}),i()}),new Promise(async i=>{let r=await this.client.core.storage.getItem(tz);(0,W.Hh)({id:f,topic:c,wcDeepLink:r}),i()}),m()]).then(i=>i[2])},this.respond=async i=>{await this.isInitialized(),await this.isValidRespond(i);let{topic:r,response:o}=i,{id:c}=o;isJsonRpcResult(o)?await this.sendResult({id:c,topic:r,result:o.result,throwOnFailedPublish:!0}):isJsonRpcError(o)&&await this.sendError(c,r,o.error),this.cleanupAfterResponse(i)},this.ping=async i=>{await this.isInitialized(),await this.isValidPing(i);let{topic:r}=i;if(this.client.session.keys.includes(r)){let i=await this.sendRequest({topic:r,method:"wc_sessionPing",params:{}}),{done:o,resolve:c,reject:l}=(0,W.H1)();this.events.once((0,W.E0)("session_ping",i),({error:i})=>{i?l(i):c()}),await o()}else this.client.core.pairing.pairings.keys.includes(r)&&await this.client.core.pairing.ping({topic:r})},this.emit=async i=>{await this.isInitialized(),await this.isValidEmit(i);let{topic:r,event:o,chainId:c}=i;await this.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async i=>{await this.isInitialized(),await this.isValidDisconnect(i);let{topic:r}=i;this.client.session.keys.includes(r)?(await this.sendRequest({topic:r,method:"wc_sessionDelete",params:(0,W.D6)("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(r)):await this.client.core.pairing.disconnect({topic:r})},this.find=i=>(this.isInitialized(),this.client.session.getAll().filter(r=>(0,W.Ih)(r,i))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async i=>{if(i.pairingTopic)try{let r=this.client.core.pairing.pairings.get(i.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(o=>{var c,l;return(null==(c=o.peerMetadata)?void 0:c.url)&&(null==(l=o.peerMetadata)?void 0:l.url)===i.peer.metadata.url&&o.topic&&o.topic!==r.topic});if(0===o.length)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}},this.deleteSession=async(i,r)=>{let{self:o}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),this.client.session.delete(i,(0,W.D6)("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),r||this.client.core.expirer.del(i),this.client.core.storage.removeItem(tz).catch(i=>this.client.logger.warn(i))},this.deleteProposal=async(i,r)=>{await Promise.all([this.client.proposal.delete(i,(0,W.D6)("USER_DISCONNECTED")),r?Promise.resolve():this.client.core.expirer.del(i)])},this.deletePendingSessionRequest=async(i,r,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(i,r),o?Promise.resolve():this.client.core.expirer.del(i)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(r=>r.id!==i),o&&(this.sessionRequestQueue.state=tU.idle)},this.setExpiry=async(i,r)=>{this.client.session.keys.includes(i)&&await this.client.session.update(i,{expiry:r}),this.client.core.expirer.set(i,r)},this.setProposal=async(i,r)=>{await this.client.proposal.set(i,r),this.client.core.expirer.set(i,r.expiry)},this.setPendingSessionRequest=async i=>{let r=tj.wc_sessionRequest.req.ttl,{id:o,topic:c,params:l,verifyContext:f}=i;await this.client.pendingRequest.set(o,{id:o,topic:c,params:l,verifyContext:f}),r&&this.client.core.expirer.set(o,(0,W.gn)(r))},this.sendRequest=async i=>{let{topic:r,method:o,params:c,expiry:l,relayRpcId:f,clientRpcId:m,throwOnFailedPublish:v}=i,w=formatJsonRpcRequest(o,c,m);if((0,W.jU)()&&tK.includes(o)){let i=(0,W.rj)(JSON.stringify(w));this.client.core.verify.register({attestationId:i})}let E=await this.client.core.crypto.encode(r,w),I=tj[o].req;return l&&(I.ttl=l),f&&(I.id=f),this.client.core.history.set(r,w),v?(I.internal=index_es_b(dist_index_es_g({},I.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,E,I)):this.client.core.relayer.publish(r,E,I).catch(i=>this.client.logger.error(i)),w.id},this.sendResult=async i=>{let{id:r,topic:o,result:c,throwOnFailedPublish:l}=i,f=formatJsonRpcResult(r,c),m=await this.client.core.crypto.encode(o,f),v=await this.client.core.history.get(o,r),w=tj[v.request.method].res;l?(w.internal=index_es_b(dist_index_es_g({},w.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,m,w)):this.client.core.relayer.publish(o,m,w).catch(i=>this.client.logger.error(i)),await this.client.core.history.resolve(f)},this.sendError=async(i,r,o)=>{let c=formatJsonRpcError(i,o),l=await this.client.core.crypto.encode(r,c),f=await this.client.core.history.get(r,i),m=tj[f.request.method].res;this.client.core.relayer.publish(r,l,m),await this.client.core.history.resolve(c)},this.cleanup=async()=>{let i=[],r=[];this.client.session.getAll().forEach(r=>{(0,W.Bw)(r.expiry)&&i.push(r.topic)}),this.client.proposal.getAll().forEach(i=>{(0,W.Bw)(i.expiry)&&r.push(i.id)}),await Promise.all([...i.map(i=>this.deleteSession(i)),...r.map(i=>this.deleteProposal(i))])},this.onRelayEventRequest=async i=>{this.requestQueue.queue.push(i),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===tU.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=tU.active;let i=this.requestQueue.queue.shift();if(i)try{this.processRequest(i),await new Promise(i=>setTimeout(i,300))}catch(i){this.client.logger.warn(i)}}this.requestQueue.state=tU.idle},this.processRequest=i=>{let{topic:r,payload:o}=i,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(r,o);case"wc_sessionSettle":return this.onSessionSettleRequest(r,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(r,o);case"wc_sessionExtend":return this.onSessionExtendRequest(r,o);case"wc_sessionPing":return this.onSessionPingRequest(r,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(r,o);case"wc_sessionRequest":return this.onSessionRequest(r,o);case"wc_sessionEvent":return this.onSessionEventRequest(r,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async i=>{let{topic:r,payload:o}=i,c=(await this.client.core.history.get(r,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(r,o);case"wc_sessionSettle":return this.onSessionSettleResponse(r,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(r,o);case"wc_sessionExtend":return this.onSessionExtendResponse(r,o);case"wc_sessionPing":return this.onSessionPingResponse(r,o);case"wc_sessionRequest":return this.onSessionRequestResponse(r,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=i=>{let{topic:r}=i,{message:o}=(0,W.Z7)("MISSING_OR_INVALID",`Decoded payload on topic ${r} is not identifiable as a JSON-RPC request or a response.`);throw Error(o)},this.onSessionProposeRequest=async(i,r)=>{let{params:o,id:c}=r;try{this.isValidConnect(dist_index_es_g({},r.params));let l=(0,W.gn)($.FIVE_MINUTES),f=dist_index_es_g({id:c,pairingTopic:i,expiry:l},o);await this.setProposal(c,f);let m=(0,W.rj)(JSON.stringify(r)),v=await this.getVerifyContext(m,f.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:v})}catch(r){await this.sendError(c,i,r),this.client.logger.error(r)}},this.onSessionProposeResponse=async(i,r)=>{let{id:o}=r;if(isJsonRpcResult(r)){let{result:c}=r;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});let l=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});let f=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});let m=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:m});let v=await this.client.core.crypto.generateSharedKey(f,m);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:v});let w=await this.client.core.relayer.subscribe(v);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:w}),await this.client.core.pairing.activate({topic:i})}else isJsonRpcError(r)&&(await this.client.proposal.delete(o,(0,W.D6)("USER_DISCONNECTED")),this.events.emit((0,W.E0)("session_connect"),{error:r.error}))},this.onSessionSettleRequest=async(i,r)=>{let{id:o,params:c}=r;try{this.isValidSessionSettleRequest(c);let{relay:o,controller:l,expiry:f,namespaces:m,requiredNamespaces:v,optionalNamespaces:w,sessionProperties:E,pairingTopic:I}=r.params,P=dist_index_es_g({topic:i,relay:o,expiry:f,namespaces:m,acknowledged:!0,pairingTopic:I,requiredNamespaces:v,optionalNamespaces:w,controller:l.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:l.publicKey,metadata:l.metadata}},E&&{sessionProperties:E});await this.sendResult({id:r.id,topic:i,result:!0}),this.events.emit((0,W.E0)("session_connect"),{session:P}),this.cleanupDuplicatePairings(P)}catch(r){await this.sendError(o,i,r),this.client.logger.error(r)}},this.onSessionSettleResponse=async(i,r)=>{let{id:o}=r;isJsonRpcResult(r)?(await this.client.session.update(i,{acknowledged:!0}),this.events.emit((0,W.E0)("session_approve",o),{})):isJsonRpcError(r)&&(await this.client.session.delete(i,(0,W.D6)("USER_DISCONNECTED")),this.events.emit((0,W.E0)("session_approve",o),{error:r.error}))},this.onSessionUpdateRequest=async(i,r)=>{let{params:o,id:c}=r;try{let r=`${i}_session_update`,l=W.O6.get(r);if(l&&this.isRequestOutOfSync(l,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(dist_index_es_g({topic:i},o)),await this.client.session.update(i,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:i,result:!0}),this.client.events.emit("session_update",{id:c,topic:i,params:o}),W.O6.set(r,c)}catch(r){await this.sendError(c,i,r),this.client.logger.error(r)}},this.isRequestOutOfSync=(i,r)=>parseInt(r.toString().slice(0,-3))<=parseInt(i.toString().slice(0,-3)),this.onSessionUpdateResponse=(i,r)=>{let{id:o}=r;isJsonRpcResult(r)?this.events.emit((0,W.E0)("session_update",o),{}):isJsonRpcError(r)&&this.events.emit((0,W.E0)("session_update",o),{error:r.error})},this.onSessionExtendRequest=async(i,r)=>{let{id:o}=r;try{this.isValidExtend({topic:i}),await this.setExpiry(i,(0,W.gn)(tk)),await this.sendResult({id:o,topic:i,result:!0}),this.client.events.emit("session_extend",{id:o,topic:i})}catch(r){await this.sendError(o,i,r),this.client.logger.error(r)}},this.onSessionExtendResponse=(i,r)=>{let{id:o}=r;isJsonRpcResult(r)?this.events.emit((0,W.E0)("session_extend",o),{}):isJsonRpcError(r)&&this.events.emit((0,W.E0)("session_extend",o),{error:r.error})},this.onSessionPingRequest=async(i,r)=>{let{id:o}=r;try{this.isValidPing({topic:i}),await this.sendResult({id:o,topic:i,result:!0}),this.client.events.emit("session_ping",{id:o,topic:i})}catch(r){await this.sendError(o,i,r),this.client.logger.error(r)}},this.onSessionPingResponse=(i,r)=>{let{id:o}=r;setTimeout(()=>{isJsonRpcResult(r)?this.events.emit((0,W.E0)("session_ping",o),{}):isJsonRpcError(r)&&this.events.emit((0,W.E0)("session_ping",o),{error:r.error})},500)},this.onSessionDeleteRequest=async(i,r)=>{let{id:o}=r;try{this.isValidDisconnect({topic:i,reason:r.params}),await Promise.all([new Promise(r=>{this.client.core.relayer.once(ti.publish,async()=>{r(await this.deleteSession(i))})}),this.sendResult({id:o,topic:i,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:i})}catch(i){this.client.logger.error(i)}},this.onSessionRequest=async(i,r)=>{let{id:o,params:c}=r;try{this.isValidRequest(dist_index_es_g({topic:i},c));let r=(0,W.rj)(JSON.stringify(formatJsonRpcRequest("wc_sessionRequest",c,o))),l=this.client.session.get(i),f=await this.getVerifyContext(r,l.peer.metadata),m={id:o,topic:i,params:c,verifyContext:f};await this.setPendingSessionRequest(m),this.addSessionRequestToSessionRequestQueue(m),this.processSessionRequestQueue()}catch(r){await this.sendError(o,i,r),this.client.logger.error(r)}},this.onSessionRequestResponse=(i,r)=>{let{id:o}=r;isJsonRpcResult(r)?this.events.emit((0,W.E0)("session_request",o),{result:r.result}):isJsonRpcError(r)&&this.events.emit((0,W.E0)("session_request",o),{error:r.error})},this.onSessionEventRequest=async(i,r)=>{let{id:o,params:c}=r;try{let r=`${i}_session_event_${c.event.name}`,l=W.O6.get(r);if(l&&this.isRequestOutOfSync(l,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(dist_index_es_g({topic:i},c)),this.client.events.emit("session_event",{id:o,topic:i,params:c}),W.O6.set(r,o)}catch(r){await this.sendError(o,i,r),this.client.logger.error(r)}},this.addSessionRequestToSessionRequestQueue=i=>{this.sessionRequestQueue.queue.push(i)},this.cleanupAfterResponse=i=>{this.deletePendingSessionRequest(i.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=tU.idle,this.processSessionRequestQueue()},(0,$.toMiliseconds)(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===tU.active){this.client.logger.info("session request queue is already active.");return}let i=this.sessionRequestQueue.queue[0];if(!i){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=tU.active,this.client.events.emit("session_request",i)}catch(i){this.client.logger.error(i)}},this.onPairingCreated=i=>{if(i.active)return;let r=this.client.proposal.getAll().find(r=>r.pairingTopic===i.topic);r&&this.onSessionProposeRequest(i.topic,formatJsonRpcRequest("wc_sessionPropose",{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces,relays:r.relays,proposer:r.proposer},r.id))},this.isValidConnect=async i=>{if(!(0,W.EJ)(i)){let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(i)}`);throw Error(r)}let{pairingTopic:r,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:l,relays:f}=i;if((0,W.o8)(r)||await this.isValidPairingTopic(r),!(0,W.PM)(f,!0)){let{message:i}=(0,W.Z7)("MISSING_OR_INVALID",`connect() relays: ${f}`);throw Error(i)}(0,W.o8)(o)||0===(0,W.L5)(o)||this.validateNamespaces(o,"requiredNamespaces"),(0,W.o8)(c)||0===(0,W.L5)(c)||this.validateNamespaces(c,"optionalNamespaces"),(0,W.o8)(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(i,r)=>{let o=(0,W.n)(i,"connect()",r);if(o)throw Error(o.message)},this.isValidApprove=async i=>{if(!(0,W.EJ)(i))throw Error((0,W.Z7)("MISSING_OR_INVALID",`approve() params: ${i}`).message);let{id:r,namespaces:o,relayProtocol:c,sessionProperties:l}=i;await this.isValidProposalId(r);let f=this.client.proposal.get(r),m=(0,W.in)(o,"approve()");if(m)throw Error(m.message);let v=(0,W.rF)(f.requiredNamespaces,o,"approve()");if(v)throw Error(v.message);if(!(0,W.M_)(c,!0)){let{message:i}=(0,W.Z7)("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw Error(i)}(0,W.o8)(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async i=>{if(!(0,W.EJ)(i)){let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`reject() params: ${i}`);throw Error(r)}let{id:r,reason:o}=i;if(await this.isValidProposalId(r),!(0,W.$t)(o)){let{message:i}=(0,W.Z7)("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw Error(i)}},this.isValidSessionSettleRequest=i=>{if(!(0,W.EJ)(i)){let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${i}`);throw Error(r)}let{relay:r,controller:o,namespaces:c,expiry:l}=i;if(!(0,W.Z2)(r)){let{message:i}=(0,W.Z7)("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw Error(i)}let f=(0,W.Dd)(o,"onSessionSettleRequest()");if(f)throw Error(f.message);let m=(0,W.in)(c,"onSessionSettleRequest()");if(m)throw Error(m.message);if((0,W.Bw)(l)){let{message:i}=(0,W.Z7)("EXPIRED","onSessionSettleRequest()");throw Error(i)}},this.isValidUpdate=async i=>{if(!(0,W.EJ)(i)){let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`update() params: ${i}`);throw Error(r)}let{topic:r,namespaces:o}=i;await this.isValidSessionTopic(r);let c=this.client.session.get(r),l=(0,W.in)(o,"update()");if(l)throw Error(l.message);let f=(0,W.rF)(c.requiredNamespaces,o,"update()");if(f)throw Error(f.message)},this.isValidExtend=async i=>{if(!(0,W.EJ)(i)){let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`extend() params: ${i}`);throw Error(r)}let{topic:r}=i;await this.isValidSessionTopic(r)},this.isValidRequest=async i=>{if(!(0,W.EJ)(i)){let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`request() params: ${i}`);throw Error(r)}let{topic:r,request:o,chainId:c,expiry:l}=i;await this.isValidSessionTopic(r);let{namespaces:f}=this.client.session.get(r);if(!(0,W.p8)(f,c)){let{message:i}=(0,W.Z7)("MISSING_OR_INVALID",`request() chainId: ${c}`);throw Error(i)}if(!(0,W.hH)(o)){let{message:i}=(0,W.Z7)("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw Error(i)}if(!(0,W.al)(f,c,o.method)){let{message:i}=(0,W.Z7)("MISSING_OR_INVALID",`request() method: ${o.method}`);throw Error(i)}if(l&&!(0,W.ON)(l,tV)){let{message:i}=(0,W.Z7)("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${tV.min} and ${tV.max}`);throw Error(i)}},this.isValidRespond=async i=>{if(!(0,W.EJ)(i)){let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`respond() params: ${i}`);throw Error(r)}let{topic:r,response:o}=i;if(await this.isValidSessionTopic(r),!(0,W.JT)(o)){let{message:i}=(0,W.Z7)("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw Error(i)}},this.isValidPing=async i=>{if(!(0,W.EJ)(i)){let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`ping() params: ${i}`);throw Error(r)}let{topic:r}=i;await this.isValidSessionOrPairingTopic(r)},this.isValidEmit=async i=>{if(!(0,W.EJ)(i)){let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`emit() params: ${i}`);throw Error(r)}let{topic:r,event:o,chainId:c}=i;await this.isValidSessionTopic(r);let{namespaces:l}=this.client.session.get(r);if(!(0,W.p8)(l,c)){let{message:i}=(0,W.Z7)("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw Error(i)}if(!(0,W.nf)(o)){let{message:i}=(0,W.Z7)("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw Error(i)}if(!(0,W.sI)(l,c,o.name)){let{message:i}=(0,W.Z7)("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw Error(i)}},this.isValidDisconnect=async i=>{if(!(0,W.EJ)(i)){let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw Error(r)}let{topic:r}=i;await this.isValidSessionOrPairingTopic(r)},this.getVerifyContext=async(i,r)=>{let o={verified:{verifyUrl:r.verifyUrl||tp,validation:"UNKNOWN",origin:r.url||""}};try{let c=await this.client.core.verify.resolve({attestationId:i,verifyUrl:r.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(r.url).origin?"VALID":"INVALID")}catch(i){this.client.logger.info(i)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(i,r)=>{Object.values(i).forEach(i=>{if(!(0,W.M_)(i,!1)){let{message:o}=(0,W.Z7)("MISSING_OR_INVALID",`${r} must be in Record<string, string> format. Received: ${JSON.stringify(i)}`);throw Error(o)}})}}async isInitialized(){if(!this.initialized){let{message:i}=(0,W.Z7)("NOT_INITIALIZED",this.name);throw Error(i)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(ti.message,async i=>{let{topic:r,message:o}=i;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(o)))return;let c=await this.client.core.crypto.decode(r,o);try{isJsonRpcRequest(c)?(this.client.core.history.set(r,c),this.onRelayEventRequest({topic:r,payload:c})):isJsonRpcResponse(c)?(await this.client.core.history.resolve(c),await this.onRelayEventResponse({topic:r,payload:c}),this.client.core.history.delete(r,c.id)):this.onRelayEventUnknownPayload({topic:r,payload:c})}catch(i){this.client.logger.error(i)}})}registerExpirerEvents(){this.client.core.expirer.on(tu.expired,async i=>{let{topic:r,id:o}=(0,W.iP)(i.target);if(o&&this.client.pendingRequest.keys.includes(o))return await this.deletePendingSessionRequest(o,(0,W.Z7)("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):o&&(await this.deleteProposal(o,!0),this.client.events.emit("proposal_expire",{id:o}))})}registerPairingEvents(){this.client.core.pairing.events.on(tl.create,i=>this.onPairingCreated(i))}isValidPairingTopic(i){if(!(0,W.M_)(i,!1)){let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw Error(r)}if(!this.client.core.pairing.pairings.keys.includes(i)){let{message:r}=(0,W.Z7)("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw Error(r)}if((0,W.Bw)(this.client.core.pairing.pairings.get(i).expiry)){let{message:r}=(0,W.Z7)("EXPIRED",`pairing topic: ${i}`);throw Error(r)}}async isValidSessionTopic(i){if(!(0,W.M_)(i,!1)){let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`session topic should be a string: ${i}`);throw Error(r)}if(!this.client.session.keys.includes(i)){let{message:r}=(0,W.Z7)("NO_MATCHING_KEY",`session topic doesn't exist: ${i}`);throw Error(r)}if((0,W.Bw)(this.client.session.get(i).expiry)){await this.deleteSession(i);let{message:r}=(0,W.Z7)("EXPIRED",`session topic: ${i}`);throw Error(r)}}async isValidSessionOrPairingTopic(i){if(this.client.session.keys.includes(i))await this.isValidSessionTopic(i);else if(this.client.core.pairing.pairings.keys.includes(i))this.isValidPairingTopic(i);else if((0,W.M_)(i,!1)){let{message:r}=(0,W.Z7)("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${i}`);throw Error(r)}else{let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`session or pairing topic should be a string: ${i}`);throw Error(r)}}async isValidProposalId(i){if(!(0,W.Q0)(i)){let{message:r}=(0,W.Z7)("MISSING_OR_INVALID",`proposal id should be a number: ${i}`);throw Error(r)}if(!this.client.proposal.keys.includes(i)){let{message:r}=(0,W.Z7)("NO_MATCHING_KEY",`proposal id doesn't exist: ${i}`);throw Error(r)}if((0,W.Bw)(this.client.proposal.get(i).expiry)){await this.deleteProposal(i);let{message:r}=(0,W.Z7)("EXPIRED",`proposal id: ${i}`);throw Error(r)}}};let index_es_hs=class index_es_hs extends $t{constructor(i,r){super(i,r,"proposal",tq),this.core=i,this.logger=r}};let index_es_ds=class index_es_ds extends $t{constructor(i,r){super(i,r,"session",tq),this.core=i,this.logger=r}};let index_es_us=class index_es_us extends $t{constructor(i,r){super(i,r,"request",tq,i=>i.id),this.core=i,this.logger=r}};let index_es_Q=class index_es_Q extends b{constructor(i){super(i),this.protocol="wc",this.version=2,this.name=tM.name,this.events=new E.EventEmitter,this.on=(i,r)=>this.events.on(i,r),this.once=(i,r)=>this.events.once(i,r),this.off=(i,r)=>this.events.off(i,r),this.removeListener=(i,r)=>this.events.removeListener(i,r),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(i){throw this.logger.error(i.message),i}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(i){throw this.logger.error(i.message),i}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(i){throw this.logger.error(i.message),i}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(i){throw this.logger.error(i.message),i}},this.update=async i=>{try{return await this.engine.update(i)}catch(i){throw this.logger.error(i.message),i}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(i){throw this.logger.error(i.message),i}},this.request=async i=>{try{return await this.engine.request(i)}catch(i){throw this.logger.error(i.message),i}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(i){throw this.logger.error(i.message),i}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(i){throw this.logger.error(i.message),i}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(i){throw this.logger.error(i.message),i}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(i){throw this.logger.error(i.message),i}},this.find=i=>{try{return this.engine.find(i)}catch(i){throw this.logger.error(i.message),i}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=i?.name||tM.name,this.metadata=i?.metadata||(0,W.D)();let r="u">typeof i?.logger&&"string"!=typeof i?.logger?i.logger:(0,L.pino)((0,L.getDefaultLoggerOptions)({level:i?.logger||tM.logger}));this.core=i?.core||new te(i),this.logger=(0,L.generateChildLogger)(r,this.name),this.session=new index_es_ds(this.core,this.logger),this.proposal=new index_es_hs(this.core,this.logger),this.pendingRequest=new index_es_us(this.core,this.logger),this.engine=new index_es_ps(this)}static async init(i){let r=new index_es_Q(i);return await r.initialize(),r}get context(){return(0,L.getLoggerContext)(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(i){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(i.message),i}}};var tZ=o(35796),tW=o(94660),tQ=o(72378),tY=o.n(tQ);let tX=[{name:"Rainbow",chains:[m.EN.EIP155],logo:"https://images.web3auth.io/login-rainbow.svg",mobile:{native:"rainbow:",universal:"https://rnbwapp.com"},desktop:{native:"",universal:""}},{name:"MetaMask",chains:[m.EN.EIP155],logo:"https://images.web3auth.io/login-metamask.svg",mobile:{native:"metamask:",universal:"https://metamask.app.link"},desktop:{native:"",universal:""}},{name:"Argent",chains:[m.EN.EIP155],logo:"https://images.web3auth.io/login-argent.svg",mobile:{native:"argent://",universal:"https://www.argent.xyz/app"},desktop:{native:"",universal:""}},{name:"Trust Wallet",chains:[m.EN.EIP155],logo:"https://images.web3auth.io/login-trust.svg",mobile:{native:"trust:",universal:"https://link.trustwallet.com"},desktop:{native:"",universal:""}},{name:"Zerion",chains:[m.EN.EIP155],logo:"https://images.web3auth.io/login-zerion.svg",mobile:{native:"zerion://",universal:"https://wallet.zerion.io"},desktop:{native:"",universal:""}}],t0=((l={}).ETH_SEND_TRANSACTION="eth_sendTransaction",l.ETH_SIGN="eth_sign",l.PERSONAL_SIGN="personal_sign",l.ETH_SIGN_TYPED_DATA="eth_signTypedData",l),t1=((f={}).ETH_CHAIN_CHANGED="chainChanged",f.ETH_ACCOUNTS_CHANGED="accountsChanged",f),getSiteName=i=>{let{document:r}=i,o=r.querySelector('head > meta[property="og:site_name"]');if(o)return o.content;let c=r.querySelector('head > meta[name="title"]');return c?c.content:r.title&&r.title.length>0?r.title:i.location.hostname};function imgExists(i){return new Promise((r,o)=>{try{let o=document.createElement("img");o.onload=()=>r(!0),o.onerror=()=>r(!1),o.src=i}catch(i){o(i)}})}async function getSiteIcon(i){let{document:r}=i,o=r.querySelector('head > link[rel="shortcut icon"]');return o&&await imgExists(o.href)||(o=Array.from(r.querySelectorAll('head > link[rel="icon"]')).find(i=>!!i.href)||null)&&await imgExists(o.href)?o.href:null}let getSiteMetadata=async()=>({name:getSiteName(window),icon:await getSiteIcon(window)}),getNamespacesFromChains=i=>{let r=[];return i.forEach(i=>{let[o]=i.split(":");r.includes(o)||r.push(o)}),r},getSupportedMethodsByNamespace=i=>{if(i===m.EN.EIP155)return Object.values(t0);throw Error(`No default methods for namespace: ${i}`)},getSupportedEventsByNamespace=i=>{if(i===m.EN.EIP155)return Object.values(t1);throw Error(`No default events for namespace: ${i}`)},getRequiredNamespaces=i=>{let r=getNamespacesFromChains(i);return Object.fromEntries(r.map(r=>[r,{methods:getSupportedMethodsByNamespace(r),chains:i.filter(i=>i.startsWith(r)),events:getSupportedEventsByNamespace(r)}]))},getWalletConnectV2Settings=async(i,r,o)=>{if(i===m.EN.EIP155){let c=await getSiteMetadata(),l={walletConnectInitOptions:{projectId:o,relayUrl:"wss://relay.walletconnect.com",metadata:{name:c.name,description:c.name,url:window.location.origin,icons:[c.icon||""]}}},f=r.map(r=>`${i}:${r}`),m={requiredNamespaces:getRequiredNamespaces(f)};return{adapterSettings:l,loginSettings:m}}throw Error(`Unsupported chain namespace: ${i}`)},isChainIdSupported=(i,r,o)=>{var c,l;let f=(null==o?void 0:o.requiredNamespaces)||{},m=`${i}:${r}`;if(!f[i].chains||(null===(c=f[i].chains)||void 0===c?void 0:c.length)===0)return!1;let v=null===(l=f[i].chains)||void 0===l?void 0:l.includes(m);return!!v};let WalletConnectV2Adapter=class WalletConnectV2Adapter extends tZ.d{constructor(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(i),(0,w.Z)(this,"name",m.rW.WALLET_CONNECT_V2),(0,w.Z)(this,"adapterNamespace",m.yk.EIP155),(0,w.Z)(this,"currentChainNamespace",m.EN.EIP155),(0,w.Z)(this,"type",m.hN.EXTERNAL),(0,w.Z)(this,"adapterOptions",void 0),(0,w.Z)(this,"status",m.MP.NOT_READY),(0,w.Z)(this,"adapterData",{uri:"",extensionAdapters:tX}),(0,w.Z)(this,"connector",null),(0,w.Z)(this,"activeSession",null),(0,w.Z)(this,"wcProvider",null),this.adapterOptions=(0,v.Z)({},i)}get connected(){return!!this.activeSession}get provider(){return this.status!==m.MP.NOT_READY&&this.wcProvider?this.wcProvider:null}set provider(i){throw Error("Not implemented")}async init(i){var r,o,c;await super.init(),super.checkInitializationRequirements();let l=null===(r=this.adapterOptions.adapterSettings)||void 0===r||null===(r=r.walletConnectInitOptions)||void 0===r?void 0:r.projectId;if(!l)throw m.Ty.invalidParams("Wallet connect project id is required in wallet connect v2 adapter");let f=await getWalletConnectV2Settings(null===(o=this.chainConfig)||void 0===o?void 0:o.chainNamespace,[parseInt(null===(c=this.chainConfig)||void 0===c?void 0:c.chainId,16)],l);this.adapterOptions.loginSettings||(this.adapterOptions.loginSettings=f.loginSettings),this.adapterOptions.adapterSettings=tY()(f.adapterSettings,this.adapterOptions.adapterSettings);let{adapterSettings:v}=this.adapterOptions;if(this.connector=await index_es_Q.init(null==v?void 0:v.walletConnectInitOptions),this.wcProvider=new tW.G2({config:{chainConfig:this.chainConfig},connector:this.connector}),this.emit(m.n2.READY,m.rW.WALLET_CONNECT_V2),this.status=m.MP.READY,m.cM.debug("initializing wallet connect v2 adapter"),i.autoConnect){if(await this.checkForPersistedSession(),this.connected){this.rehydrated=!0;try{await this.onConnectHandler()}catch(i){m.cM.error("wallet auto connect",i),this.emit(m.n2.ERRORED,i)}}else this.status=m.MP.NOT_READY,this.emit(m.n2.CACHE_CLEAR)}}async connect(){if(super.checkConnectionRequirements(),!this.connector)throw m.Ty.notReady("Wallet adapter is not ready yet");try{if(this.connected)return await this.onConnectHandler(),this.provider;return this.status!==m.MP.CONNECTING&&await this.createNewSession(),this.provider}catch(r){m.cM.error("Wallet connect v2 adapter error while connecting",r),this.status=m.MP.READY,this.rehydrated=!0,this.emit(m.n2.ERRORED,r);let i=r instanceof m.up?r:m.RM.connectionError(`Failed to login with wallet connect: ${(null==r?void 0:r.message)||""}`);throw i}}async addChain(i){var r;let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(super.checkAddChainRequirements(i,o),!isChainIdSupported(this.currentChainNamespace,parseInt(i.chainId,16),this.adapterOptions.loginSettings))throw m.XM.chainIDNotAllowed(`Unsupported chainID: ${i.chainId}`);await (null===(r=this.wcProvider)||void 0===r?void 0:r.addChain(i)),this.addChainConfig(i)}async switchChain(i){var r;let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(super.checkSwitchChainRequirements(i,o),!isChainIdSupported(this.currentChainNamespace,parseInt(i.chainId,16),this.adapterOptions.loginSettings))throw m.XM.chainIDNotAllowed(`Unsupported chainID: ${i.chainId}`);await (null===(r=this.wcProvider)||void 0===r?void 0:r.switchChain({chainId:i.chainId})),this.setAdapterSettings({chainConfig:this.getChainConfig(i.chainId)})}async getUserInfo(){if(!this.connected)throw m.RM.notConnectedError("Not connected with wallet, Please login/connect first");return{}}async disconnect(){var i,r;let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cleanup:!1};await super.disconnectSession();let{cleanup:c}=o;if(!this.connector||!this.connected||!(null!==(i=this.activeSession)&&void 0!==i&&i.topic))throw m.RM.notConnectedError("Not connected with wallet");await this.connector.disconnect({topic:null===(r=this.activeSession)||void 0===r?void 0:r.topic,reason:(0,W.D6)("USER_DISCONNECTED")}),this.rehydrated=!1,c?(this.connector=null,this.status=m.MP.NOT_READY,this.wcProvider=null):this.status=m.MP.READY,this.activeSession=null,await super.disconnect()}cleanupPendingPairings(){if(!this.connector)throw m.Ty.notReady("Wallet adapter is not ready yet");let i=this.connector.pairing.getAll({active:!1});(0,W.qt)(i)&&i.forEach(i=>{this.connector&&this.connector.pairing.delete(i.topic,(0,W.D6)("USER_DISCONNECTED"))})}async checkForPersistedSession(){if(!this.connector)throw m.Ty.notReady("Wallet adapter is not ready yet");if(this.connector.session.length){let i=this.connector.session.keys.length-1;this.activeSession=this.connector.session.get(this.connector.session.keys[i])}return this.activeSession}async createNewSession(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{forceNewSession:!1};try{var r,o,c;if(!this.connector)throw m.Ty.notReady("Wallet adapter is not ready yet");if(!this.adapterOptions.loginSettings)throw m.Ty.notReady("login settings are not set yet");this.status=m.MP.CONNECTING,this.emit(m.n2.CONNECTING,{adapter:m.rW.WALLET_CONNECT_V2}),i.forceNewSession&&null!==(r=this.activeSession)&&void 0!==r&&r.topic&&await this.connector.disconnect({topic:null===(c=this.activeSession)||void 0===c?void 0:c.topic,reason:(0,W.D6)("USER_DISCONNECTED")}),m.cM.debug("creating new session for web3auth wallet connect");let{uri:l,approval:f}=await this.connector.connect(this.adapterOptions.loginSettings),v=null===(o=this.adapterOptions)||void 0===o||null===(o=o.adapterSettings)||void 0===o?void 0:o.qrcodeModal;if(l){if(v)try{await v.openModal({uri:l}),m.cM.debug("EVENT","QR Code Modal closed"),this.status=m.MP.READY,this.emit(m.n2.READY,m.rW.WALLET_CONNECT_V2)}catch(i){m.cM.error("unable to open qr code modal")}else this.updateAdapterData({uri:l,extensionAdapters:tX})}this.connector.events.once("proposal_expire",i=>{m.cM.info("proposal expired",i),this.createNewSession({forceNewSession:!0})}),m.cM.info("awaiting session approval from wallet");let w=await f();this.activeSession=w,await this.onConnectHandler(),v&&v.closeModal()}catch(i){throw m.cM.error("error while creating new wallet connect session",i),this.emit(m.n2.ERRORED,i),i}}async onConnectHandler(){var i;if(!this.connector||!this.wcProvider)throw m.Ty.notReady("Wallet adapter is not ready yet");if(!this.chainConfig)throw m.Ty.invalidParams("Chain config is not set");null!==(i=this.adapterOptions.adapterSettings)&&void 0!==i&&i.qrcodeModal&&(this.wcProvider=new tW.G2({config:{chainConfig:this.chainConfig,skipLookupNetwork:!0},connector:this.connector})),await this.wcProvider.setupProvider(this.connector),this.subscribeEvents(),this.cleanupPendingPairings(),this.status=m.MP.CONNECTED,this.emit(m.n2.CONNECTED,{adapter:m.rW.WALLET_CONNECT_V2,reconnected:this.rehydrated})}subscribeEvents(){if(!this.connector)throw m.Ty.notReady("Wallet adapter is not ready yet");this.connector.events.on("session_update",i=>{let{topic:r,params:o}=i;if(!this.connector)return;let{namespaces:c}=o,l=this.connector.session.get(r),f=(0,v.Z)((0,v.Z)({},l),{},{namespaces:c});this.activeSession=f}),this.connector.events.on("session_delete",()=>{this.disconnect()})}}},85346:function(i){"use strict";function tryStringify(i){try{return JSON.stringify(i)}catch(i){return'"[Circular]"'}}i.exports=function(i,r,o){var c=o&&o.stringify||tryStringify;if("object"==typeof i&&null!==i){var l=r.length+1;if(1===l)return i;var f=Array(l);f[0]=c(i);for(var m=1;m<l;m++)f[m]=c(r[m]);return f.join(" ")}if("string"!=typeof i)return i;var v=r.length;if(0===v)return i;for(var w="",E=0,I=-1,P=i&&i.length||0,R=0;R<P;){if(37===i.charCodeAt(R)&&R+1<P){switch(I=I>-1?I:0,i.charCodeAt(R+1)){case 100:case 102:if(E>=v||null==r[E])break;I<R&&(w+=i.slice(I,R)),w+=Number(r[E]),I=R+2,R++;break;case 105:if(E>=v||null==r[E])break;I<R&&(w+=i.slice(I,R)),w+=Math.floor(Number(r[E])),I=R+2,R++;break;case 79:case 111:case 106:if(E>=v||void 0===r[E])break;I<R&&(w+=i.slice(I,R));var x=typeof r[E];if("string"===x){w+="'"+r[E]+"'",I=R+2,R++;break}if("function"===x){w+=r[E].name||"<anonymous>",I=R+2,R++;break}w+=c(r[E]),I=R+2,R++;break;case 115:if(E>=v)break;I<R&&(w+=i.slice(I,R)),w+=String(r[E]),I=R+2,R++;break;case 37:I<R&&(w+=i.slice(I,R)),w+="%",I=R+2,R++,E--}++E}++R}return -1===I?i:(I<P&&(w+=i.slice(I)),w)}},36559:function(i,r,o){"use strict";let c=o(85346);i.exports=pino;let l=function(){function defd(i){return void 0!==i&&i}try{if("undefined"!=typeof globalThis)return globalThis;return Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(i){return defd(self)||defd(window)||defd(this)||{}}}().console||{};function pino(i){var r;(i=i||{}).browser=i.browser||{};let o=i.browser.transmit;if(o&&"function"!=typeof o.send)throw Error("pino: transmit option must have a send function");let c=i.browser.write||l;i.browser.write&&(i.browser.asObject=!0);let f=i.serializers||{},m=function(i,r){if(Array.isArray(i)){let r=i.filter(function(i){return"!stdSerializers.err"!==i});return r}return!0===i&&Object.keys(r)}(i.browser.serialize,f),v=i.browser.serialize;Array.isArray(i.browser.serialize)&&i.browser.serialize.indexOf("!stdSerializers.err")>-1&&(v=!1),"function"==typeof c&&(c.error=c.fatal=c.warn=c.info=c.debug=c.trace=c),!1===i.enabled&&(i.level="silent");let w=i.level||"info",E=Object.create(c);E.log||(E.log=noop),Object.defineProperty(E,"levelVal",{get:function(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(E,"level",{get:function(){return this._level},set:function(i){if("silent"!==i&&!this.levels.values[i])throw Error("unknown level "+i);this._level=i,set(I,E,"error","log"),set(I,E,"fatal","error"),set(I,E,"warn","error"),set(I,E,"info","log"),set(I,E,"debug","log"),set(I,E,"trace","log")}});let I={transmit:o,serialize:m,asObject:i.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:"function"==typeof(r=i).timestamp?r.timestamp:!1===r.timestamp?nullTime:epochTime};return E.levels=pino.levels,E.level=w,E.setMaxListeners=E.getMaxListeners=E.emit=E.addListener=E.on=E.prependListener=E.once=E.prependOnceListener=E.removeListener=E.removeAllListeners=E.listeners=E.listenerCount=E.eventNames=E.write=E.flush=noop,E.serializers=f,E._serialize=m,E._stdErrSerialize=v,E.child=function(r,c){if(!r)throw Error("missing bindings for child Pino");c=c||{},m&&r.serializers&&(c.serializers=r.serializers);let l=c.serializers;if(m&&l){var v=Object.assign({},f,l),w=!0===i.browser.serialize?Object.keys(v):m;delete r.serializers,applySerializers([r],w,v,this._stdErrSerialize)}function Child(i){this._childLevel=(0|i._childLevel)+1,this.error=bind(i,r,"error"),this.fatal=bind(i,r,"fatal"),this.warn=bind(i,r,"warn"),this.info=bind(i,r,"info"),this.debug=bind(i,r,"debug"),this.trace=bind(i,r,"trace"),v&&(this.serializers=v,this._serialize=w),o&&(this._logEvent=createLogEventShape([].concat(i._logEvent.bindings,r)))}return Child.prototype=this,new Child(this)},o&&(E._logEvent=createLogEventShape()),E}function set(i,r,o,f){let m=Object.getPrototypeOf(r);r[o]=r.levelVal>r.levels.values[o]?noop:m[o]?m[o]:l[o]||l[f]||noop,function(i,r,o){if(i.transmit||r[o]!==noop){var f;r[o]=(f=r[o],function(){let m=i.timestamp(),v=Array(arguments.length),w=Object.getPrototypeOf&&Object.getPrototypeOf(this)===l?l:this;for(var E=0;E<v.length;E++)v[E]=arguments[E];if(i.serialize&&!i.asObject&&applySerializers(v,this._serialize,this.serializers,this._stdErrSerialize),i.asObject?f.call(w,function(i,r,o,l){i._serialize&&applySerializers(o,i._serialize,i.serializers,i._stdErrSerialize);let f=o.slice(),m=f[0],v={};l&&(v.time=l),v.level=pino.levels.values[r];let w=(0|i._childLevel)+1;if(w<1&&(w=1),null!==m&&"object"==typeof m){for(;w--&&"object"==typeof f[0];)Object.assign(v,f.shift());m=f.length?c(f.shift(),f):void 0}else"string"==typeof m&&(m=c(f.shift(),f));return void 0!==m&&(v.msg=m),v}(this,o,v,m)):f.apply(w,v),i.transmit){let c=i.transmit.level||r.level,l=pino.levels.values[c],f=pino.levels.values[o];if(f<l)return;(function(i,r,o){let c=r.send,l=r.ts,f=r.methodLevel,m=r.methodValue,v=r.val,w=i._logEvent.bindings;applySerializers(o,i._serialize||Object.keys(i.serializers),i.serializers,void 0===i._stdErrSerialize||i._stdErrSerialize),i._logEvent.ts=l,i._logEvent.messages=o.filter(function(i){return -1===w.indexOf(i)}),i._logEvent.level.label=f,i._logEvent.level.value=m,c(f,i._logEvent,v),i._logEvent=createLogEventShape(w)})(this,{ts:m,methodLevel:o,methodValue:f,transmitLevel:c,transmitValue:pino.levels.values[i.transmit.level||r.level],send:i.transmit.send,val:r.levelVal},v)}})}}(i,r,o)}function applySerializers(i,r,o,c){for(let l in i)if(c&&i[l]instanceof Error)i[l]=pino.stdSerializers.err(i[l]);else if("object"==typeof i[l]&&!Array.isArray(i[l]))for(let c in i[l])r&&r.indexOf(c)>-1&&c in o&&(i[l][c]=o[c](i[l][c]))}function bind(i,r,o){return function(){let c=Array(1+arguments.length);c[0]=r;for(var l=1;l<c.length;l++)c[l]=arguments[l-1];return i[o].apply(this,c)}}function createLogEventShape(i){return{ts:0,messages:[],bindings:i||[],level:{label:"",value:0}}}function mock(){return{}}function passthrough(i){return i}function noop(){}function nullTime(){return!1}function epochTime(){return Date.now()}pino.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},pino.stdSerializers={mapHttpRequest:mock,mapHttpResponse:mock,wrapRequestSerializer:passthrough,wrapResponseSerializer:passthrough,wrapErrorSerializer:passthrough,req:mock,res:mock,err:function(i){let r={type:i.constructor.name,msg:i.message,stack:i.stack};for(let o in i)void 0===r[o]&&(r[o]=i[o]);return r}},pino.stdTimeFunctions=Object.assign({},{nullTime,epochTime,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}})}}]);