(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[987],{9173:function(e,t,r){"use strict";let{AbortError:n,codes:i}=r(80935),{isNodeStream:o,isWebStream:a,kControllerErrorFunction:s}=r(82275),l=r(8398),{ERR_INVALID_ARG_TYPE:d}=i,validateAbortSignal=(e,t)=>{if("object"!=typeof e||!("aborted"in e))throw new d(t,"AbortSignal",e)};e.exports.addAbortSignal=function(t,r){if(validateAbortSignal(t,"signal"),!o(r)&&!a(r))throw new d("stream",["ReadableStream","WritableStream","Stream"],r);return e.exports.addAbortSignalNoValidate(t,r)},e.exports.addAbortSignalNoValidate=function(e,t){if("object"!=typeof e||!("aborted"in e))return t;let r=o(t)?()=>{t.destroy(new n(void 0,{cause:e.reason}))}:()=>{t[s](new n(void 0,{cause:e.reason}))};return e.aborted?r():(e.addEventListener("abort",r),l(t,()=>e.removeEventListener("abort",r))),t}},85298:function(e,t,r){"use strict";let{StringPrototypeSlice:n,SymbolIterator:i,TypedArrayPrototypeSet:o,Uint8Array:a}=r(1218),{Buffer:s}=r(48764),{inspect:l}=r(27824);e.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){let t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){let t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}shift(){if(0===this.length)return;let e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(0===this.length)return"";let t=this.head,r=""+t.data;for(;null!==(t=t.next);)r+=e+t.data;return r}concat(e){if(0===this.length)return s.alloc(0);let t=s.allocUnsafe(e>>>0),r=this.head,n=0;for(;r;)o(t,r.data,n),n+=r.data.length,r=r.next;return t}consume(e,t){let r=this.head.data;if(e<r.length){let t=r.slice(0,e);return this.head.data=r.slice(e),t}return e===r.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[i](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let t="",r=this.head,i=0;do{let o=r.data;if(e>o.length)t+=o,e-=o.length;else{e===o.length?(t+=o,++i,r.next?this.head=r.next:this.head=this.tail=null):(t+=n(o,0,e),this.head=r,r.data=n(o,e));break}++i}while(null!==(r=r.next));return this.length-=i,t}_getBuffer(e){let t=s.allocUnsafe(e),r=e,n=this.head,i=0;do{let s=n.data;if(e>s.length)o(t,s,r-e),e-=s.length;else{e===s.length?(o(t,s,r-e),++i,n.next?this.head=n.next:this.head=this.tail=null):(o(t,new a(s.buffer,s.byteOffset,e),r-e),this.head=n,n.data=s.slice(e));break}++i}while(null!==(n=n.next));return this.length-=i,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return l(this,{...t,depth:0,customInspect:!1})}}},30162:function(e,t,r){"use strict";let{pipeline:n}=r(63208),i=r(29613),{destroyer:o}=r(89552),{isNodeStream:a,isReadable:s,isWritable:l,isWebStream:d,isTransformStream:u,isWritableStream:c,isReadableStream:h}=r(82275),{AbortError:f,codes:{ERR_INVALID_ARG_VALUE:p,ERR_MISSING_ARGS:b}}=r(80935),g=r(8398);e.exports=function(...e){let t,r,m,w,y;if(0===e.length)throw new b("streams");if(1===e.length)return i.from(e[0]);let _=[...e];if("function"==typeof e[0]&&(e[0]=i.from(e[0])),"function"==typeof e[e.length-1]){let t=e.length-1;e[t]=i.from(e[t])}for(let t=0;t<e.length;++t)if(a(e[t])||d(e[t])){if(t<e.length-1&&!(s(e[t])||h(e[t])||u(e[t])))throw new p(`streams[${t}]`,_[t],"must be readable");if(t>0&&!(l(e[t])||c(e[t])||u(e[t])))throw new p(`streams[${t}]`,_[t],"must be writable")}let v=e[0],S=n(e,function(e){let t=w;w=null,t?t(e):e?y.destroy(e):T||R||y.destroy()}),R=!!(l(v)||c(v)||u(v)),T=!!(s(S)||h(S)||u(S));if(y=new i({writableObjectMode:!!(null!=v&&v.writableObjectMode),readableObjectMode:!!(null!=S&&S.writableObjectMode),writable:R,readable:T}),R){if(a(v))y._write=function(e,r,n){v.write(e,r)?n():t=n},y._final=function(e){v.end(),r=e},v.on("drain",function(){if(t){let e=t;t=null,e()}});else if(d(v)){let e=u(v)?v.writable:v,t=e.getWriter();y._write=async function(e,r,n){try{await t.ready,t.write(e).catch(()=>{}),n()}catch(e){n(e)}},y._final=async function(e){try{await t.ready,t.close().catch(()=>{}),r=e}catch(t){e(t)}}}let e=u(S)?S.readable:S;g(e,()=>{if(r){let e=r;r=null,e()}})}if(T){if(a(S))S.on("readable",function(){if(m){let e=m;m=null,e()}}),S.on("end",function(){y.push(null)}),y._read=function(){for(;;){let e=S.read();if(null===e){m=y._read;return}if(!y.push(e))return}};else if(d(S)){let e=u(S)?S.readable:S,t=e.getReader();y._read=async function(){for(;;)try{let{value:e,done:r}=await t.read();if(!y.push(e))return;if(r){y.push(null);return}}catch{return}}}}return y._destroy=function(e,n){e||null===w||(e=new f),m=null,t=null,r=null,null===w?n(e):(w=n,a(S)&&o(S,e))},y}},89552:function(e,t,r){"use strict";let n=r(34155),{aggregateTwoErrors:i,codes:{ERR_MULTIPLE_CALLBACK:o},AbortError:a}=r(80935),{Symbol:s}=r(1218),{kDestroyed:l,isDestroyed:d,isFinished:u,isServerRequest:c}=r(82275),h=s("kDestroy"),f=s("kConstruct");function checkError(e,t,r){e&&(e.stack,t&&!t.errored&&(t.errored=e),r&&!r.errored&&(r.errored=e))}function _destroy(e,t,r){let i=!1;function onDestroy(t){if(i)return;i=!0;let o=e._readableState,a=e._writableState;checkError(t,a,o),a&&(a.closed=!0),o&&(o.closed=!0),"function"==typeof r&&r(t),t?n.nextTick(emitErrorCloseNT,e,t):n.nextTick(emitCloseNT,e)}try{e._destroy(t||null,onDestroy)}catch(e){onDestroy(e)}}function emitErrorCloseNT(e,t){emitErrorNT(e,t),emitCloseNT(e)}function emitCloseNT(e){let t=e._readableState,r=e._writableState;r&&(r.closeEmitted=!0),t&&(t.closeEmitted=!0),(null!=r&&r.emitClose||null!=t&&t.emitClose)&&e.emit("close")}function emitErrorNT(e,t){let r=e._readableState,n=e._writableState;null!=n&&n.errorEmitted||null!=r&&r.errorEmitted||(n&&(n.errorEmitted=!0),r&&(r.errorEmitted=!0),e.emit("error",t))}function errorOrDestroy(e,t,r){let i=e._readableState,o=e._writableState;if(null!=o&&o.destroyed||null!=i&&i.destroyed)return this;null!=i&&i.autoDestroy||null!=o&&o.autoDestroy?e.destroy(t):t&&(t.stack,o&&!o.errored&&(o.errored=t),i&&!i.errored&&(i.errored=t),r?n.nextTick(emitErrorNT,e,t):emitErrorNT(e,t))}function constructNT(e){let t=!1;function onConstruct(r){if(t){errorOrDestroy(e,null!=r?r:new o);return}t=!0;let i=e._readableState,a=e._writableState,s=a||i;i&&(i.constructed=!0),a&&(a.constructed=!0),s.destroyed?e.emit(h,r):r?errorOrDestroy(e,r,!0):n.nextTick(emitConstructNT,e)}try{e._construct(e=>{n.nextTick(onConstruct,e)})}catch(e){n.nextTick(onConstruct,e)}}function emitConstructNT(e){e.emit(f)}function isRequest(e){return(null==e?void 0:e.setHeader)&&"function"==typeof e.abort}function emitCloseLegacy(e){e.emit("close")}function emitErrorCloseLegacy(e,t){e.emit("error",t),n.nextTick(emitCloseLegacy,e)}e.exports={construct:function(e,t){if("function"!=typeof e._construct)return;let r=e._readableState,i=e._writableState;r&&(r.constructed=!1),i&&(i.constructed=!1),e.once(f,t),e.listenerCount(f)>1||n.nextTick(constructNT,e)},destroyer:function(e,t){!(!e||d(e))&&(t||u(e)||(t=new a),c(e)?(e.socket=null,e.destroy(t)):isRequest(e)?e.abort():isRequest(e.req)?e.req.abort():"function"==typeof e.destroy?e.destroy(t):"function"==typeof e.close?e.close():t?n.nextTick(emitErrorCloseLegacy,e,t):n.nextTick(emitCloseLegacy,e),e.destroyed||(e[l]=!0))},destroy:function(e,t){let r=this._readableState,n=this._writableState,o=n||r;return null!=n&&n.destroyed||null!=r&&r.destroyed?"function"==typeof t&&t():(checkError(e,n,r),n&&(n.destroyed=!0),r&&(r.destroyed=!0),o.constructed?_destroy(this,e,t):this.once(h,function(r){_destroy(this,i(r,e),t)})),this},undestroy:function(){let e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=!1===e.readable,e.endEmitted=!1===e.readable),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=!1===t.writable,t.ending=!1===t.writable,t.finished=!1===t.writable)},errorOrDestroy}},29613:function(e,t,r){"use strict";let n,i;let{ObjectDefineProperties:o,ObjectGetOwnPropertyDescriptor:a,ObjectKeys:s,ObjectSetPrototypeOf:l}=r(1218);e.exports=Duplex;let d=r(46766),u=r(46256);l(Duplex.prototype,d.prototype),l(Duplex,d);{let e=s(u.prototype);for(let t=0;t<e.length;t++){let r=e[t];Duplex.prototype[r]||(Duplex.prototype[r]=u.prototype[r])}}function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);d.call(this,e),u.call(this,e),e?(this.allowHalfOpen=!1!==e.allowHalfOpen,!1===e.readable&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===e.writable&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}function lazyWebStreams(){return void 0===n&&(n={}),n}o(Duplex.prototype,{writable:{__proto__:null,...a(u.prototype,"writable")},writableHighWaterMark:{__proto__:null,...a(u.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...a(u.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...a(u.prototype,"writableBuffer")},writableLength:{__proto__:null,...a(u.prototype,"writableLength")},writableFinished:{__proto__:null,...a(u.prototype,"writableFinished")},writableCorked:{__proto__:null,...a(u.prototype,"writableCorked")},writableEnded:{__proto__:null,...a(u.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...a(u.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set(e){this._readableState&&this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}}),Duplex.fromWeb=function(e,t){return lazyWebStreams().newStreamDuplexFromReadableWritablePair(e,t)},Duplex.toWeb=function(e){return lazyWebStreams().newReadableWritablePairFromDuplex(e)},Duplex.from=function(e){return i||(i=r(31378)),i(e,"body")}},31378:function(e,t,r){"use strict";let n=r(34155),i=r(48764),{isReadable:o,isWritable:a,isIterable:s,isNodeStream:l,isReadableNodeStream:d,isWritableNodeStream:u,isDuplexNodeStream:c}=r(82275),h=r(8398),{AbortError:f,codes:{ERR_INVALID_ARG_TYPE:p,ERR_INVALID_RETURN_VALUE:b}}=r(80935),{destroyer:g}=r(89552),m=r(29613),w=r(46766),{createDeferredPromise:y}=r(27824),_=r(13661),v=globalThis.Blob||i.Blob,S=void 0!==v?function(e){return e instanceof v}:function(e){return!1},R=globalThis.AbortController||r(28599).AbortController,{FunctionPrototypeCall:T}=r(1218);let Duplexify=class Duplexify extends m{constructor(e){super(e),(null==e?void 0:e.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(null==e?void 0:e.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}};function _duplexify(e){let t,r,n,i,s;let l=e.readable&&"function"!=typeof e.readable.read?w.wrap(e.readable):e.readable,d=e.writable,u=!!o(l),c=!!a(d);function onfinished(e){let t=i;i=null,t?t(e):e&&s.destroy(e)}return s=new Duplexify({readableObjectMode:!!(null!=l&&l.readableObjectMode),writableObjectMode:!!(null!=d&&d.writableObjectMode),readable:u,writable:c}),c&&(h(d,e=>{c=!1,e&&g(l,e),onfinished(e)}),s._write=function(e,r,n){d.write(e,r)?n():t=n},s._final=function(e){d.end(),r=e},d.on("drain",function(){if(t){let e=t;t=null,e()}}),d.on("finish",function(){if(r){let e=r;r=null,e()}})),u&&(h(l,e=>{u=!1,e&&g(l,e),onfinished(e)}),l.on("readable",function(){if(n){let e=n;n=null,e()}}),l.on("end",function(){s.push(null)}),s._read=function(){for(;;){let e=l.read();if(null===e){n=s._read;return}if(!s.push(e))return}}),s._destroy=function(e,o){e||null===i||(e=new f),n=null,t=null,r=null,null===i?o(e):(i=o,g(d,e),g(l,e))},s}e.exports=function duplexify(e,t){if(c(e))return e;if(d(e))return _duplexify({readable:e});if(u(e))return _duplexify({writable:e});if(l(e))return _duplexify({writable:!1,readable:!1});if("function"==typeof e){let{value:r,write:i,final:o,destroy:a}=function(e){let{promise:t,resolve:r}=y(),i=new R,o=i.signal,a=e(async function*(){for(;;){let e=t;t=null;let{chunk:i,done:a,cb:s}=await e;if(n.nextTick(s),a)return;if(o.aborted)throw new f(void 0,{cause:o.reason});({promise:t,resolve:r}=y()),yield i}}(),{signal:o});return{value:a,write(e,t,n){let i=r;r=null,i({chunk:e,done:!1,cb:n})},final(e){let t=r;r=null,t({done:!0,cb:e})},destroy(e,t){i.abort(),t(e)}}}(e);if(s(r))return _(Duplexify,r,{objectMode:!0,write:i,final:o,destroy:a});let l=null==r?void 0:r.then;if("function"==typeof l){let e;let t=T(l,r,e=>{if(null!=e)throw new b("nully","body",e)},t=>{g(e,t)});return e=new Duplexify({objectMode:!0,readable:!1,write:i,final(e){o(async()=>{try{await t,n.nextTick(e,null)}catch(t){n.nextTick(e,t)}})},destroy:a})}throw new b("Iterable, AsyncIterable or AsyncFunction",t,r)}if(S(e))return duplexify(e.arrayBuffer());if(s(e))return _(Duplexify,e,{objectMode:!0,writable:!1});if("object"==typeof(null==e?void 0:e.writable)||"object"==typeof(null==e?void 0:e.readable)){let t=null!=e&&e.readable?d(null==e?void 0:e.readable)?null==e?void 0:e.readable:duplexify(e.readable):void 0,r=null!=e&&e.writable?u(null==e?void 0:e.writable)?null==e?void 0:e.writable:duplexify(e.writable):void 0;return _duplexify({readable:t,writable:r})}let r=null==e?void 0:e.then;if("function"==typeof r){let t;return T(r,e,e=>{null!=e&&t.push(e),t.push(null)},e=>{g(t,e)}),t=new Duplexify({objectMode:!0,writable:!1,read(){}})}throw new p(t,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],e)}},8398:function(e,t,r){"use strict";let n=r(34155),{AbortError:i,codes:o}=r(80935),{ERR_INVALID_ARG_TYPE:a,ERR_STREAM_PREMATURE_CLOSE:s}=o,{kEmptyObject:l,once:d}=r(27824),{validateAbortSignal:u,validateFunction:c,validateObject:h,validateBoolean:f}=r(49603),{Promise:p,PromisePrototypeThen:b}=r(1218),{isClosed:g,isReadable:m,isReadableNodeStream:w,isReadableStream:y,isReadableFinished:_,isReadableErrored:v,isWritable:S,isWritableNodeStream:R,isWritableStream:T,isWritableFinished:A,isWritableErrored:C,isNodeStream:I,willEmitClose:k,kIsClosedPromise:P}=r(82275),nop=()=>{};function eos(e,t,r){var o,f;if(2==arguments.length?(r=t,t=l):null==t?t=l:h(t,"options"),c(r,"callback"),u(t.signal,"options.signal"),r=d(r),y(e)||T(e))return function(e,t,r){let o=!1,a=nop;if(t.signal){if(a=()=>{o=!0,r.call(e,new i(void 0,{cause:t.signal.reason}))},t.signal.aborted)n.nextTick(a);else{let n=r;r=d((...r)=>{t.signal.removeEventListener("abort",a),n.apply(e,r)}),t.signal.addEventListener("abort",a)}}let resolverFn=(...t)=>{o||n.nextTick(()=>r.apply(e,t))};return b(e[P].promise,resolverFn,resolverFn),nop}(e,t,r);if(!I(e))throw new a("stream",["ReadableStream","WritableStream","Stream"],e);let p=null!==(o=t.readable)&&void 0!==o?o:w(e),x=null!==(f=t.writable)&&void 0!==f?f:R(e),M=e._writableState,O=e._readableState,onlegacyfinish=()=>{e.writable||onfinish()},N=k(e)&&w(e)===p&&R(e)===x,W=A(e,!1),onfinish=()=>{W=!0,e.destroyed&&(N=!1),N&&(!e.readable||p)||p&&!D||r.call(e)},D=_(e,!1),onend=()=>{D=!0,e.destroyed&&(N=!1),N&&(!e.writable||x)||x&&!W||r.call(e)},onerror=t=>{r.call(e,t)},L=g(e),onclose=()=>{L=!0;let t=C(e)||v(e);return t&&"boolean"!=typeof t?r.call(e,t):p&&!D&&w(e,!0)&&!_(e,!1)||x&&!W&&!A(e,!1)?r.call(e,new s):void r.call(e)},onclosed=()=>{L=!0;let t=C(e)||v(e);if(t&&"boolean"!=typeof t)return r.call(e,t);r.call(e)},onrequest=()=>{e.req.on("finish",onfinish)};e.setHeader&&"function"==typeof e.abort?(e.on("complete",onfinish),N||e.on("abort",onclose),e.req?onrequest():e.on("request",onrequest)):x&&!M&&(e.on("end",onlegacyfinish),e.on("close",onlegacyfinish)),N||"boolean"!=typeof e.aborted||e.on("aborted",onclose),e.on("end",onend),e.on("finish",onfinish),!1!==t.error&&e.on("error",onerror),e.on("close",onclose),L?n.nextTick(onclose):null!=M&&M.errorEmitted||null!=O&&O.errorEmitted?N||n.nextTick(onclosed):!p&&(!N||m(e))&&(W||!1===S(e))?n.nextTick(onclosed):!x&&(!N||S(e))&&(D||!1===m(e))?n.nextTick(onclosed):O&&e.req&&e.aborted&&n.nextTick(onclosed);let cleanup=()=>{r=nop,e.removeListener("aborted",onclose),e.removeListener("complete",onfinish),e.removeListener("abort",onclose),e.removeListener("request",onrequest),e.req&&e.req.removeListener("finish",onfinish),e.removeListener("end",onlegacyfinish),e.removeListener("close",onlegacyfinish),e.removeListener("finish",onfinish),e.removeListener("end",onend),e.removeListener("error",onerror),e.removeListener("close",onclose)};if(t.signal&&!L){let abort=()=>{let n=r;cleanup(),n.call(e,new i(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)n.nextTick(abort);else{let n=r;r=d((...r)=>{t.signal.removeEventListener("abort",abort),n.apply(e,r)}),t.signal.addEventListener("abort",abort)}}return cleanup}e.exports=eos,e.exports.finished=function(e,t){var r;let n=!1;return null===t&&(t=l),null!==(r=t)&&void 0!==r&&r.cleanup&&(f(t.cleanup,"cleanup"),n=t.cleanup),new p((r,i)=>{let o=eos(e,t,e=>{n&&o(),e?i(e):r()})})}},13661:function(e,t,r){"use strict";let n=r(34155),{PromisePrototypeThen:i,SymbolAsyncIterator:o,SymbolIterator:a}=r(1218),{Buffer:s}=r(48764),{ERR_INVALID_ARG_TYPE:l,ERR_STREAM_NULL_VALUES:d}=r(80935).codes;e.exports=function(e,t,r){let u,c;if("string"==typeof t||t instanceof s)return new e({objectMode:!0,...r,read(){this.push(t),this.push(null)}});if(t&&t[o])c=!0,u=t[o]();else if(t&&t[a])c=!1,u=t[a]();else throw new l("iterable",["Iterable"],t);let h=new e({objectMode:!0,highWaterMark:1,...r}),f=!1;async function close(e){let t=null!=e,r="function"==typeof u.throw;if(t&&r){let{value:t,done:r}=await u.throw(e);if(await t,r)return}if("function"==typeof u.return){let{value:e}=await u.return();await e}}async function next(){for(;;){try{let{value:e,done:t}=c?await u.next():u.next();if(t)h.push(null);else{let t=e&&"function"==typeof e.then?await e:e;if(null===t)throw f=!1,new d;if(h.push(t))continue;f=!1}}catch(e){h.destroy(e)}break}}return h._read=function(){f||(f=!0,next())},h._destroy=function(e,t){i(close(e),()=>n.nextTick(t,e),r=>n.nextTick(t,r||e))},h}},6647:function(e,t,r){"use strict";let{ArrayIsArray:n,ObjectSetPrototypeOf:i}=r(1218),{EventEmitter:o}=r(17187);function Stream(e){o.call(this,e)}function prependListener(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?n(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}i(Stream.prototype,o.prototype),i(Stream,o),Stream.prototype.pipe=function(e,t){let r=this;function ondata(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function ondrain(){r.readable&&r.resume&&r.resume()}r.on("data",ondata),e.on("drain",ondrain),e._isStdio||t&&!1===t.end||(r.on("end",onend),r.on("close",onclose));let n=!1;function onend(){n||(n=!0,e.end())}function onclose(){n||(n=!0,"function"==typeof e.destroy&&e.destroy())}function onerror(e){cleanup(),0===o.listenerCount(this,"error")&&this.emit("error",e)}function cleanup(){r.removeListener("data",ondata),e.removeListener("drain",ondrain),r.removeListener("end",onend),r.removeListener("close",onclose),r.removeListener("error",onerror),e.removeListener("error",onerror),r.removeListener("end",cleanup),r.removeListener("close",cleanup),e.removeListener("close",cleanup)}return prependListener(r,"error",onerror),prependListener(e,"error",onerror),r.on("end",cleanup),r.on("close",cleanup),e.on("close",cleanup),e.emit("pipe",r),e},e.exports={Stream,prependListener}},29455:function(e,t,r){"use strict";let n=globalThis.AbortController||r(28599).AbortController,{codes:{ERR_INVALID_ARG_VALUE:i,ERR_INVALID_ARG_TYPE:o,ERR_MISSING_ARGS:a,ERR_OUT_OF_RANGE:s},AbortError:l}=r(80935),{validateAbortSignal:d,validateInteger:u,validateObject:c}=r(49603),h=r(1218).Symbol("kWeak"),{finished:f}=r(8398),p=r(30162),{addAbortSignalNoValidate:b}=r(9173),{isWritable:g,isNodeStream:m}=r(82275),{ArrayPrototypePush:w,MathFloor:y,Number:_,NumberIsNaN:v,Promise:S,PromiseReject:R,PromisePrototypeThen:T,Symbol:A}=r(1218),C=A("kEmpty"),I=A("kEof");function map(e,t){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);null!=t&&c(t,"options"),(null==t?void 0:t.signal)!=null&&d(t.signal,"options.signal");let r=1;return(null==t?void 0:t.concurrency)!=null&&(r=y(t.concurrency)),u(r,"concurrency",1),(async function*(){var i,o;let a,s;let d=new n,u=this,c=[],h=d.signal,f={signal:h},abort=()=>d.abort();null!=t&&null!==(i=t.signal)&&void 0!==i&&i.aborted&&abort(),null==t||null===(o=t.signal)||void 0===o||o.addEventListener("abort",abort);let p=!1;function onDone(){p=!0}(async function(){var n,i;try{for await(let t of u){if(p)return;if(h.aborted)throw new l;try{t=e(t,f)}catch(e){t=R(e)}t!==C&&("function"==typeof(null===(n=t)||void 0===n?void 0:n.catch)&&t.catch(onDone),c.push(t),a&&(a(),a=null),!p&&c.length&&c.length>=r&&await new S(e=>{s=e}))}c.push(I)}catch(t){let e=R(t);T(e,void 0,onDone),c.push(e)}finally{p=!0,a&&(a(),a=null),null==t||null===(i=t.signal)||void 0===i||i.removeEventListener("abort",abort)}})();try{for(;;){for(;c.length>0;){let e=await c[0];if(e===I)return;if(h.aborted)throw new l;e!==C&&(yield e),c.shift(),s&&(s(),s=null)}await new S(e=>{a=e})}}finally{d.abort(),p=!0,s&&(s(),s=null)}}).call(this)}async function some(e,t){for await(let r of filter.call(this,e,t))return!0;return!1}async function every(e,t){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);return!await some.call(this,async(...t)=>!await e(...t),t)}async function find(e,t){for await(let r of filter.call(this,e,t))return r}async function forEach(e,t){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);async function forEachFn(t,r){return await e(t,r),C}for await(let e of map.call(this,forEachFn,t));}function filter(e,t){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);async function filterFn(t,r){return await e(t,r)?t:C}return map.call(this,filterFn,t)}let ReduceAwareErrMissingArgs=class ReduceAwareErrMissingArgs extends a{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}};async function reduce(e,t,r){var i,a;if("function"!=typeof e)throw new o("reducer",["Function","AsyncFunction"],e);null!=r&&c(r,"options"),(null==r?void 0:r.signal)!=null&&d(r.signal,"options.signal");let s=arguments.length>1;if(null!=r&&null!==(i=r.signal)&&void 0!==i&&i.aborted){let e=new l(void 0,{cause:r.signal.reason});throw this.once("error",()=>{}),await f(this.destroy(e)),e}let u=new n,p=u.signal;null!=r&&r.signal&&r.signal.addEventListener("abort",()=>u.abort(),{once:!0,[h]:this});let b=!1;try{for await(let n of this){if(b=!0,null!=r&&null!==(a=r.signal)&&void 0!==a&&a.aborted)throw new l;s?t=await e(t,n,{signal:p}):(t=n,s=!0)}if(!b&&!s)throw new ReduceAwareErrMissingArgs}finally{u.abort()}return t}async function toArray(e){null!=e&&c(e,"options"),(null==e?void 0:e.signal)!=null&&d(e.signal,"options.signal");let t=[];for await(let n of this){var r;if(null!=e&&null!==(r=e.signal)&&void 0!==r&&r.aborted)throw new l(void 0,{cause:e.signal.reason});w(t,n)}return t}function toIntegerOrInfinity(e){if(v(e=_(e)))return 0;if(e<0)throw new s("number",">= 0",e);return e}e.exports.streamReturningOperators={asIndexedPairs:function(e){return null!=e&&c(e,"options"),(null==e?void 0:e.signal)!=null&&d(e.signal,"options.signal"),(async function*(){let t=0;for await(let n of this){var r;if(null!=e&&null!==(r=e.signal)&&void 0!==r&&r.aborted)throw new l({cause:e.signal.reason});yield[t++,n]}}).call(this)},drop:function(e,t){return null!=t&&c(t,"options"),(null==t?void 0:t.signal)!=null&&d(t.signal,"options.signal"),e=toIntegerOrInfinity(e),(async function*(){var r,n;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new l;for await(let r of this){if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new l;e--<=0&&(yield r)}}).call(this)},filter,flatMap:function(e,t){let r=map.call(this,e,t);return(async function*(){for await(let e of r)yield*e}).call(this)},map,take:function(e,t){return null!=t&&c(t,"options"),(null==t?void 0:t.signal)!=null&&d(t.signal,"options.signal"),e=toIntegerOrInfinity(e),(async function*(){var r,n;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new l;for await(let r of this){if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new l;if(!(e-- >0))return;yield r}}).call(this)},compose:function(e,t){if(null!=t&&c(t,"options"),(null==t?void 0:t.signal)!=null&&d(t.signal,"options.signal"),m(e)&&!g(e))throw new i("stream",e,"must be writable");let r=p(this,e);return null!=t&&t.signal&&b(t.signal,r),r}},e.exports.promiseReturningOperators={every,forEach,reduce,toArray,some,find}},76818:function(e,t,r){"use strict";let{ObjectSetPrototypeOf:n}=r(1218);e.exports=PassThrough;let i=r(30567);function PassThrough(e){if(!(this instanceof PassThrough))return new PassThrough(e);i.call(this,e)}n(PassThrough.prototype,i.prototype),n(PassThrough,i),PassThrough.prototype._transform=function(e,t,r){r(null,e)}},63208:function(e,t,r){let n,i;"use strict";let o=r(34155),{ArrayIsArray:a,Promise:s,SymbolAsyncIterator:l}=r(1218),d=r(8398),{once:u}=r(27824),c=r(89552),h=r(29613),{aggregateTwoErrors:f,codes:{ERR_INVALID_ARG_TYPE:p,ERR_INVALID_RETURN_VALUE:b,ERR_MISSING_ARGS:g,ERR_STREAM_DESTROYED:m,ERR_STREAM_PREMATURE_CLOSE:w},AbortError:y}=r(80935),{validateFunction:_,validateAbortSignal:v}=r(49603),{isIterable:S,isReadable:R,isReadableNodeStream:T,isNodeStream:A,isTransformStream:C,isWebStream:I,isReadableStream:k,isReadableEnded:P}=r(82275),x=globalThis.AbortController||r(28599).AbortController;function destroyer(e,t,r){let n=!1;e.on("close",()=>{n=!0});let i=d(e,{readable:t,writable:r},e=>{n=!e});return{destroy:t=>{n||(n=!0,c.destroyer(e,t||new m("pipe")))},cleanup:i}}function makeAsyncIterable(e){if(S(e))return e;if(T(e))return fromReadable(e);throw new p("val",["Readable","Iterable","AsyncIterable"],e)}async function*fromReadable(e){i||(i=r(46766)),yield*i.prototype[l].call(e)}async function pumpToNode(e,t,r,{end:n}){let i;let o=null,resume=e=>{if(e&&(i=e),o){let e=o;o=null,e()}},wait=()=>new s((e,t)=>{i?t(i):o=()=>{i?t(i):e()}});t.on("drain",resume);let a=d(t,{readable:!1},resume);try{for await(let r of(t.writableNeedDrain&&await wait(),e))t.write(r)||await wait();n&&t.end(),await wait(),r()}catch(e){r(i!==e?f(i,e):e)}finally{a(),t.off("drain",resume)}}async function pumpToWeb(e,t,r,{end:n}){C(t)&&(t=t.writable);let i=t.getWriter();try{for await(let t of e)await i.ready,i.write(t).catch(()=>{});await i.ready,n&&await i.close(),r()}catch(e){try{await i.abort(e),r(e)}catch(e){r(e)}}}function pipelineImpl(e,t,i){let s,l,u;if(1===e.length&&a(e[0])&&(e=e[0]),e.length<2)throw new g("streams");let c=new x,f=c.signal,m=null==i?void 0:i.signal,_=[];function abort(){finishImpl(new y)}v(m,"options.signal"),null==m||m.addEventListener("abort",abort);let M=[],O=0;function finish(e){finishImpl(e,0==--O)}function finishImpl(e,r){if(e&&(!s||"ERR_STREAM_PREMATURE_CLOSE"===s.code)&&(s=e),s||r){for(;M.length;)M.shift()(s);null==m||m.removeEventListener("abort",abort),c.abort(),r&&(s||_.forEach(e=>e()),o.nextTick(t,s,l))}}for(let t=0;t<e.length;t++){let a=e[t],s=t<e.length-1,c=t>0,g=s||(null==i?void 0:i.end)!==!1,m=t===e.length-1;if(A(a)){if(g){let{destroy:e,cleanup:t}=destroyer(a,s,c);M.push(e),R(a)&&m&&_.push(t)}function onError(e){e&&"AbortError"!==e.name&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code&&finish(e)}a.on("error",onError),R(a)&&m&&_.push(()=>{a.removeListener("error",onError)})}if(0===t){if("function"==typeof a){if(!S(u=a({signal:f})))throw new b("Iterable, AsyncIterable or Stream","source",u)}else u=S(a)||T(a)||C(a)?a:h.from(a)}else if("function"==typeof a){var N,W;if(u=a(u=C(u)?makeAsyncIterable(null===(N=u)||void 0===N?void 0:N.readable):makeAsyncIterable(u),{signal:f}),s){if(!S(u,!0))throw new b("AsyncIterable",`transform[${t-1}]`,u)}else{n||(n=r(76818));let e=new n({objectMode:!0}),t=null===(W=u)||void 0===W?void 0:W.then;if("function"==typeof t)O++,t.call(u,t=>{l=t,null!=t&&e.write(t),g&&e.end(),o.nextTick(finish)},t=>{e.destroy(t),o.nextTick(finish,t)});else if(S(u,!0))O++,pumpToNode(u,e,finish,{end:g});else if(k(u)||C(u)){let t=u.readable||u;O++,pumpToNode(t,e,finish,{end:g})}else throw new b("AsyncIterable or Promise","destination",u);u=e;let{destroy:i,cleanup:a}=destroyer(u,!1,!0);M.push(i),m&&_.push(a)}}else if(A(a)){if(T(u)){O+=2;let e=function(e,t,r,{end:n}){let i=!1;if(t.on("close",()=>{i||r(new w)}),e.pipe(t,{end:!1}),n){function endFn(){i=!0,t.end()}P(e)?o.nextTick(endFn):e.once("end",endFn)}else r();return d(e,{readable:!0,writable:!1},t=>{let n=e._readableState;t&&"ERR_STREAM_PREMATURE_CLOSE"===t.code&&n&&n.ended&&!n.errored&&!n.errorEmitted?e.once("end",r).once("error",r):r(t)}),d(t,{readable:!1,writable:!0},r)}(u,a,finish,{end:g});R(a)&&m&&_.push(e)}else if(C(u)||k(u)){let e=u.readable||u;O++,pumpToNode(e,a,finish,{end:g})}else if(S(u))O++,pumpToNode(u,a,finish,{end:g});else throw new p("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],u);u=a}else if(I(a)){if(T(u))O++,pumpToWeb(makeAsyncIterable(u),a,finish,{end:g});else if(k(u)||S(u))O++,pumpToWeb(u,a,finish,{end:g});else if(C(u))O++,pumpToWeb(u.readable,a,finish,{end:g});else throw new p("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],u);u=a}else u=h.from(a)}return(null!=f&&f.aborted||null!=m&&m.aborted)&&o.nextTick(abort),u}e.exports={pipelineImpl,pipeline:function(...e){return pipelineImpl(e,u((_(e[e.length-1],"streams[stream.length - 1]"),e.pop())))}}},46766:function(e,t,r){let n;"use strict";let i=r(34155),{ArrayPrototypeIndexOf:o,NumberIsInteger:a,NumberIsNaN:s,NumberParseInt:l,ObjectDefineProperties:d,ObjectKeys:u,ObjectSetPrototypeOf:c,Promise:h,SafeSet:f,SymbolAsyncIterator:p,Symbol:b}=r(1218);e.exports=Readable,Readable.ReadableState=ReadableState;let{EventEmitter:g}=r(17187),{Stream:m,prependListener:w}=r(6647),{Buffer:y}=r(48764),{addAbortSignal:_}=r(9173),v=r(8398),S=r(27824).debuglog("stream",e=>{S=e}),R=r(85298),T=r(89552),{getHighWaterMark:A,getDefaultHighWaterMark:C}=r(76589),{aggregateTwoErrors:I,codes:{ERR_INVALID_ARG_TYPE:k,ERR_METHOD_NOT_IMPLEMENTED:P,ERR_OUT_OF_RANGE:x,ERR_STREAM_PUSH_AFTER_EOF:M,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:O}}=r(80935),{validateObject:N}=r(49603),W=b("kPaused"),{StringDecoder:D}=r(32553),L=r(13661);c(Readable.prototype,m.prototype),c(Readable,m);let nop=()=>{},{errorOrDestroy:j}=T;function ReadableState(e,t,n){"boolean"!=typeof n&&(n=t instanceof r(29613)),this.objectMode=!!(e&&e.objectMode),n&&(this.objectMode=this.objectMode||!!(e&&e.readableObjectMode)),this.highWaterMark=e?A(this,e,"readableHighWaterMark",n):C(!1),this.buffer=new R,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[W]=null,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,e&&e.encoding&&(this.decoder=new D(e.encoding),this.encoding=e.encoding)}function Readable(e){if(!(this instanceof Readable))return new Readable(e);let t=this instanceof r(29613);this._readableState=new ReadableState(e,this,t),e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&!t&&_(e.signal,this)),m.call(this,e),T.construct(this,()=>{this._readableState.needReadable&&maybeReadMore(this,this._readableState)})}function readableAddChunk(e,t,r,n){let i;S("readableAddChunk",t);let o=e._readableState;if(o.objectMode||("string"==typeof t?(r=r||o.defaultEncoding,o.encoding!==r&&(n&&o.encoding?t=y.from(t,r).toString(o.encoding):(t=y.from(t,r),r=""))):t instanceof y?r="":m._isUint8Array(t)?(t=m._uint8ArrayToBuffer(t),r=""):null!=t&&(i=new k("chunk",["string","Buffer","Uint8Array"],t))),i)j(e,i);else if(null===t)o.reading=!1,function(e,t){if(S("onEofChunk"),!t.ended){if(t.decoder){let e=t.decoder.end();e&&e.length&&(t.buffer.push(e),t.length+=t.objectMode?1:e.length)}t.ended=!0,t.sync?emitReadable(e):(t.needReadable=!1,t.emittedReadable=!0,emitReadable_(e))}}(e,o);else if(o.objectMode||t&&t.length>0){if(n){if(o.endEmitted)j(e,new O);else{if(o.destroyed||o.errored)return!1;addChunk(e,o,t,!0)}}else if(o.ended)j(e,new M);else{if(o.destroyed||o.errored)return!1;o.reading=!1,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?addChunk(e,o,t,!1):maybeReadMore(e,o)):addChunk(e,o,t,!1)}}else n||(o.reading=!1,maybeReadMore(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function addChunk(e,t,r,n){t.flowing&&0===t.length&&!t.sync&&e.listenerCount("data")>0?(t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null,t.dataEmitted=!0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&emitReadable(e)),maybeReadMore(e,t)}function howMuchToRead(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:s(e)?t.flowing&&t.length?t.buffer.first().length:t.length:e<=t.length?e:t.ended?t.length:0}function emitReadable(e){let t=e._readableState;S("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(S("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(emitReadable_,e))}function emitReadable_(e){let t=e._readableState;S("emitReadable_",t.destroyed,t.length,t.ended),!t.destroyed&&!t.errored&&(t.length||t.ended)&&(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,flow(e)}function maybeReadMore(e,t){!t.readingMore&&t.constructed&&(t.readingMore=!0,i.nextTick(maybeReadMore_,e,t))}function maybeReadMore_(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){let r=t.length;if(S("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function updateReadableListening(e){let t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!1===t[W]?t.flowing=!0:e.listenerCount("data")>0?e.resume():t.readableListening||(t.flowing=null)}function nReadingNextTick(e){S("readable nexttick read 0"),e.read(0)}function resume_(e,t){S("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),flow(e),t.flowing&&!t.reading&&e.read(0)}function flow(e){let t=e._readableState;for(S("flow",t.flowing);t.flowing&&null!==e.read(););}function streamToAsyncIterator(e,t){"function"!=typeof e.read&&(e=Readable.wrap(e,{objectMode:!0}));let r=createAsyncIterator(e,t);return r.stream=e,r}async function*createAsyncIterator(e,t){let r,n=nop;function next(t){this===e?(n(),n=nop):n=t}e.on("readable",next);let i=v(e,{writable:!1},e=>{r=e?I(r,e):null,n(),n=nop});try{for(;;){let t=e.destroyed?null:e.read();if(null!==t)yield t;else if(r)throw r;else{if(null===r)return;await new h(next)}}}catch(e){throw r=I(r,e)}finally{(r||(null==t?void 0:t.destroyOnReturn)!==!1)&&(void 0===r||e._readableState.autoDestroy)?T.destroyer(e,null):(e.off("readable",next),i())}}function fromList(e,t){let r;return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r)}function endReadable(e){let t=e._readableState;S("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick(endReadableNT,t,e))}function endReadableNT(e,t){if(S("endReadableNT",e.endEmitted,e.length),!e.errored&&!e.closeEmitted&&!e.endEmitted&&0===e.length){if(e.endEmitted=!0,t.emit("end"),t.writable&&!1===t.allowHalfOpen)i.nextTick(endWritableNT,t);else if(e.autoDestroy){let e=t._writableState,r=!e||e.autoDestroy&&(e.finished||!1===e.writable);r&&t.destroy()}}}function endWritableNT(e){let t=e.writable&&!e.writableEnded&&!e.destroyed;t&&e.end()}function lazyWebStreams(){return void 0===n&&(n={}),n}Readable.prototype.destroy=T.destroy,Readable.prototype._undestroy=T.undestroy,Readable.prototype._destroy=function(e,t){t(e)},Readable.prototype[g.captureRejectionSymbol]=function(e){this.destroy(e)},Readable.prototype.push=function(e,t){return readableAddChunk(this,e,t,!1)},Readable.prototype.unshift=function(e,t){return readableAddChunk(this,e,t,!0)},Readable.prototype.isPaused=function(){let e=this._readableState;return!0===e[W]||!1===e.flowing},Readable.prototype.setEncoding=function(e){let t=new D(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;let r=this._readableState.buffer,n="";for(let e of r)n+=t.write(e);return r.clear(),""!==n&&r.push(n),this._readableState.length=n.length,this},Readable.prototype.read=function(e){let t;S("read",e),void 0===e?e=NaN:a(e)||(e=l(e,10));let r=this._readableState,n=e;if(e>r.highWaterMark&&(r.highWaterMark=function(e){if(e>1073741824)throw new x("size","<= 1GiB",e);return e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e}(e)),0!==e&&(r.emittedReadable=!1),0===e&&r.needReadable&&((0!==r.highWaterMark?r.length>=r.highWaterMark:r.length>0)||r.ended))return S("read: emitReadable",r.length,r.ended),0===r.length&&r.ended?endReadable(this):emitReadable(this),null;if(0===(e=howMuchToRead(e,r))&&r.ended)return 0===r.length&&endReadable(this),null;let i=r.needReadable;if(S("need readable",i),(0===r.length||r.length-e<r.highWaterMark)&&S("length less than watermark",i=!0),r.ended||r.reading||r.destroyed||r.errored||!r.constructed)S("reading, ended or constructing",i=!1);else if(i){S("do read"),r.reading=!0,r.sync=!0,0===r.length&&(r.needReadable=!0);try{this._read(r.highWaterMark)}catch(e){j(this,e)}r.sync=!1,r.reading||(e=howMuchToRead(n,r))}return null===(t=e>0?fromList(e,r):null)?(r.needReadable=r.length<=r.highWaterMark,e=0):(r.length-=e,r.multiAwaitDrain?r.awaitDrainWriters.clear():r.awaitDrainWriters=null),0===r.length&&(r.ended||(r.needReadable=!0),n!==e&&r.ended&&endReadable(this)),null===t||r.errorEmitted||r.closeEmitted||(r.dataEmitted=!0,this.emit("data",t)),t},Readable.prototype._read=function(e){throw new P("_read()")},Readable.prototype.pipe=function(e,t){let r;let n=this,o=this._readableState;1!==o.pipes.length||o.multiAwaitDrain||(o.multiAwaitDrain=!0,o.awaitDrainWriters=new f(o.awaitDrainWriters?[o.awaitDrainWriters]:[])),o.pipes.push(e),S("pipe count=%d opts=%j",o.pipes.length,t);let a=(!t||!1!==t.end)&&e!==i.stdout&&e!==i.stderr,s=a?onend:unpipe;function onend(){S("onend"),e.end()}o.endEmitted?i.nextTick(s):n.once("end",s),e.on("unpipe",function onunpipe(t,i){S("onunpipe"),t===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,S("cleanup"),e.removeListener("close",onclose),e.removeListener("finish",onfinish),r&&e.removeListener("drain",r),e.removeListener("error",onerror),e.removeListener("unpipe",onunpipe),n.removeListener("end",onend),n.removeListener("end",unpipe),n.removeListener("data",ondata),l=!0,r&&o.awaitDrainWriters&&(!e._writableState||e._writableState.needDrain)&&r())});let l=!1;function pause(){l||(1===o.pipes.length&&o.pipes[0]===e?(S("false write response, pause",0),o.awaitDrainWriters=e,o.multiAwaitDrain=!1):o.pipes.length>1&&o.pipes.includes(e)&&(S("false write response, pause",o.awaitDrainWriters.size),o.awaitDrainWriters.add(e)),n.pause()),r||(r=function(){let t=n._readableState;t.awaitDrainWriters===e?(S("pipeOnDrain",1),t.awaitDrainWriters=null):t.multiAwaitDrain&&(S("pipeOnDrain",t.awaitDrainWriters.size),t.awaitDrainWriters.delete(e)),(!t.awaitDrainWriters||0===t.awaitDrainWriters.size)&&n.listenerCount("data")&&n.resume()},e.on("drain",r))}function ondata(t){S("ondata");let r=e.write(t);S("dest.write",r),!1===r&&pause()}function onerror(t){if(S("onerror",t),unpipe(),e.removeListener("error",onerror),0===e.listenerCount("error")){let r=e._writableState||e._readableState;r&&!r.errorEmitted?j(e,t):e.emit("error",t)}}function onclose(){e.removeListener("finish",onfinish),unpipe()}function onfinish(){S("onfinish"),e.removeListener("close",onclose),unpipe()}function unpipe(){S("unpipe"),n.unpipe(e)}return n.on("data",ondata),w(e,"error",onerror),e.once("close",onclose),e.once("finish",onfinish),e.emit("pipe",n),!0===e.writableNeedDrain?o.flowing&&pause():o.flowing||(S("pipe resume"),n.resume()),e},Readable.prototype.unpipe=function(e){let t=this._readableState;if(0===t.pipes.length)return this;if(!e){let e=t.pipes;t.pipes=[],this.pause();for(let t=0;t<e.length;t++)e[t].emit("unpipe",this,{hasUnpiped:!1});return this}let r=o(t.pipes,e);return -1===r||(t.pipes.splice(r,1),0===t.pipes.length&&this.pause(),e.emit("unpipe",this,{hasUnpiped:!1})),this},Readable.prototype.on=function(e,t){let r=m.prototype.on.call(this,e,t),n=this._readableState;return"data"===e?(n.readableListening=this.listenerCount("readable")>0,!1!==n.flowing&&this.resume()):"readable"!==e||n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,S("on readable",n.length,n.reading),n.length?emitReadable(this):n.reading||i.nextTick(nReadingNextTick,this)),r},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.removeListener=function(e,t){let r=m.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(updateReadableListening,this),r},Readable.prototype.off=Readable.prototype.removeListener,Readable.prototype.removeAllListeners=function(e){let t=m.prototype.removeAllListeners.apply(this,arguments);return("readable"===e||void 0===e)&&i.nextTick(updateReadableListening,this),t},Readable.prototype.resume=function(){let e=this._readableState;return e.flowing||(S("resume"),e.flowing=!e.readableListening,e.resumeScheduled||(e.resumeScheduled=!0,i.nextTick(resume_,this,e))),e[W]=!1,this},Readable.prototype.pause=function(){return S("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(S("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[W]=!0,this},Readable.prototype.wrap=function(e){let t=!1;e.on("data",r=>{!this.push(r)&&e.pause&&(t=!0,e.pause())}),e.on("end",()=>{this.push(null)}),e.on("error",e=>{j(this,e)}),e.on("close",()=>{this.destroy()}),e.on("destroy",()=>{this.destroy()}),this._read=()=>{t&&e.resume&&(t=!1,e.resume())};let r=u(e);for(let t=1;t<r.length;t++){let n=r[t];void 0===this[n]&&"function"==typeof e[n]&&(this[n]=e[n].bind(e))}return this},Readable.prototype[p]=function(){return streamToAsyncIterator(this)},Readable.prototype.iterator=function(e){return void 0!==e&&N(e,"options"),streamToAsyncIterator(this,e)},d(Readable.prototype,{readable:{__proto__:null,get(){let e=this._readableState;return!!e&&!1!==e.readable&&!e.destroyed&&!e.errorEmitted&&!e.endEmitted},set(e){this._readableState&&(this._readableState.readable=!!e)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(!1!==this._readableState.readable&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return!!this._readableState&&this._readableState.closed}},destroyed:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.destroyed},set(e){this._readableState&&(this._readableState.destroyed=e)}},readableEnded:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.endEmitted}}}),d(ReadableState.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return!1!==this[W]},set(e){this[W]=!!e}}}),Readable._fromList=fromList,Readable.from=function(e,t){return L(Readable,e,t)},Readable.fromWeb=function(e,t){return lazyWebStreams().newStreamReadableFromReadableStream(e,t)},Readable.toWeb=function(e,t){return lazyWebStreams().newReadableStreamFromStreamReadable(e,t)},Readable.wrap=function(e,t){var r,n;return new Readable({objectMode:null===(r=null!==(n=e.readableObjectMode)&&void 0!==n?n:e.objectMode)||void 0===r||r,...t,destroy(t,r){T.destroyer(e,t),r(t)}}).wrap(e)}},76589:function(e,t,r){"use strict";let{MathFloor:n,NumberIsInteger:i}=r(1218),{ERR_INVALID_ARG_VALUE:o}=r(80935).codes;function getDefaultHighWaterMark(e){return e?16:16384}e.exports={getHighWaterMark:function(e,t,r,a){let s=null!=t.highWaterMark?t.highWaterMark:a?t[r]:null;if(null!=s){if(!i(s)||s<0){let e=a?`options.${r}`:"options.highWaterMark";throw new o(e,s)}return n(s)}return getDefaultHighWaterMark(e.objectMode)},getDefaultHighWaterMark}},30567:function(e,t,r){"use strict";let{ObjectSetPrototypeOf:n,Symbol:i}=r(1218);e.exports=Transform;let{ERR_METHOD_NOT_IMPLEMENTED:o}=r(80935).codes,a=r(29613),{getHighWaterMark:s}=r(76589);n(Transform.prototype,a.prototype),n(Transform,a);let l=i("kCallback");function Transform(e){if(!(this instanceof Transform))return new Transform(e);let t=e?s(this,e,"readableHighWaterMark",!0):null;0===t&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),a.call(this,e),this._readableState.sync=!1,this[l]=null,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",prefinish)}function final(e){"function"!=typeof this._flush||this.destroyed?(this.push(null),e&&e()):this._flush((t,r)=>{if(t){e?e(t):this.destroy(t);return}null!=r&&this.push(r),this.push(null),e&&e()})}function prefinish(){this._final!==final&&final.call(this)}Transform.prototype._final=final,Transform.prototype._transform=function(e,t,r){throw new o("_transform()")},Transform.prototype._write=function(e,t,r){let n=this._readableState,i=this._writableState,o=n.length;this._transform(e,t,(e,t)=>{if(e){r(e);return}null!=t&&this.push(t),i.ended||o===n.length||n.length<n.highWaterMark?r():this[l]=r})},Transform.prototype._read=function(){if(this[l]){let e=this[l];this[l]=null,e()}}},82275:function(e,t,r){"use strict";let{Symbol:n,SymbolAsyncIterator:i,SymbolIterator:o,SymbolFor:a}=r(1218),s=n("kDestroyed"),l=n("kIsErrored"),d=n("kIsReadable"),u=n("kIsDisturbed"),c=a("nodejs.webstream.isClosedPromise"),h=a("nodejs.webstream.controllerErrorFunction");function isReadableNodeStream(e,t=!1){var r;return!!(e&&"function"==typeof e.pipe&&"function"==typeof e.on&&(!t||"function"==typeof e.pause&&"function"==typeof e.resume)&&(!e._writableState||(null===(r=e._readableState)||void 0===r?void 0:r.readable)!==!1)&&(!e._writableState||e._readableState))}function isWritableNodeStream(e){var t;return!!(e&&"function"==typeof e.write&&"function"==typeof e.on&&(!e._readableState||(null===(t=e._writableState)||void 0===t?void 0:t.writable)!==!1))}function isNodeStream(e){return e&&(e._readableState||e._writableState||"function"==typeof e.write&&"function"==typeof e.on||"function"==typeof e.pipe&&"function"==typeof e.on)}function isReadableStream(e){return!!(e&&!isNodeStream(e)&&"function"==typeof e.pipeThrough&&"function"==typeof e.getReader&&"function"==typeof e.cancel)}function isWritableStream(e){return!!(e&&!isNodeStream(e)&&"function"==typeof e.getWriter&&"function"==typeof e.abort)}function isTransformStream(e){return!!(e&&!isNodeStream(e)&&"object"==typeof e.readable&&"object"==typeof e.writable)}function isDestroyed(e){if(!isNodeStream(e))return null;let t=e._writableState,r=e._readableState,n=t||r;return!!(e.destroyed||e[s]||null!=n&&n.destroyed)}function isWritableEnded(e){if(!isWritableNodeStream(e))return null;if(!0===e.writableEnded)return!0;let t=e._writableState;return(null==t||!t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)}function isReadableFinished(e,t){if(!isReadableNodeStream(e))return null;let r=e._readableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.endEmitted)?null:!!(r.endEmitted||!1===t&&!0===r.ended&&0===r.length))}function isReadable(e){return e&&null!=e[d]?e[d]:"boolean"!=typeof(null==e?void 0:e.readable)?null:!isDestroyed(e)&&isReadableNodeStream(e)&&e.readable&&!isReadableFinished(e)}function isWritable(e){return"boolean"!=typeof(null==e?void 0:e.writable)?null:!isDestroyed(e)&&isWritableNodeStream(e)&&e.writable&&!isWritableEnded(e)}function isOutgoingMessage(e){return"boolean"==typeof e._closed&&"boolean"==typeof e._defaultKeepAlive&&"boolean"==typeof e._removedConnection&&"boolean"==typeof e._removedContLen}function isServerResponse(e){return"boolean"==typeof e._sent100&&isOutgoingMessage(e)}e.exports={kDestroyed:s,isDisturbed:function(e){var t;return!!(e&&(null!==(t=e[u])&&void 0!==t?t:e.readableDidRead||e.readableAborted))},kIsDisturbed:u,isErrored:function(e){var t,r,n,i,o,a,s,d,u,c;return!!(e&&(null!==(t=null!==(r=null!==(n=null!==(i=null!==(o=null!==(a=e[l])&&void 0!==a?a:e.readableErrored)&&void 0!==o?o:e.writableErrored)&&void 0!==i?i:null===(s=e._readableState)||void 0===s?void 0:s.errorEmitted)&&void 0!==n?n:null===(d=e._writableState)||void 0===d?void 0:d.errorEmitted)&&void 0!==r?r:null===(u=e._readableState)||void 0===u?void 0:u.errored)&&void 0!==t?t:null===(c=e._writableState)||void 0===c?void 0:c.errored))},kIsErrored:l,isReadable,kIsReadable:d,kIsClosedPromise:c,kControllerErrorFunction:h,isClosed:function(e){if(!isNodeStream(e))return null;if("boolean"==typeof e.closed)return e.closed;let t=e._writableState,r=e._readableState;return"boolean"==typeof(null==t?void 0:t.closed)||"boolean"==typeof(null==r?void 0:r.closed)?(null==t?void 0:t.closed)||(null==r?void 0:r.closed):"boolean"==typeof e._closed&&isOutgoingMessage(e)?e._closed:null},isDestroyed,isDuplexNodeStream:function(e){return!!(e&&"function"==typeof e.pipe&&e._readableState&&"function"==typeof e.on&&"function"==typeof e.write)},isFinished:function(e,t){return isNodeStream(e)?!!isDestroyed(e)||!((null==t?void 0:t.readable)!==!1&&isReadable(e)||(null==t?void 0:t.writable)!==!1&&isWritable(e)):null},isIterable:function(e,t){return null!=e&&(!0===t?"function"==typeof e[i]:!1===t?"function"==typeof e[o]:"function"==typeof e[i]||"function"==typeof e[o])},isReadableNodeStream,isReadableStream,isReadableEnded:function(e){if(!isReadableNodeStream(e))return null;if(!0===e.readableEnded)return!0;let t=e._readableState;return!!t&&!t.errored&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)},isReadableFinished,isReadableErrored:function(e){var t,r;return isNodeStream(e)?e.readableErrored?e.readableErrored:null!==(t=null===(r=e._readableState)||void 0===r?void 0:r.errored)&&void 0!==t?t:null:null},isNodeStream,isWebStream:function(e){return isReadableStream(e)||isWritableStream(e)||isTransformStream(e)},isWritable,isWritableNodeStream,isWritableStream,isWritableEnded,isWritableFinished:function(e,t){if(!isWritableNodeStream(e))return null;if(!0===e.writableFinished)return!0;let r=e._writableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.finished)?null:!!(r.finished||!1===t&&!0===r.ended&&0===r.length))},isWritableErrored:function(e){var t,r;return isNodeStream(e)?e.writableErrored?e.writableErrored:null!==(t=null===(r=e._writableState)||void 0===r?void 0:r.errored)&&void 0!==t?t:null:null},isServerRequest:function(e){var t;return"boolean"==typeof e._consuming&&"boolean"==typeof e._dumped&&(null===(t=e.req)||void 0===t?void 0:t.upgradeOrConnect)===void 0},isServerResponse,willEmitClose:function(e){if(!isNodeStream(e))return null;let t=e._writableState,r=e._readableState,n=t||r;return!n&&isServerResponse(e)||!!(n&&n.autoDestroy&&n.emitClose&&!1===n.closed)},isTransformStream}},46256:function(e,t,r){let n;"use strict";let i=r(34155),{ArrayPrototypeSlice:o,Error:a,FunctionPrototypeSymbolHasInstance:s,ObjectDefineProperty:l,ObjectDefineProperties:d,ObjectSetPrototypeOf:u,StringPrototypeToLowerCase:c,Symbol:h,SymbolHasInstance:f}=r(1218);e.exports=Writable,Writable.WritableState=WritableState;let{EventEmitter:p}=r(17187),b=r(6647).Stream,{Buffer:g}=r(48764),m=r(89552),{addAbortSignal:w}=r(9173),{getHighWaterMark:y,getDefaultHighWaterMark:_}=r(76589),{ERR_INVALID_ARG_TYPE:v,ERR_METHOD_NOT_IMPLEMENTED:S,ERR_MULTIPLE_CALLBACK:R,ERR_STREAM_CANNOT_PIPE:T,ERR_STREAM_DESTROYED:A,ERR_STREAM_ALREADY_FINISHED:C,ERR_STREAM_NULL_VALUES:I,ERR_STREAM_WRITE_AFTER_END:k,ERR_UNKNOWN_ENCODING:P}=r(80935).codes,{errorOrDestroy:x}=m;function nop(){}u(Writable.prototype,b.prototype),u(Writable,b);let M=h("kOnFinished");function WritableState(e,t,n){"boolean"!=typeof n&&(n=t instanceof r(29613)),this.objectMode=!!(e&&e.objectMode),n&&(this.objectMode=this.objectMode||!!(e&&e.writableObjectMode)),this.highWaterMark=e?y(this,e,"writableHighWaterMark",n):_(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;let i=!!(e&&!1===e.decodeStrings);this.decodeStrings=!i,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=onwrite.bind(void 0,t),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,resetBuffer(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[M]=[]}function resetBuffer(e){e.buffered=[],e.bufferedIndex=0,e.allBuffers=!0,e.allNoop=!0}function Writable(e){let t=this instanceof r(29613);if(!t&&!s(Writable,this))return new Writable(e);this._writableState=new WritableState(e,this,t),e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&w(e.signal,this)),b.call(this,e),m.construct(this,()=>{let e=this._writableState;e.writing||clearBuffer(this,e),finishMaybe(this,e)})}function _write(e,t,r,n){let o;let a=e._writableState;if("function"==typeof r)n=r,r=a.defaultEncoding;else{if(r){if("buffer"!==r&&!g.isEncoding(r))throw new P(r)}else r=a.defaultEncoding;"function"!=typeof n&&(n=nop)}if(null===t)throw new I;if(!a.objectMode){if("string"==typeof t)!1!==a.decodeStrings&&(t=g.from(t,r),r="buffer");else if(t instanceof g)r="buffer";else if(b._isUint8Array(t))t=b._uint8ArrayToBuffer(t),r="buffer";else throw new v("chunk",["string","Buffer","Uint8Array"],t)}return(a.ending?o=new k:a.destroyed&&(o=new A("write")),o)?(i.nextTick(n,o),x(e,o,!0),o):(a.pendingcb++,function(e,t,r,n,i){let o=t.objectMode?1:r.length;t.length+=o;let a=t.length<t.highWaterMark;return a||(t.needDrain=!0),t.writing||t.corked||t.errored||!t.constructed?(t.buffered.push({chunk:r,encoding:n,callback:i}),t.allBuffers&&"buffer"!==n&&(t.allBuffers=!1),t.allNoop&&i!==nop&&(t.allNoop=!1)):(t.writelen=o,t.writecb=i,t.writing=!0,t.sync=!0,e._write(r,n,t.onwrite),t.sync=!1),a&&!t.errored&&!t.destroyed}(e,a,t,r,n))}function doWrite(e,t,r,n,i,o,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new A("write")):r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function onwriteError(e,t,r,n){--t.pendingcb,n(r),errorBuffer(t),x(e,r)}function onwrite(e,t){let r=e._writableState,n=r.sync,o=r.writecb;if("function"!=typeof o){x(e,new R);return}r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0,t?(t.stack,r.errored||(r.errored=t),e._readableState&&!e._readableState.errored&&(e._readableState.errored=t),n?i.nextTick(onwriteError,e,r,t,o):onwriteError(e,r,t,o)):(r.buffered.length>r.bufferedIndex&&clearBuffer(e,r),n?null!==r.afterWriteTickInfo&&r.afterWriteTickInfo.cb===o?r.afterWriteTickInfo.count++:(r.afterWriteTickInfo={count:1,cb:o,stream:e,state:r},i.nextTick(afterWriteTick,r.afterWriteTickInfo)):afterWrite(e,r,1,o))}function afterWriteTick({stream:e,state:t,count:r,cb:n}){return t.afterWriteTickInfo=null,afterWrite(e,t,r,n)}function afterWrite(e,t,r,n){let i=!t.ending&&!e.destroyed&&0===t.length&&t.needDrain;for(i&&(t.needDrain=!1,e.emit("drain"));r-- >0;)t.pendingcb--,n();t.destroyed&&errorBuffer(t),finishMaybe(e,t)}function errorBuffer(e){var t,r;if(e.writing)return;for(let r=e.bufferedIndex;r<e.buffered.length;++r){let{chunk:n,callback:i}=e.buffered[r],o=e.objectMode?1:n.length;e.length-=o,i(null!==(t=e.errored)&&void 0!==t?t:new A("write"))}let n=e[M].splice(0);for(let t=0;t<n.length;t++)n[t](null!==(r=e.errored)&&void 0!==r?r:new A("end"));resetBuffer(e)}function clearBuffer(e,t){if(t.corked||t.bufferProcessing||t.destroyed||!t.constructed)return;let{buffered:r,bufferedIndex:n,objectMode:i}=t,a=r.length-n;if(!a)return;let s=n;if(t.bufferProcessing=!0,a>1&&e._writev){t.pendingcb-=a-1;let n=t.allNoop?nop:e=>{for(let t=s;t<r.length;++t)r[t].callback(e)},i=t.allNoop&&0===s?r:o(r,s);i.allBuffers=t.allBuffers,doWrite(e,t,!0,t.length,i,"",n),resetBuffer(t)}else{do{let{chunk:n,encoding:o,callback:a}=r[s];r[s++]=null;let l=i?1:n.length;doWrite(e,t,!1,l,n,o,a)}while(s<r.length&&!t.writing);s===r.length?resetBuffer(t):s>256?(r.splice(0,s),t.bufferedIndex=0):t.bufferedIndex=s}t.bufferProcessing=!1}function needFinish(e){return e.ending&&!e.destroyed&&e.constructed&&0===e.length&&!e.errored&&0===e.buffered.length&&!e.finished&&!e.writing&&!e.errorEmitted&&!e.closeEmitted}function finishMaybe(e,t,r){needFinish(t)&&(t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.finalCalled=!0,function(e,t){let r=!1;function onFinish(n){if(r){x(e,null!=n?n:R());return}if(r=!0,t.pendingcb--,n){let r=t[M].splice(0);for(let e=0;e<r.length;e++)r[e](n);x(e,n,t.sync)}else needFinish(t)&&(t.prefinished=!0,e.emit("prefinish"),t.pendingcb++,i.nextTick(finish,e,t))}t.sync=!0,t.pendingcb++;try{e._final(onFinish)}catch(e){onFinish(e)}t.sync=!1}(e,t))),0===t.pendingcb&&(r?(t.pendingcb++,i.nextTick((e,t)=>{needFinish(t)?finish(e,t):t.pendingcb--},e,t)):needFinish(t)&&(t.pendingcb++,finish(e,t))))}function finish(e,t){t.pendingcb--,t.finished=!0;let r=t[M].splice(0);for(let e=0;e<r.length;e++)r[e]();if(e.emit("finish"),t.autoDestroy){let t=e._readableState,r=!t||t.autoDestroy&&(t.endEmitted||!1===t.readable);r&&e.destroy()}}WritableState.prototype.getBuffer=function(){return o(this.buffered,this.bufferedIndex)},l(WritableState.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}}),l(Writable,f,{__proto__:null,value:function(e){return!!s(this,e)||this===Writable&&e&&e._writableState instanceof WritableState}}),Writable.prototype.pipe=function(){x(this,new T)},Writable.prototype.write=function(e,t,r){return!0===_write(this,e,t,r)},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){let e=this._writableState;e.corked&&(e.corked--,e.writing||clearBuffer(this,e))},Writable.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=c(e)),!g.isEncoding(e))throw new P(e);return this._writableState.defaultEncoding=e,this},Writable.prototype._write=function(e,t,r){if(this._writev)this._writev([{chunk:e,encoding:t}],r);else throw new S("_write()")},Writable.prototype._writev=null,Writable.prototype.end=function(e,t,r){let n;let o=this._writableState;if("function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e){let r=_write(this,e,t);r instanceof a&&(n=r)}return o.corked&&(o.corked=1,this.uncork()),n||(o.errored||o.ending?o.finished?n=new C("end"):o.destroyed&&(n=new A("end")):(o.ending=!0,finishMaybe(this,o,!0),o.ended=!0)),"function"==typeof r&&(n||o.finished?i.nextTick(r,n):o[M].push(r)),this},d(Writable.prototype,{closed:{__proto__:null,get(){return!!this._writableState&&this._writableState.closed}},destroyed:{__proto__:null,get(){return!!this._writableState&&this._writableState.destroyed},set(e){this._writableState&&(this._writableState.destroyed=e)}},writable:{__proto__:null,get(){let e=this._writableState;return!!e&&!1!==e.writable&&!e.destroyed&&!e.errored&&!e.ending&&!e.ended},set(e){this._writableState&&(this._writableState.writable=!!e)}},writableFinished:{__proto__:null,get(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{__proto__:null,get(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{__proto__:null,get(){let e=this._writableState;return!!e&&!e.destroyed&&!e.ending&&e.needDrain}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(!1!==this._writableState.writable&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});let O=m.destroy;function lazyWebStreams(){return void 0===n&&(n={}),n}Writable.prototype.destroy=function(e,t){let r=this._writableState;return!r.destroyed&&(r.bufferedIndex<r.buffered.length||r[M].length)&&i.nextTick(errorBuffer,r),O.call(this,e,t),this},Writable.prototype._undestroy=m.undestroy,Writable.prototype._destroy=function(e,t){t(e)},Writable.prototype[p.captureRejectionSymbol]=function(e){this.destroy(e)},Writable.fromWeb=function(e,t){return lazyWebStreams().newStreamWritableFromWritableStream(e,t)},Writable.toWeb=function(e){return lazyWebStreams().newWritableStreamFromStreamWritable(e)}},49603:function(e,t,r){"use strict";let{ArrayIsArray:n,ArrayPrototypeIncludes:i,ArrayPrototypeJoin:o,ArrayPrototypeMap:a,NumberIsInteger:s,NumberIsNaN:l,NumberMAX_SAFE_INTEGER:d,NumberMIN_SAFE_INTEGER:u,NumberParseInt:c,ObjectPrototypeHasOwnProperty:h,RegExpPrototypeExec:f,String:p,StringPrototypeToUpperCase:b,StringPrototypeTrim:g}=r(1218),{hideStackFrames:m,codes:{ERR_SOCKET_BAD_PORT:w,ERR_INVALID_ARG_TYPE:y,ERR_INVALID_ARG_VALUE:_,ERR_OUT_OF_RANGE:v,ERR_UNKNOWN_SIGNAL:S}}=r(80935),{normalizeEncoding:R}=r(27824),{isAsyncFunction:T,isArrayBufferView:A}=r(27824).types,C={},I=/^[0-7]+$/,k=m((e,t,r=u,n=d)=>{if("number"!=typeof e)throw new y(t,"number",e);if(!s(e))throw new v(t,"an integer",e);if(e<r||e>n)throw new v(t,`>= ${r} && <= ${n}`,e)}),P=m((e,t,r=-2147483648,n=2147483647)=>{if("number"!=typeof e)throw new y(t,"number",e);if(!s(e))throw new v(t,"an integer",e);if(e<r||e>n)throw new v(t,`>= ${r} && <= ${n}`,e)}),x=m((e,t,r=!1)=>{if("number"!=typeof e)throw new y(t,"number",e);if(!s(e))throw new v(t,"an integer",e);let n=r?1:0;if(e<n||e>4294967295)throw new v(t,`>= ${n} && <= 4294967295`,e)});function validateString(e,t){if("string"!=typeof e)throw new y(t,"string",e)}let M=m((e,t,r)=>{if(!i(r,e)){let n=o(a(r,e=>"string"==typeof e?`'${e}'`:p(e)),", ");throw new _(t,e,"must be one of: "+n)}});function validateBoolean(e,t){if("boolean"!=typeof e)throw new y(t,"boolean",e)}function getOwnPropertyValueOrDefault(e,t,r){return null!=e&&h(e,t)?e[t]:r}let O=m((e,t,r=null)=>{let i=getOwnPropertyValueOrDefault(r,"allowArray",!1),o=getOwnPropertyValueOrDefault(r,"allowFunction",!1),a=getOwnPropertyValueOrDefault(r,"nullable",!1);if(!a&&null===e||!i&&n(e)||"object"!=typeof e&&(!o||"function"!=typeof e))throw new y(t,"Object",e)}),N=m((e,t)=>{if(null!=e&&"object"!=typeof e&&"function"!=typeof e)throw new y(t,"a dictionary",e)}),W=m((e,t,r=0)=>{if(!n(e))throw new y(t,"Array",e);if(e.length<r){let n=`must be longer than ${r}`;throw new _(t,e,n)}}),D=m((e,t="buffer")=>{if(!A(e))throw new y(t,["Buffer","TypedArray","DataView"],e)}),L=m((e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new y(t,"AbortSignal",e)}),j=m((e,t)=>{if("function"!=typeof e)throw new y(t,"Function",e)}),F=m((e,t)=>{if("function"!=typeof e||T(e))throw new y(t,"Function",e)}),$=m((e,t)=>{if(void 0!==e)throw new y(t,"undefined",e)}),q=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function validateLinkHeaderFormat(e,t){if(void 0===e||!f(q,e))throw new _(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}e.exports={isInt32:function(e){return e===(0|e)},isUint32:function(e){return e===e>>>0},parseFileMode:function(e,t,r){if(void 0===e&&(e=r),"string"==typeof e){if(null===f(I,e))throw new _(t,e,"must be a 32-bit unsigned integer or an octal string");e=c(e,8)}return x(e,t),e},validateArray:W,validateStringArray:function(e,t){W(e,t);for(let r=0;r<e.length;r++)validateString(e[r],`${t}[${r}]`)},validateBooleanArray:function(e,t){W(e,t);for(let r=0;r<e.length;r++)validateBoolean(e[r],`${t}[${r}]`)},validateBoolean,validateBuffer:D,validateDictionary:N,validateEncoding:function(e,t){let r=R(t),n=e.length;if("hex"===r&&n%2!=0)throw new _("encoding",t,`is invalid for data of length ${n}`)},validateFunction:j,validateInt32:P,validateInteger:k,validateNumber:function(e,t,r,n){if("number"!=typeof e)throw new y(t,"number",e);if(null!=r&&e<r||null!=n&&e>n||(null!=r||null!=n)&&l(e))throw new v(t,`${null!=r?`>= ${r}`:""}${null!=r&&null!=n?" && ":""}${null!=n?`<= ${n}`:""}`,e)},validateObject:O,validateOneOf:M,validatePlainFunction:F,validatePort:function(e,t="Port",r=!0){if("number"!=typeof e&&"string"!=typeof e||"string"==typeof e&&0===g(e).length||+e!=+e>>>0||e>65535||0===e&&!r)throw new w(t,e,r);return 0|e},validateSignalName:function(e,t="signal"){if(validateString(e,t),void 0===C[e]){if(void 0!==C[b(e)])throw new S(e+" (signals must use all capital letters)");throw new S(e)}},validateString,validateUint32:x,validateUndefined:$,validateUnion:function(e,t,r){if(!i(r,e))throw new y(t,`('${o(r,"|")}')`,e)},validateAbortSignal:L,validateLinkHeaderValue:function(e){if("string"==typeof e)return validateLinkHeaderFormat(e,"hints"),e;if(n(e)){let t=e.length,r="";if(0===t)return r;for(let n=0;n<t;n++){let i=e[n];validateLinkHeaderFormat(i,"hints"),r+=i,n!==t-1&&(r+=", ")}return r}throw new _("hints",e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}}},30945:function(e,t,r){"use strict";let n=r(35164),i=r(87952),o=n.Readable.destroy;e.exports=n.Readable,e.exports._uint8ArrayToBuffer=n._uint8ArrayToBuffer,e.exports._isUint8Array=n._isUint8Array,e.exports.isDisturbed=n.isDisturbed,e.exports.isErrored=n.isErrored,e.exports.isReadable=n.isReadable,e.exports.Readable=n.Readable,e.exports.Writable=n.Writable,e.exports.Duplex=n.Duplex,e.exports.Transform=n.Transform,e.exports.PassThrough=n.PassThrough,e.exports.addAbortSignal=n.addAbortSignal,e.exports.finished=n.finished,e.exports.destroy=n.destroy,e.exports.destroy=o,e.exports.pipeline=n.pipeline,e.exports.compose=n.compose,Object.defineProperty(n,"promises",{configurable:!0,enumerable:!0,get:()=>i}),e.exports.Stream=n.Stream,e.exports.default=e.exports},80935:function(e,t,r){"use strict";let{format:n,inspect:i,AggregateError:o}=r(27824),a=globalThis.AggregateError||o,s=Symbol("kIsNodeError"),l=["string","function","number","object","Function","Object","boolean","bigint","symbol"],d=/^([A-Z][a-z0-9]*)+$/,u={};function assert(e,t){if(!e)throw new u.ERR_INTERNAL_ASSERTION(t)}function addNumericalSeparator(e){let t="",r=e.length,n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function E(e,t,r){r||(r=Error);let NodeError=class NodeError extends r{constructor(...r){super(function(e,t,r){if("function"==typeof t)return assert(t.length<=r.length,`Code: ${e}; The provided arguments length (${r.length}) does not match the required ones (${t.length}).`),t(...r);let i=(t.match(/%[dfijoOs]/g)||[]).length;return(assert(i===r.length,`Code: ${e}; The provided arguments length (${r.length}) does not match the required ones (${i}).`),0===r.length)?t:n(t,...r)}(e,t,r))}toString(){return`${this.name} [${e}]: ${this.message}`}};Object.defineProperties(NodeError.prototype,{name:{value:r.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),NodeError.prototype.code=e,NodeError.prototype[s]=!0,u[e]=NodeError}function hideStackFrames(e){let t="__node_internal_"+e.name;return Object.defineProperty(e,"name",{value:t}),e}E("ERR_ASSERTION","%s",Error),E("ERR_INVALID_ARG_TYPE",(e,t,r)=>{assert("string"==typeof e,"'name' must be a string"),Array.isArray(t)||(t=[t]);let n="The ";e.endsWith(" argument")?n+=`${e} `:n+=`"${e}" ${e.includes(".")?"property":"argument"} `,n+="must be ";let o=[],a=[],s=[];for(let e of t)assert("string"==typeof e,"All expected entries have to be of type string"),l.includes(e)?o.push(e.toLowerCase()):d.test(e)?a.push(e):(assert("object"!==e,'The value "object" should be written as "Object"'),s.push(e));if(a.length>0){let e=o.indexOf("object");-1!==e&&(o.splice(o,e,1),a.push("Object"))}if(o.length>0){switch(o.length){case 1:n+=`of type ${o[0]}`;break;case 2:n+=`one of type ${o[0]} or ${o[1]}`;break;default:{let e=o.pop();n+=`one of type ${o.join(", ")}, or ${e}`}}(a.length>0||s.length>0)&&(n+=" or ")}if(a.length>0){switch(a.length){case 1:n+=`an instance of ${a[0]}`;break;case 2:n+=`an instance of ${a[0]} or ${a[1]}`;break;default:{let e=a.pop();n+=`an instance of ${a.join(", ")}, or ${e}`}}s.length>0&&(n+=" or ")}switch(s.length){case 0:break;case 1:s[0].toLowerCase()!==s[0]&&(n+="an "),n+=`${s[0]}`;break;case 2:n+=`one of ${s[0]} or ${s[1]}`;break;default:{let e=s.pop();n+=`one of ${s.join(", ")}, or ${e}`}}if(null==r)n+=`. Received ${r}`;else if("function"==typeof r&&r.name)n+=`. Received function ${r.name}`;else if("object"==typeof r){var u;if(null!==(u=r.constructor)&&void 0!==u&&u.name)n+=`. Received an instance of ${r.constructor.name}`;else{let e=i(r,{depth:-1});n+=`. Received ${e}`}}else{let e=i(r,{colors:!1});e.length>25&&(e=`${e.slice(0,25)}...`),n+=`. Received type ${typeof r} (${e})`}return n},TypeError),E("ERR_INVALID_ARG_VALUE",(e,t,r="is invalid")=>{let n=i(t);n.length>128&&(n=n.slice(0,128)+"...");let o=e.includes(".")?"property":"argument";return`The ${o} '${e}' ${r}. Received ${n}`},TypeError),E("ERR_INVALID_RETURN_VALUE",(e,t,r)=>{var n;let i=null!=r&&null!==(n=r.constructor)&&void 0!==n&&n.name?`instance of ${r.constructor.name}`:`type ${typeof r}`;return`Expected ${e} to be returned from the "${t}" function but got ${i}.`},TypeError),E("ERR_MISSING_ARGS",(...e)=>{let t;assert(e.length>0,"At least one arg needs to be specified");let r=e.length;switch(e=(Array.isArray(e)?e:[e]).map(e=>`"${e}"`).join(" or "),r){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{let r=e.pop();t+=`The ${e.join(", ")}, and ${r} arguments`}}return`${t} must be specified`},TypeError),E("ERR_OUT_OF_RANGE",(e,t,r)=>{let n;return assert(t,'Missing "range" argument'),Number.isInteger(r)&&Math.abs(r)>4294967296?n=addNumericalSeparator(String(r)):"bigint"==typeof r?(n=String(r),(r>2n**32n||r<-(2n**32n))&&(n=addNumericalSeparator(n)),n+="n"):n=i(r),`The value of "${e}" is out of range. It must be ${t}. Received ${n}`},RangeError),E("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),E("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),E("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),E("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),E("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),E("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),E("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),E("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),E("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),E("ERR_STREAM_WRITE_AFTER_END","write after end",Error),E("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),e.exports={AbortError:class extends Error{constructor(e="The operation was aborted",t){if(void 0!==t&&"object"!=typeof t)throw new u.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}},aggregateTwoErrors:hideStackFrames(function(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;let r=new a([t,e],t.message);return r.code=t.code,r}return e||t}),hideStackFrames,codes:u}},1218:function(e){"use strict";e.exports={ArrayIsArray:e=>Array.isArray(e),ArrayPrototypeIncludes:(e,t)=>e.includes(t),ArrayPrototypeIndexOf:(e,t)=>e.indexOf(t),ArrayPrototypeJoin:(e,t)=>e.join(t),ArrayPrototypeMap:(e,t)=>e.map(t),ArrayPrototypePop:(e,t)=>e.pop(t),ArrayPrototypePush:(e,t)=>e.push(t),ArrayPrototypeSlice:(e,t,r)=>e.slice(t,r),Error,FunctionPrototypeCall:(e,t,...r)=>e.call(t,...r),FunctionPrototypeSymbolHasInstance:(e,t)=>Function.prototype[Symbol.hasInstance].call(e,t),MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties:(e,t)=>Object.defineProperties(e,t),ObjectDefineProperty:(e,t,r)=>Object.defineProperty(e,t,r),ObjectGetOwnPropertyDescriptor:(e,t)=>Object.getOwnPropertyDescriptor(e,t),ObjectKeys:e=>Object.keys(e),ObjectSetPrototypeOf:(e,t)=>Object.setPrototypeOf(e,t),Promise,PromisePrototypeCatch:(e,t)=>e.catch(t),PromisePrototypeThen:(e,t,r)=>e.then(t,r),PromiseReject:e=>Promise.reject(e),ReflectApply:Reflect.apply,RegExpPrototypeTest:(e,t)=>e.test(t),SafeSet:Set,String,StringPrototypeSlice:(e,t,r)=>e.slice(t,r),StringPrototypeToLowerCase:e=>e.toLowerCase(),StringPrototypeToUpperCase:e=>e.toUpperCase(),StringPrototypeTrim:e=>e.trim(),Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet:(e,t,r)=>e.set(t,r),Uint8Array}},27824:function(e,t,r){"use strict";let n=r(48764),i=Object.getPrototypeOf(async function(){}).constructor,o=globalThis.Blob||n.Blob;e.exports={AggregateError:class extends Error{constructor(e){if(!Array.isArray(e))throw TypeError(`Expected input to be an Array, got ${typeof e}`);let t="";for(let r=0;r<e.length;r++)t+=`    ${e[r].stack}
`;super(t),this.name="AggregateError",this.errors=e}},kEmptyObject:Object.freeze({}),once(e){let t=!1;return function(...r){t||(t=!0,e.apply(this,r))}},createDeferredPromise:function(){let e,t;let r=new Promise((r,n)=>{e=r,t=n});return{promise:r,resolve:e,reject:t}},promisify:e=>new Promise((t,r)=>{e((e,...n)=>e?r(e):t(...n))}),debuglog:()=>function(){},format:(e,...t)=>e.replace(/%([sdifj])/g,function(...[e,r]){let n=t.shift();if("f"===r)return n.toFixed(6);if("j"===r)return JSON.stringify(n);if("s"!==r||"object"!=typeof n)return n.toString();{let e=n.constructor!==Object?n.constructor.name:"";return`${e} {}`.trim()}}),inspect(e){switch(typeof e){case"string":if(e.includes("'")){if(!e.includes('"'))return`"${e}"`;if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}return`'${e}'`;case"number":if(isNaN(e))return"NaN";if(Object.is(e,-0))return String(e);return e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}},types:{isAsyncFunction:e=>e instanceof i,isArrayBufferView:e=>ArrayBuffer.isView(e)},isBlob:void 0!==o?function(e){return e instanceof o}:function(e){return!1}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")},35164:function(e,t,r){"use strict";let{Buffer:n}=r(48764),{ObjectDefineProperty:i,ObjectKeys:o,ReflectApply:a}=r(1218),{promisify:{custom:s}}=r(27824),{streamReturningOperators:l,promiseReturningOperators:d}=r(29455),{codes:{ERR_ILLEGAL_CONSTRUCTOR:u}}=r(80935),c=r(30162),{pipeline:h}=r(63208),{destroyer:f}=r(89552),p=r(8398),b=r(87952),g=r(82275),m=e.exports=r(6647).Stream;for(let e of(m.isDisturbed=g.isDisturbed,m.isErrored=g.isErrored,m.isReadable=g.isReadable,m.Readable=r(46766),o(l))){let t=l[e];function fn(...e){if(new.target)throw u();return m.Readable.from(a(t,this,e))}i(fn,"name",{__proto__:null,value:t.name}),i(fn,"length",{__proto__:null,value:t.length}),i(m.Readable.prototype,e,{__proto__:null,value:fn,enumerable:!1,configurable:!0,writable:!0})}for(let e of o(d)){let t=d[e];function fn(...e){if(new.target)throw u();return a(t,this,e)}i(fn,"name",{__proto__:null,value:t.name}),i(fn,"length",{__proto__:null,value:t.length}),i(m.Readable.prototype,e,{__proto__:null,value:fn,enumerable:!1,configurable:!0,writable:!0})}m.Writable=r(46256),m.Duplex=r(29613),m.Transform=r(30567),m.PassThrough=r(76818),m.pipeline=h;let{addAbortSignal:w}=r(9173);m.addAbortSignal=w,m.finished=p,m.destroy=f,m.compose=c,i(m,"promises",{__proto__:null,configurable:!0,enumerable:!0,get:()=>b}),i(h,s,{__proto__:null,enumerable:!0,get:()=>b.pipeline}),i(p,s,{__proto__:null,enumerable:!0,get:()=>b.finished}),m.Stream=m,m._isUint8Array=function(e){return e instanceof Uint8Array},m._uint8ArrayToBuffer=function(e){return n.from(e.buffer,e.byteOffset,e.byteLength)}},87952:function(e,t,r){"use strict";let{ArrayPrototypePop:n,Promise:i}=r(1218),{isIterable:o,isNodeStream:a,isWebStream:s}=r(82275),{pipelineImpl:l}=r(63208),{finished:d}=r(8398);r(35164),e.exports={finished:d,pipeline:function(...e){return new i((t,r)=>{let i,d;let u=e[e.length-1];if(u&&"object"==typeof u&&!a(u)&&!o(u)&&!s(u)){let t=n(e);i=t.signal,d=t.end}l(e,(e,n)=>{e?r(e):t(n)},{signal:i,end:d})})}}},1482:function(e,t,r){"use strict";r.d(t,{v:function(){return BaseSolanaAdapter}});var n=r(85783),i=r(37202),o=r.n(i);let BaseSolanaAdapter=class BaseSolanaAdapter extends n.J5{async init(e){this.chainConfig||(this.chainConfig=(0,n.h2)(n.EN.SOLANA,1))}async authenticateUser(){if(!this.provider||this.status!==n.MP.CONNECTED)throw n.RM.notConnectedError();let{chainNamespace:e,chainId:t}=this.chainConfig,r=await this.provider.request({method:"getAccounts"});if(r&&r.length>0){let i=(0,n.Cb)(r[0],this.name);if(i){let e=(0,n.$E)(i);if(!e)return{idToken:i}}let a={domain:window.location.origin,uri:window.location.href,address:r[0],chainId:parseInt(t,16),version:"1",nonce:Math.random().toString(36).slice(2),issuedAt:new Date().toISOString()},s=await (0,n.tV)(a,e),l=new TextEncoder().encode(s),d=await this.provider.request({method:"signMessage",params:{message:l,display:"utf8"}}),u=await (0,n.rn)(e,o().encode(d),s,this.name,this.sessionTime,this.clientId,this.web3AuthNetwork);return(0,n.Fr)(r[0],this.name,u),{idToken:u}}throw n.RM.notConnectedError("Not connected with wallet, Please login/connect first")}async disconnectSession(){super.checkDisconnectionRequirements();let e=await this.provider.request({method:"getAccounts"});e&&e.length>0&&(0,n.qz)(e[0],this.name)}async disconnect(){this.rehydrated=!1,this.emit(n.n2.DISCONNECTED)}}},55777:function(e){"use strict";e.exports=function(e){if(e.length>=255)throw TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var n=0;n<e.length;n++){var i=e.charAt(n),o=i.charCodeAt(0);if(255!==t[o])throw TypeError(i+" is ambiguous");t[o]=n}var a=e.length,s=e.charAt(0),l=Math.log(a)/Math.log(256),d=Math.log(256)/Math.log(a);function decodeUnsafe(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;for(var r=0,n=0,i=0;e[r]===s;)n++,r++;for(var o=(e.length-r)*l+1>>>0,d=new Uint8Array(o);e[r];){var u=t[e.charCodeAt(r)];if(255===u)return;for(var c=0,h=o-1;(0!==u||c<i)&&-1!==h;h--,c++)u+=a*d[h]>>>0,d[h]=u%256>>>0,u=u/256>>>0;if(0!==u)throw Error("Non-zero carry");i=c,r++}for(var f=o-i;f!==o&&0===d[f];)f++;for(var p=new Uint8Array(n+(o-f)),b=n;f!==o;)p[b++]=d[f++];return p}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var l=(o-i)*d+1>>>0,u=new Uint8Array(l);i!==o;){for(var c=t[i],h=0,f=l-1;(0!==c||h<n)&&-1!==f;f--,h++)c+=256*u[f]>>>0,u[f]=c%a>>>0,c=c/a>>>0;if(0!==c)throw Error("Non-zero carry");n=h,i++}for(var p=l-n;p!==l&&0===u[p];)p++;for(var b=s.repeat(r);p<l;++p)b+=e.charAt(u[p]);return b},decodeUnsafe:decodeUnsafe,decode:function(e){var t=decodeUnsafe(e);if(t)return t;throw Error("Non-base"+a+" character")}}}},37202:function(e,t,r){let n=r(55777);e.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},91987:function(e,t,r){"use strict";r.d(t,{SolanaWalletAdapter:function(){return SolanaWalletAdapter}});var n=r(1413),i=r(81180),o=r(59917),a=r(24327),s=r(20917),l=r(30945),d=r(17187),u=r(4445),c=r.n(u),h=r(39428),f=r(12840),p=r.n(f),b=r(30778),g=r.n(b),m=r(74286),w=r.n(m);function noop(){}let BasePostMessageStream=class BasePostMessageStream extends l.Duplex{constructor(e){let{name:t,target:r,targetWindow:n=window,targetOrigin:o="*"}=e;if(super({objectMode:!0}),(0,i.Z)(this,"_init",void 0),(0,i.Z)(this,"_haveSyn",void 0),(0,i.Z)(this,"_name",void 0),(0,i.Z)(this,"_target",void 0),(0,i.Z)(this,"_targetWindow",void 0),(0,i.Z)(this,"_targetOrigin",void 0),(0,i.Z)(this,"_onMessage",void 0),(0,i.Z)(this,"_synIntervalId",void 0),!t||!r)throw Error("Invalid input.");this._init=!1,this._haveSyn=!1,this._name=t,this._target=r,this._targetWindow=n,this._targetOrigin=o,this._onMessage=this.onMessage.bind(this),this._synIntervalId=null,window.addEventListener("message",this._onMessage,!1),this._handShake()}_break(){this.cork(),this._write("BRK",null,noop),this._haveSyn=!1,this._init=!1}_handShake(){this._write("SYN",null,noop),this.cork()}_onData(e){if(this._init){if("BRK"===e)this._break();else try{this.push(e)}catch(e){this.emit("error",e)}}else"SYN"===e?(this._haveSyn=!0,this._write("ACK",null,noop)):"ACK"===e&&(this._init=!0,this._haveSyn||this._write("ACK",null,noop),this.uncork())}_postMessage(e){let t=this._targetOrigin;this._targetWindow.postMessage({target:this._target,data:e},t)}onMessage(e){let t=e.data;("*"===this._targetOrigin||e.origin===this._targetOrigin)&&e.source===this._targetWindow&&"object"==typeof t&&t.target===this._name&&t.data&&this._onData(t.data)}_read(){}_write(e,t,r){this._postMessage(e),r()}_destroy(){window.removeEventListener("message",this._onMessage,!1)}};function safeApply(e,t,r){try{Reflect.apply(e,t,r)}catch(e){setTimeout(()=>{throw e})}}let SafeEventEmitter=class SafeEventEmitter extends d.EventEmitter{emit(e){let t="error"===e,r=this._events;if(void 0!==r)t=t&&void 0===r.error;else if(!t)return!1;for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];if(t){let e;if(i.length>0&&([e]=i),e instanceof Error)throw e;let t=Error(`Unhandled error.${e?` (${e.message})`:""}`);throw t.context=e,t}let a=r[e];if(void 0===a)return!1;if("function"==typeof a)safeApply(a,this,i);else{let e=a.length,t=function(e){let t=e.length,r=Array(t);for(let n=0;n<t;n+=1)r[n]=e[n];return r}(a);for(let r=0;r<e;r+=1)safeApply(t[r],this,i)}return!0}};let SerializableError=class SerializableError extends Error{constructor(e){let{code:t,message:r,data:n}=e;if(!Number.isInteger(t))throw Error("code must be an integer");if(!r||"string"!=typeof r)throw Error("message must be string");super(r),(0,i.Z)(this,"code",void 0),(0,i.Z)(this,"data",void 0),this.code=t,void 0!==n&&(this.data=n)}toString(){return c()({code:this.code,message:this.message,data:this.data,stack:this.stack})}};let getRpcPromiseCallback=function(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return(n,i)=>{n||i.error?t(n||i.error):!r||Array.isArray(i)?e(i):e(i.result)}};let JRPCEngine=class JRPCEngine extends SafeEventEmitter{constructor(){super(),(0,i.Z)(this,"_middleware",void 0),this._middleware=[]}static async _runAllMiddleware(e,t,r){let n=[],i=null,o=!1;for(let a of r)if([i,o]=await JRPCEngine._runMiddleware(e,t,a,n),o)break;return[i,o,n.reverse()]}static _runMiddleware(e,t,r,n){return new Promise(i=>{let end=e=>{let r=e||t.error;r&&(t.error=(0,h.Xy)(r)),i([r,!0])};try{r(e,t,e=>{t.error?end(t.error):(e&&("function"!=typeof e&&end(new SerializableError({code:-32603,message:"JRPCEngine: 'next' return handlers must be functions"})),n.push(e)),i([null,!1]))},end)}catch(e){end(e)}})}static async _runReturnHandlers(e){for(let t of e)await new Promise((e,r)=>{t(t=>t?r(t):e())})}static _checkForCompletion(e,t,r){if(!("result"in t)&&!("error"in t))throw new SerializableError({code:-32603,message:"Response has no error or result for request"});if(!r)throw new SerializableError({code:-32603,message:"Nothing ended request"})}push(e){this._middleware.push(e)}handle(e,t){if(t&&"function"!=typeof t)throw Error('"callback" must be a function if provided.');return Array.isArray(e)?t?this._handleBatch(e,t):this._handleBatch(e):t?this._handle(e,t):this._promiseHandle(e)}asMiddleware(){return async(e,t,r,n)=>{try{let[i,o,a]=await JRPCEngine._runAllMiddleware(e,t,this._middleware);if(o)return await JRPCEngine._runReturnHandlers(a),n(i);return r(async e=>{try{await JRPCEngine._runReturnHandlers(a)}catch(t){return e(t)}return e()})}catch(e){return n(e)}}}async _handleBatch(e,t){try{let r=await Promise.all(e.map(this._promiseHandle.bind(this)));if(t)return t(null,r);return r}catch(e){if(t)return t(e);throw e}}_promiseHandle(e){return new Promise(t=>{this._handle(e,(e,r)=>{t(r)})})}async _handle(e,t){if(!e||Array.isArray(e)||"object"!=typeof e){let e=new SerializableError({code:-32603,message:"request must be plain object"});return t(e,{id:void 0,jsonrpc:"2.0",error:e})}if("string"!=typeof e.method){let r=new SerializableError({code:-32603,message:"method must be string"});return t(r,{id:e.id,jsonrpc:"2.0",error:r})}let r=(0,n.Z)({},e),i={id:r.id,jsonrpc:r.jsonrpc},o=null;try{await this._processRequest(r,i)}catch(e){o=e}return o&&(delete i.result,i.error||(i.error=(0,h.Xy)(o))),t(o,i)}async _processRequest(e,t){let[r,n,i]=await JRPCEngine._runAllMiddleware(e,t,this._middleware);if(JRPCEngine._checkForCompletion(e,t,n),await JRPCEngine._runReturnHandlers(i),r)throw r}};let Substream=class Substream extends l.Duplex{constructor(e){let{parent:t,name:r}=e;super({objectMode:!0}),(0,i.Z)(this,"_parent",void 0),(0,i.Z)(this,"_name",void 0),this._parent=t,this._name=r}_read(){}_write(e,t,r){this._parent.push({name:this._name,data:e}),r()}};let y=Symbol("IGNORE_SUBSTREAM");let ObjectMultiplex=class ObjectMultiplex extends l.Duplex{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super((0,n.Z)((0,n.Z)({},e),{},{objectMode:!0})),(0,i.Z)(this,"_substreams",void 0),(0,i.Z)(this,"getStream",void 0),this._substreams={}}createStream(e){if(!e)throw Error("ObjectMultiplex - name must not be empty");if(this._substreams[e])throw Error(`ObjectMultiplex - Substream for name "${e}" already exists`);let t=new Substream({parent:this,name:e});return this._substreams[e]=t,function(e,t){let r=g()(t);p()(e,{readable:!1},r),p()(e,{writable:!1},r)}(this,e=>t.destroy(e||void 0)),t}ignoreStream(e){if(!e)throw Error("ObjectMultiplex - name must not be empty");if(this._substreams[e])throw Error(`ObjectMultiplex - Substream for name "${e}" already exists`);this._substreams[e]=y}_read(){}_write(e,t,r){let{name:n,data:i}=e;if(!n)return window.console.warn(`ObjectMultiplex - malformed chunk without name "${e}"`),r();let o=this._substreams[n];return o?o!==y&&o.push(i):window.console.warn(`ObjectMultiplex - orphaned data for stream "${n}"`),r()}};var _=r(79826),v=r(2043),S=r.n(v),R=r(64063),T=r.n(R),A=r(48764).Buffer;function isStream(e){return null!==e&&"object"==typeof e&&"function"==typeof e.pipe}var C={errors:{disconnected:()=>"Torus: Lost connection to Torus.",permanentlyDisconnected:()=>"Torus: Disconnected from iframe. Page reload required.",unsupportedSync:e=>`Torus: The Torus Ethereum provider does not support synchronous methods like ${e} without a callback parameter.`,invalidDuplexStream:()=>"Must provide a Node.js-style duplex stream.",invalidOptions:e=>`Invalid options. Received: { maxEventListeners: ${e}}`,invalidRequestArgs:()=>"Expected a single, non-array, object argument.",invalidRequestMethod:()=>"'args.method' must be a non-empty string.",invalidRequestParams:()=>"'args.params' must be an object or array if provided.",invalidLoggerObject:()=>"'args.logger' must be an object if provided.",invalidLoggerMethod:e=>`'args.logger' must include required method '${e}'.`},info:{connected:e=>`Torus: Connected to chain with ID "${e}".`}};let I={BOTTOM_LEFT:"bottom-left",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",TOP_RIGHT:"top-right"},k={GOOGLE:"google",REDDIT:"reddit",DISCORD:"discord"};var P={supportedVerifierList:[k.GOOGLE,k.REDDIT,k.DISCORD],api:"https://api.tor.us",translations:{en:{embed:{continue:"Continue",actionRequired:"Authorization required",pendingAction:"Click continue to proceed with your request in a popup",cookiesRequired:"Cookies Required",enableCookies:"Please enable cookies in your browser preferences to access Torus",clickHere:"More Info"}},de:{embed:{continue:"Fortsetzen",actionRequired:"Autorisierung erforderlich",pendingAction:"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren",cookiesRequired:"Cookies ben\xf6tigt",enableCookies:"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen",clickHere:"Mehr Info"}},ja:{embed:{continue:"継続する",actionRequired:"認証が必要です",pendingAction:"続行をクリックして、ポップアップでリクエストを続行します",cookiesRequired:"必要なクッキー",enableCookies:"Torusにアクセスするには、ブラウザの設定でCookieを有効にしてください。",clickHere:"詳しくは"}},ko:{embed:{continue:"계속하다",actionRequired:"승인 필요",pendingAction:"팝업에서 요청을 진행하려면 계속을 클릭하십시오.",cookiesRequired:"쿠키 필요",enableCookies:"브라우저 환경 설정에서 쿠키를 활성화하여 Torus에 액세스하십시오.",clickHere:"더 많은 정보"}},zh:{embed:{continue:"继续",actionRequired:"需要授权",pendingAction:"单击继续以在弹出窗口中继续您的请求",cookiesRequired:"必填Cookie",enableCookies:"请在您的浏览器首选项中启用cookie以访问Torus。",clickHere:"更多信息"}}},prodTorusUrl:"",localStorageKeyPrefix:"torus-"},x=S().getLogger("solana-embed");let getWindowId=()=>Math.random().toString(36).slice(2),getTorusUrl=async e=>{let t,r;switch(e){case"testing":t="https://solana-testing.tor.us",r="debug";break;case"development":t="http://localhost:8080",r="debug";break;default:t="https://solana.tor.us",r="error"}return{torusUrl:t,logLevel:r}},getUserLanguage=()=>{let e=window.navigator.language||"en-US",t=e.split("-");return Object.prototype.hasOwnProperty.call(P.translations,t[0])?t[0]:"en"},M={height:660,width:375},O={height:740,width:1315},N={height:700,width:1200},W={height:600,width:400};function getPopupFeatures(e){let{width:t,height:r}=e,n=void 0!==window.screenLeft?window.screenLeft:window.screenX,i=void 0!==window.screenTop?window.screenTop:window.screenY,o=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,a=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height,s=`titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=${r/1},width=${t/1},top=${Math.abs((a-r)/2/1+i)},left=${Math.abs((o-t)/2/1+n)}`;return s}let BaseProvider=class BaseProvider extends SafeEventEmitter{constructor(e,t){var r;let{maxEventListeners:n=100,jsonRpcStreamName:o="provider"}=t;if(super(),(0,i.Z)(this,"isTorus",void 0),(0,i.Z)(this,"_rpcEngine",void 0),(0,i.Z)(this,"jsonRpcConnectionEvents",void 0),(0,i.Z)(this,"_state",void 0),!(isStream(e)&&!1!==e.writable&&"function"==typeof e._write&&"object"==typeof e._writableState&&isStream(r=e)&&!1!==r.readable&&"function"==typeof r._read&&"object"==typeof r._readableState))throw Error(C.errors.invalidDuplexStream());this.isTorus=!0,this.setMaxListeners(n),this._handleConnect=this._handleConnect.bind(this),this._handleDisconnect=this._handleDisconnect.bind(this),this._handleStreamDisconnect=this._handleStreamDisconnect.bind(this),this._rpcRequest=this._rpcRequest.bind(this),this._initializeState=this._initializeState.bind(this),this.request=this.request.bind(this),this.sendAsync=this.sendAsync.bind(this);let s=new ObjectMultiplex;w()(e,s,e,this._handleStreamDisconnect.bind(this,"Torus")),s.ignoreStream("phishing");let d=function(){let e={},t=new SafeEventEmitter,r=new l.Duplex({objectMode:!0,read:function(){return!1},write:function(r,n,i){let o;try{let n=!r.id;n?t.emit("notification",r):!function(t){let r=e[t.id];if(!r)throw Error(`StreamMiddleware - Unknown response id "${t.id}"`);delete e[t.id],Object.assign(r.res,t),setTimeout(r.end)}(r)}catch(e){o=e}i(o)}});return{events:t,middleware:(t,n,i,o)=>{r.push(t),e[t.id]={req:t,res:n,next:i,end:o}},stream:r}}();w()(d.stream,s.createStream(o),d.stream,this._handleStreamDisconnect.bind(this,"Torus RpcProvider"));let u=new JRPCEngine;u.push((e,t,r,n)=>{let i=e.id,o=Math.random().toString(36).slice(2);e.id=o,t.id=o,r(r=>{e.id=i,t.id=i,r()})}),u.push((e,t,r)=>{"string"==typeof e.method&&e.method||(t.error=_.Sy.rpc.invalidRequest({message:"The request 'method' must be a non-empty string.",data:e})),r(e=>{let{error:r}=t;return r&&x.error(`Torus - RPC Error: ${r.message}`,r),e()})}),u.push((0,a.yh)({origin:location.origin})),u.push(d.middleware),this._rpcEngine=u,this.jsonRpcConnectionEvents=d.events}async request(e){if(!e||"object"!=typeof e||Array.isArray(e))throw _.Sy.rpc.invalidRequest({message:C.errors.invalidRequestArgs(),data:e});let{method:t,params:r}=e;if("string"!=typeof t||0===t.length)throw _.Sy.rpc.invalidRequest({message:C.errors.invalidRequestMethod(),data:e});if(void 0!==r&&!Array.isArray(r)&&("object"!=typeof r||null===r))throw _.Sy.rpc.invalidRequest({message:C.errors.invalidRequestParams(),data:e});return new Promise((e,n)=>{this._rpcRequest({method:t,params:r},getRpcPromiseCallback(e,n))})}send(e,t){this._rpcRequest(e,t)}sendAsync(e){return new Promise((t,r)=>{this._rpcRequest(e,getRpcPromiseCallback(t,r))})}_handleStreamDisconnect(e,t){let r;r=`Torus: Lost connection to "${e}".`,t?.stack&&(r+=`
${t.stack}`),x.warn(r),this&&this.listenerCount("error")>0&&this.emit("error",r),this._handleDisconnect(!1,t?t.message:void 0)}};let htmlToElement=e=>{let t=window.document.createElement("template"),r=e.trim();return t.innerHTML=r,t.content.firstChild};function isLegacyTransactionInstance(e){return void 0===e.version}let PopupHandler=class PopupHandler extends SafeEventEmitter{constructor(e){let{url:t,target:r,features:n,timeout:o=3e4}=e;super(),(0,i.Z)(this,"url",void 0),(0,i.Z)(this,"target",void 0),(0,i.Z)(this,"features",void 0),(0,i.Z)(this,"window",void 0),(0,i.Z)(this,"windowTimer",void 0),(0,i.Z)(this,"iClosedWindow",void 0),(0,i.Z)(this,"timeout",void 0),this.url=t,this.target=r||"_blank",this.features=n||getPopupFeatures(N),this.window=void 0,this.windowTimer=void 0,this.iClosedWindow=!1,this.timeout=o,this._setupTimer()}_setupTimer(){this.windowTimer=Number(setInterval(()=>{this.window&&this.window.closed&&(clearInterval(this.windowTimer),setTimeout(()=>{this.iClosedWindow||this.emit("close"),this.iClosedWindow=!1,this.window=void 0},this.timeout)),void 0===this.window&&clearInterval(this.windowTimer)},500))}open(){return this.window=window.open(this.url.href,this.target,this.features),this.window?.focus&&this.window.focus(),Promise.resolve()}close(){this.iClosedWindow=!0,this.window&&this.window.close()}redirect(e){e?window.location.replace(this.url.href):window.location.href=this.url.href}};let TorusCommunicationProvider=class TorusCommunicationProvider extends BaseProvider{constructor(e,t){let{maxEventListeners:r=100,jsonRpcStreamName:o="provider"}=t;super(e,{maxEventListeners:r,jsonRpcStreamName:o}),(0,i.Z)(this,"embedTranslations",void 0),(0,i.Z)(this,"torusUrl",void 0),(0,i.Z)(this,"dappStorageKey",void 0),(0,i.Z)(this,"windowRefs",void 0),(0,i.Z)(this,"tryWindowHandle",void 0),(0,i.Z)(this,"torusAlertContainer",void 0),(0,i.Z)(this,"torusIframe",void 0),this._state=(0,n.Z)({},TorusCommunicationProvider._defaultState),this.torusUrl="",this.dappStorageKey="";let s=P.translations[getUserLanguage()];this.embedTranslations=s.embed,this.windowRefs={},this.on("connect",()=>{this._state.isConnected=!0}),this.jsonRpcConnectionEvents.on("notification",e=>{let{method:t,params:r}=e;if(t===a.Nb.IFRAME_STATUS){let{isFullScreen:e,rid:t}=r;this._displayIframe({isFull:e,rid:t})}else if(t===a.Nb.CREATE_WINDOW){let{windowId:e,url:t}=r;this._createPopupBlockAlert(e,t)}else if(t===a.Nb.CLOSE_WINDOW)this._handleCloseWindow(r);else if(t===a.Nb.USER_LOGGED_IN){let{currentLoginProvider:e}=r;this._state.isLoggedIn=!0,this._state.currentLoginProvider=e}else t===a.Nb.USER_LOGGED_OUT&&(this._state.isLoggedIn=!1,this._state.currentLoginProvider=null,this._displayIframe())})}get isLoggedIn(){return this._state.isLoggedIn}get isIFrameFullScreen(){return this._state.isIFrameFullScreen}isConnected(){return this._state.isConnected}async _initializeState(e){try{let{torusUrl:t,dappStorageKey:r,torusAlertContainer:n,torusIframe:i}=e;this.torusUrl=t,this.dappStorageKey=r,this.torusAlertContainer=n,this.torusIframe=i,this.torusIframe.addEventListener("load",()=>{this._state.isIFrameFullScreen||this._displayIframe()});let{currentLoginProvider:o,isLoggedIn:s}=await this.request({method:a.vU.GET_PROVIDER_STATE,params:[]});this._handleConnect(o,s)}catch(e){x.error("Torus: Failed to get initial state. Please report this bug.",e)}finally{x.info("initialized communication state"),this._state.initialized=!0,this.emit("_initialized")}}_handleWindow(e){let{url:t,target:r,features:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=new URL(t||`${this.torusUrl}/redirect?windowId=${e}`);this.dappStorageKey&&(i.hash?i.hash+=`&dappStorageKey=${this.dappStorageKey}`:i.hash=`#dappStorageKey=${this.dappStorageKey}`);let o=new PopupHandler({url:i,target:r,features:n});if(o.open(),!o.window){this._createPopupBlockAlert(e,i.href);return}this.windowRefs[e]=o,this.request({method:a.vU.OPENED_WINDOW,params:{windowId:e}}),o.once("close",()=>{delete this.windowRefs[e],this.request({method:a.vU.CLOSED_WINDOW,params:{windowId:e}})})}_displayIframe(){let{isFull:e=!1,rid:t=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r={};if(e)r.display="block",r.width="100%",r.height="100%",r.top="0px",r.right="0px",r.left="0px",r.bottom="0px";else switch(r.display=this._state.torusWidgetVisibility?"block":"none",r.height="70px",r.width="70px",this._state.buttonPosition){case I.TOP_LEFT:r.top="0px",r.left="0px",r.right="auto",r.bottom="auto";break;case I.TOP_RIGHT:r.top="0px",r.right="0px",r.left="auto",r.bottom="auto";break;case I.BOTTOM_RIGHT:r.bottom="0px",r.right="0px",r.top="auto",r.left="auto";break;case I.BOTTOM_LEFT:default:r.bottom="0px",r.left="0px",r.top="auto",r.right="auto"}Object.assign(this.torusIframe.style,r),this._state.isIFrameFullScreen=e,this.request({method:a.vU.IFRAME_STATUS,params:{isIFrameFullScreen:e,rid:t}})}hideTorusButton(){this._state.torusWidgetVisibility=!1,this._displayIframe()}showTorusButton(){this._state.torusWidgetVisibility=!0,this._displayIframe()}_rpcRequest(e,t){Array.isArray(e)||e.jsonrpc||(e.jsonrpc="2.0"),this.tryWindowHandle(e,t)}_handleConnect(e,t){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{currentLoginProvider:e,isLoggedIn:t}),x.debug(C.info.connected(e)))}_handleDisconnect(e,t){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!e){let r;this._state.isConnected=!1,e?(r=new _.Cg(1013,t||C.errors.disconnected()),x.debug(r)):(r=new _.Cg(1011,t||C.errors.permanentlyDisconnected()),x.error(r),this._state.currentLoginProvider=null,this._state.isLoggedIn=!1,this._state.torusWidgetVisibility=!1,this._state.isIFrameFullScreen=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",r)}}_handleCloseWindow(e){let{windowId:t}=e;this.windowRefs[t]&&(this.windowRefs[t].close(),delete this.windowRefs[t])}async _createPopupBlockAlert(e,t){let r=this.getLogoUrl(),n=htmlToElement(`<div id="torusAlert" class="torus-alert--v2"><div id="torusAlert__logo"><img src="${r}" /></div><div><h1 id="torusAlert__title">${this.embedTranslations.actionRequired}</h1><p id="torusAlert__desc">${this.embedTranslations.pendingAction}</p></div></div>`),i=htmlToElement(`<div><a id="torusAlert__btn">${this.embedTranslations.continue}</a></div>`),o=htmlToElement('<div id="torusAlert__btn-container"></div>');o.appendChild(i),n.appendChild(o),(()=>{this.torusAlertContainer.appendChild(n)})(),(()=>{i.addEventListener("click",()=>{this._handleWindow(e,{url:t,target:"_blank",features:getPopupFeatures(W)}),n.remove(),0===this.torusAlertContainer.children.length&&(this.torusAlertContainer.style.display="none")})})(),this.torusAlertContainer.style.display="block"}getLogoUrl(){let e=`${this.torusUrl}/images/torus_icon-blue.svg`;return e}};(0,i.Z)(TorusCommunicationProvider,"_defaultState",{buttonPosition:"bottom-left",currentLoginProvider:null,isIFrameFullScreen:!1,hasEmittedConnection:!1,torusWidgetVisibility:!1,initialized:!1,isLoggedIn:!1,isPermanentlyDisconnected:!1,isConnected:!1});let TorusInPageProvider=class TorusInPageProvider extends BaseProvider{constructor(e,t){let{maxEventListeners:r=100,jsonRpcStreamName:o="provider"}=t;super(e,{maxEventListeners:r,jsonRpcStreamName:o}),(0,i.Z)(this,"chainId",void 0),(0,i.Z)(this,"selectedAddress",void 0),(0,i.Z)(this,"tryWindowHandle",void 0),this._state=(0,n.Z)({},TorusInPageProvider._defaultState),this.selectedAddress=null,this.chainId=null,this._handleAccountsChanged=this._handleAccountsChanged.bind(this),this._handleChainChanged=this._handleChainChanged.bind(this),this._handleUnlockStateChanged=this._handleUnlockStateChanged.bind(this),this.on("connect",()=>{this._state.isConnected=!0}),this.jsonRpcConnectionEvents.on("notification",e=>{let{method:t,params:r}=e;t===a.zK.ACCOUNTS_CHANGED?this._handleAccountsChanged(r):t===a.zK.UNLOCK_STATE_CHANGED?this._handleUnlockStateChanged(r):t===a.zK.CHAIN_CHANGED&&this._handleChainChanged(r)})}isConnected(){return this._state.isConnected}async _initializeState(){try{let{accounts:e,chainId:t,isUnlocked:r}=await this.request({method:a.GA.GET_PROVIDER_STATE,params:[]});this.emit("connect",{chainId:t}),this._handleChainChanged({chainId:t}),this._handleUnlockStateChanged({accounts:e,isUnlocked:r}),this._handleAccountsChanged(e)}catch(e){x.error("Torus: Failed to get initial state. Please report this bug.",e)}finally{x.info("initialized provider state"),this._state.initialized=!0,this.emit("_initialized")}}_rpcRequest(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t;if(!Array.isArray(e)){if(e.jsonrpc||(e.jsonrpc="2.0"),"solana_accounts"===e.method||"solana_requestAccounts"===e.method)n=(n,i)=>{this._handleAccountsChanged(i.result||[],"solana_accounts"===e.method,r),t(n,i)};else if("wallet_getProviderState"===e.method){this._rpcEngine.handle(e,n);return}}this.tryWindowHandle(e,n)}_handleConnect(e){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{chainId:e}),x.debug(C.info.connected(e)))}_handleDisconnect(e,t){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!e){let r;this._state.isConnected=!1,e?(r=new _.Cg(1013,t||C.errors.disconnected()),x.debug(r)):(r=new _.Cg(1011,t||C.errors.permanentlyDisconnected()),x.error(r),this.chainId=null,this._state.accounts=null,this.selectedAddress=null,this._state.isUnlocked=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",r)}}_handleAccountsChanged(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e;for(let t of(Array.isArray(n)||(x.error("Torus: Received non-array accounts parameter. Please report this bug.",n),n=[]),e))if("string"!=typeof t){x.error("Torus: Received non-string account. Please report this bug.",e),n=[];break}T()(this._state.accounts,n)||(t&&Array.isArray(this._state.accounts)&&this._state.accounts.length>0&&!r&&x.error('Torus: "solana_accounts" unexpectedly updated accounts. Please report this bug.',n),this._state.accounts=n,this.emit("accountsChanged",n)),this.selectedAddress!==n[0]&&(this.selectedAddress=n[0]||null)}_handleChainChanged(){let{chainId:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e){x.error("Torus: Received invalid network parameters. Please report this bug.",{chainId:e});return}"loading"===e?this._handleDisconnect(!0):(this._handleConnect(e),e!==this.chainId&&(this.chainId=e,this._state.initialized&&this.emit("chainChanged",this.chainId)))}_handleUnlockStateChanged(){let{accounts:e,isUnlocked:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("boolean"!=typeof t){x.error("Torus: Received invalid isUnlocked parameter. Please report this bug.",{isUnlocked:t});return}t!==this._state.isUnlocked&&(this._state.isUnlocked=t,this._handleAccountsChanged(e||[]))}};function imgExists(e){return new Promise((t,r)=>{try{let r=document.createElement("img");r.onload=()=>t(!0),r.onerror=()=>t(!1),r.src=e}catch(e){r(e)}})}(0,i.Z)(TorusInPageProvider,"_defaultState",{accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1,hasEmittedConnection:!1});let getSiteName=e=>{let{document:t}=e,r=t.querySelector('head > meta[property="og:site_name"]');if(r)return r.content;let n=t.querySelector('head > meta[name="title"]');return n?n.content:t.title&&t.title.length>0?t.title:e.location.hostname};async function getSiteIcon(e){try{let{document:t}=e,r=t.querySelector('head > link[rel="shortcut icon"]');if(r&&await imgExists(r.href)||(r=Array.from(t.querySelectorAll('head > link[rel="icon"]')).find(e=>!!e.href))&&await imgExists(r.href))return r.href;return""}catch(e){return""}}let getSiteMetadata=async()=>({name:getSiteName(window),icon:await getSiteIcon(window)}),D=["send_transaction","sign_transaction","sign_all_transactions","sign_message","connect"],L=[a.vU.SET_PROVIDER],j=function(e){let t;try{t=window[e];let r="__storage_test__";return t.setItem(r,r),t.removeItem(r),!0}catch(e){return e&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}}("localStorage");!async function(){try{if("undefined"==typeof document)return;let e=document.createElement("link"),{torusUrl:t}=await getTorusUrl("production");e.href=`${t}/frame`,e.crossOrigin="anonymous",e.type="text/html",e.rel="prefetch",e.relList&&e.relList.supports&&e.relList.supports("prefetch")&&document.head.appendChild(e)}catch(e){x.warn(e)}}();let Torus=class Torus{constructor(){let{modalZIndex:e=99999}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.Z)(this,"isInitialized",void 0),(0,i.Z)(this,"torusAlert",void 0),(0,i.Z)(this,"modalZIndex",void 0),(0,i.Z)(this,"alertZIndex",void 0),(0,i.Z)(this,"requestedLoginProvider",void 0),(0,i.Z)(this,"provider",void 0),(0,i.Z)(this,"communicationProvider",void 0),(0,i.Z)(this,"dappStorageKey",void 0),(0,i.Z)(this,"isTopupHidden",!1),(0,i.Z)(this,"torusAlertContainer",void 0),(0,i.Z)(this,"torusUrl",void 0),(0,i.Z)(this,"torusIframe",void 0),(0,i.Z)(this,"styleLink",void 0),this.torusUrl="",this.isInitialized=!1,this.requestedLoginProvider=null,this.modalZIndex=e,this.alertZIndex=e+1e3,this.dappStorageKey=""}get isLoggedIn(){return!!this.communicationProvider&&this.communicationProvider.isLoggedIn}async init(){let{buildEnv:e="production",enableLogging:t=!1,network:r,showTorusButton:n=!1,useLocalStorage:i=!1,buttonPosition:o=I.BOTTOM_LEFT,apiKey:a="torus-default",extraParams:l={},whiteLabel:d}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.isInitialized)throw Error("Already initialized");(0,s.ut)(a);let{torusUrl:u,logLevel:c}=await getTorusUrl(e);x.enableAll(),x.info(u,"url loaded"),x.info("Solana Embed Version :2.0.0"),this.torusUrl=u,x.setDefaultLevel(c),t?x.enableAll():x.disableAll();let h=this.handleDappStorageKey(i),f=new URL(u);f.pathname.endsWith("/")?f.pathname+="frame":f.pathname+="/frame";let p=new URLSearchParams;return h&&p.append("dappStorageKey",h),p.append("origin",window.location.origin),f.hash=p.toString(),this.torusIframe=htmlToElement(`<iframe
        id="torusIframe"
        class="torusIframe"
        src="${f.href}"
        style="display: none; position: fixed; top: 0; right: 0; width: 100%;
        height: 100%; border: none; border-radius: 0; z-index: ${this.modalZIndex.toString()}"
      ></iframe>`),this.torusAlertContainer=htmlToElement(`<div id="torusAlertContainer" style="display:none; z-index: ${this.alertZIndex.toString()}"></div>`),this.styleLink=htmlToElement(`<link href="${u}/css/widget.css" rel="stylesheet" type="text/css">`),new Promise((e,t)=>{try{this.torusIframe.addEventListener("load",async()=>{let t=await getSiteMetadata();this.torusIframe.contentWindow.postMessage({buttonPosition:o,apiKey:a,network:r,dappMetadata:t,extraParams:l,whiteLabel:d},f.origin),await this._setupWeb3({torusUrl:u}),n&&this.showTorusButton(),d?.topupHide?this.isTopupHidden=d.topupHide:this.hideTorusButton(),this.isInitialized=!0,window.torus=this,e()}),window.document.head.appendChild(this.styleLink),window.document.body.appendChild(this.torusIframe),window.document.body.appendChild(this.torusAlertContainer)}catch(e){t(e)}})}async login(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.isInitialized)throw Error("Call init() first");try{this.requestedLoginProvider=e.loginProvider||null,this.requestedLoginProvider||this.communicationProvider._displayIframe({isFull:!0});let t=await new Promise((t,r)=>{this.provider._rpcRequest({method:"solana_requestAccounts",params:[this.requestedLoginProvider,e.login_hint]},getRpcPromiseCallback(t,r))});if(Array.isArray(t)&&t.length>0)return t;throw Error("Login failed")}catch(e){throw x.error("login failed",e),e}finally{this.communicationProvider.isIFrameFullScreen&&this.communicationProvider._displayIframe()}}async loginWithPrivateKey(e){if(!this.isInitialized)throw Error("Call init() first");let{privateKey:t,userInfo:r}=e,{success:n}=await this.communicationProvider.request({method:"login_with_private_key",params:{privateKey:t,userInfo:r}});if(!n)throw Error("Login Failed")}async logout(){if(!this.communicationProvider.isLoggedIn)throw Error("Not logged in");await this.communicationProvider.request({method:a.vU.LOGOUT,params:[]}),this.requestedLoginProvider=null}async cleanUp(){this.communicationProvider.isLoggedIn&&await this.logout(),this.clearInit()}clearInit(){function isElement(e){return e instanceof Element||e instanceof Document}isElement(this.styleLink)&&window.document.body.contains(this.styleLink)&&(this.styleLink.remove(),this.styleLink=void 0),isElement(this.torusIframe)&&window.document.body.contains(this.torusIframe)&&(this.torusIframe.remove(),this.torusIframe=void 0),isElement(this.torusAlertContainer)&&window.document.body.contains(this.torusAlertContainer)&&(this.torusAlert=void 0,this.torusAlertContainer.remove(),this.torusAlertContainer=void 0),this.isInitialized=!1}hideTorusButton(){this.communicationProvider.hideTorusButton()}showTorusButton(){this.communicationProvider.showTorusButton()}async setProvider(e){await this.communicationProvider.request({method:a.vU.SET_PROVIDER,params:(0,n.Z)({},e)})}async showWallet(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=await this.communicationProvider.request({method:a.vU.WALLET_INSTANCE_ID,params:[]}),n=e?`/${e}`:"",i=new URL(`${this.torusUrl}/wallet${n}`);i.searchParams.append("instanceId",r),Object.keys(t).forEach(e=>{i.searchParams.append(e,t[e])}),this.dappStorageKey&&(i.hash=`#dappStorageKey=${this.dappStorageKey}`);let o=new PopupHandler({url:i,features:getPopupFeatures(O)});o.open()}async getUserInfo(){let e=await this.communicationProvider.request({method:a.vU.USER_INFO,params:[]});return e}async initiateTopup(e,t){if(!this.isInitialized)throw Error("Torus is not initialized");let r=getWindowId();this.communicationProvider._handleWindow(r);let n=await this.communicationProvider.request({method:a.vU.TOPUP,params:{provider:e,params:t,windowId:r}});return n}async getAccounts(){let e=await this.provider.request({method:"getAccounts",params:[]});return e}async sendTransaction(e){let t=isLegacyTransactionInstance(e),r=t?e.serialize({requireAllSignatures:!1}).toString("hex"):A.from(e.serialize()).toString("hex"),n=await this.provider.request({method:"send_transaction",params:{message:r,isLegacyTransaction:t}});return n}async signAndSendTransaction(e,t){let r=isLegacyTransactionInstance(e),n=r?e.serialize({requireAllSignatures:!1}).toString("hex"):A.from(e.serialize()).toString("hex"),i=await this.provider.request({method:"send_transaction",params:{message:n,options:t,isLegacyTransaction:r}});return{signature:i}}async signTransaction(e){let t=isLegacyTransactionInstance(e),r=t?e.serializeMessage().toString("hex"):A.from(e.message.serialize()).toString("hex"),n=await this.provider.request({method:"sign_transaction",params:{message:r,messageOnly:!0,isLegacyTransaction:t}}),i=JSON.parse(n),a={publicKey:new o.nh(i.publicKey),signature:A.from(i.signature,"hex")};return e.addSignature(a.publicKey,a.signature),e}async signAllTransactions(e){let t;let r=e.map(e=>(t=isLegacyTransactionInstance(e))?e.serializeMessage().toString("hex"):A.from(e.message.serialize()).toString("hex")),n=await this.provider.request({method:"sign_all_transactions",params:{message:r,messageOnly:!0,isLegacyTransaction:t}}),i=n.map(e=>{let t=JSON.parse(e);return{publicKey:new o.nh(t.publicKey),signature:A.from(t.signature,"hex")}});return e.forEach((e,t)=>(e.addSignature(i[t].publicKey,i[t].signature),e)),e}async signMessage(e){let t=await this.provider.request({method:"sign_message",params:{data:e}});return t}async getGaslessPublicKey(){let e=await this.provider.request({method:"get_gasless_public_key",params:[]});return e}handleDappStorageKey(e){let t=`${P.localStorageKeyPrefix}${window.location.hostname}`,r="";if(j&&e){let e=window.localStorage.getItem(t);if(e)r=e;else{let e=`torus-app-${getWindowId()}`;window.localStorage.setItem(t,e),r=e}}return this.dappStorageKey=r,r}async _setupWeb3(e){x.info("setupWeb3 running");let t=new BasePostMessageStream({name:"embed_torus",target:"iframe_torus",targetWindow:this.torusIframe.contentWindow}),r=new BasePostMessageStream({name:"embed_communication",target:"iframe_communication",targetWindow:this.torusIframe.contentWindow}),i=new TorusInPageProvider(t,{}),o=new TorusCommunicationProvider(r,{});i.tryWindowHandle=(e,t)=>{if(!Array.isArray(e)&&D.includes(e.method)){if(!this.communicationProvider.isLoggedIn)throw Error("User Not Logged In");let t=getWindowId();o._handleWindow(t,{target:"_blank",features:getPopupFeatures(W)}),e.windowId=t}i._rpcEngine.handle(e,t)},o.tryWindowHandle=(e,t)=>{if(!Array.isArray(e)&&L.includes(e.method)){let t=getWindowId();o._handleWindow(t,{target:"_blank",features:getPopupFeatures(M)}),e.params.windowId=t}o._rpcEngine.handle(e,t)};let detectAccountRequestPrototypeModifier=e=>{let t=i[e],r=this;i[e]=function(e,n){let{method:i,params:o=[]}=e;if("solana_requestAccounts"===i){if(!n)return r.login({loginProvider:o[0]});r.login({loginProvider:o[0]}).then(e=>n(null,e)).catch(e=>n(e))}return t.apply(this,[e,n])}};detectAccountRequestPrototypeModifier("request"),detectAccountRequestPrototypeModifier("sendAsync"),detectAccountRequestPrototypeModifier("send");let a=new Proxy(i,{deleteProperty:()=>!0}),s=new Proxy(o,{deleteProperty:()=>!0});this.provider=a,this.communicationProvider=s,await Promise.all([i._initializeState(),o._initializeState((0,n.Z)((0,n.Z)({},e),{},{dappStorageKey:this.dappStorageKey,torusAlertContainer:this.torusAlertContainer,torusIframe:this.torusIframe}))]),x.debug("Torus - injected provider")}};var F=r(85783),$=r(1482),q=r(75267);let SolanaWalletAdapter=class SolanaWalletAdapter extends $.v{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),(0,i.Z)(this,"name",F.rW.TORUS_SOLANA),(0,i.Z)(this,"adapterNamespace",F.yk.SOLANA),(0,i.Z)(this,"currentChainNamespace",F.EN.SOLANA),(0,i.Z)(this,"type",F.hN.EXTERNAL),(0,i.Z)(this,"status",F.MP.NOT_READY),(0,i.Z)(this,"torusInstance",null),(0,i.Z)(this,"torusWalletOptions",void 0),(0,i.Z)(this,"initParams",void 0),(0,i.Z)(this,"loginSettings",{}),(0,i.Z)(this,"solanaProvider",null),this.torusWalletOptions=e.adapterSettings||{},this.initParams=e.initParams||{},this.loginSettings=e.loginSettings||{}}get provider(){return this.status!==F.MP.NOT_READY&&this.solanaProvider?this.solanaProvider:null}set provider(e){throw Error("Not implemented")}async init(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await super.init(e),super.checkInitializationRequirements();let{chainId:t,blockExplorer:r,displayName:i,rpcTarget:o,ticker:a,tickerName:s}=this.chainConfig;this.torusInstance=new Torus(this.torusWalletOptions),F.cM.debug("initializing torus solana adapter init"),await this.torusInstance.init((0,n.Z)((0,n.Z)({showTorusButton:!1},this.initParams),{},{network:{chainId:t,rpcTarget:o,blockExplorerUrl:r,displayName:i,tickerName:s,ticker:a,logo:""}})),this.solanaProvider=new q.Os({config:{chainConfig:this.chainConfig}}),this.status=F.MP.READY,this.emit(F.n2.READY,F.rW.TORUS_SOLANA);try{F.cM.debug("initializing torus solana adapter"),e.autoConnect&&(this.rehydrated=!0,await this.connect())}catch(e){F.cM.error("Failed to connect with cached torus solana provider",e),this.emit(F.n2.ERRORED,e)}}async connect(){if(super.checkConnectionRequirements(),!this.torusInstance||!this.solanaProvider)throw F.Ty.notReady("Torus wallet is not initialized");this.status=F.MP.CONNECTING,this.emit(F.n2.CONNECTING,{adapter:F.rW.TORUS_SOLANA});try{await this.torusInstance.login(this.loginSettings);try{let e=this.torusInstance.provider;e.sendTransaction=this.torusInstance.sendTransaction.bind(this.torusInstance),e.signAllTransactions=this.torusInstance.signAllTransactions.bind(this.torusInstance),e.signMessage=this.torusInstance.signMessage.bind(this.torusInstance),e.signTransaction=this.torusInstance.signTransaction.bind(this.torusInstance),await this.solanaProvider.setupProvider(e)}catch(e){if(e instanceof F.up&&5010===e.code){let{chainId:e,blockExplorer:t,displayName:r,rpcTarget:n,ticker:i,tickerName:o}=this.chainConfig;await this.torusInstance.setProvider({chainId:e,rpcTarget:n,blockExplorerUrl:t,displayName:r,tickerName:o,ticker:i,logo:""})}else throw e}return this.status=F.MP.CONNECTED,this.torusInstance.showTorusButton(),this.emit(F.MP.CONNECTED,{adapter:F.rW.TORUS_SOLANA,reconnected:this.rehydrated}),this.provider}catch(e){if(this.status=F.MP.READY,this.rehydrated=!1,this.emit(F.n2.ERRORED,e),e instanceof F.up)throw e;throw F.RM.connectionError("Failed to login with torus solana wallet")}}async disconnect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cleanup:!1};if(await super.disconnectSession(),!this.torusInstance)throw F.Ty.notReady("Torus wallet is not initialized");await this.torusInstance.logout(),e.cleanup?(this.status=F.MP.NOT_READY,this.torusInstance=null,this.solanaProvider=null):this.status=F.MP.READY,await super.disconnect()}async getUserInfo(){if(this.status!==F.MP.CONNECTED)throw F.RM.notConnectedError("Not connected with wallet");if(!this.torusInstance)throw F.Ty.notReady("Torus wallet is not initialized");let e=await this.torusInstance.getUserInfo();return e}async addChain(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.checkAddChainRequirements(e,t),this.addChainConfig(e)}async switchChain(e){var t;let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.checkSwitchChainRequirements(e,r);let n=this.getChainConfig(e.chainId);await (null===(t=this.torusInstance)||void 0===t?void 0:t.setProvider({rpcTarget:n.rpcTarget,chainId:n.chainId,displayName:n.displayName,blockExplorerUrl:n.blockExplorer,ticker:n.ticker,tickerName:n.tickerName,logo:"https://images.web3auth.io/login-torus-solana.svg"})),this.setAdapterSettings({chainConfig:this.getChainConfig(e.chainId)})}}},12294:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EthereumProviderError=t.EthereumRpcError=void 0;let n=r(4445);let EthereumRpcError=class EthereumRpcError extends Error{constructor(e,t,r){if(!Number.isInteger(e))throw Error('"code" must be an integer.');if(!t||"string"!=typeof t)throw Error('"message" must be a nonempty string.');super(t),this.code=e,void 0!==r&&(this.data=r)}serialize(){let e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data),this.stack&&(e.stack=this.stack),e}toString(){return n.default(this.serialize(),stringifyReplacer,2)}};function stringifyReplacer(e,t){if("[Circular]"!==t)return t}t.EthereumRpcError=EthereumRpcError,t.EthereumProviderError=class extends EthereumRpcError{constructor(e,t,r){if(!(Number.isInteger(e)&&e>=1e3&&e<=4999))throw Error('"code" must be an integer such that: 1000 <= code <= 4999');super(e,t,r)}}},92662:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorValues=t.errorCodes=void 0,t.errorCodes={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}},t.errorValues={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}}},68797:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ethErrors=void 0;let n=r(12294),i=r(68753),o=r(92662);function getEthJsonRpcError(e,t){let[r,o]=parseOpts(t);return new n.EthereumRpcError(e,r||i.getMessageFromCode(e),o)}function getEthProviderError(e,t){let[r,o]=parseOpts(t);return new n.EthereumProviderError(e,r||i.getMessageFromCode(e),o)}function parseOpts(e){if(e){if("string"==typeof e)return[e];if("object"==typeof e&&!Array.isArray(e)){let{message:t,data:r}=e;if(t&&"string"!=typeof t)throw Error("Must specify string message.");return[t||void 0,r]}}return[]}t.ethErrors={rpc:{parse:e=>getEthJsonRpcError(o.errorCodes.rpc.parse,e),invalidRequest:e=>getEthJsonRpcError(o.errorCodes.rpc.invalidRequest,e),invalidParams:e=>getEthJsonRpcError(o.errorCodes.rpc.invalidParams,e),methodNotFound:e=>getEthJsonRpcError(o.errorCodes.rpc.methodNotFound,e),internal:e=>getEthJsonRpcError(o.errorCodes.rpc.internal,e),server:e=>{if(!e||"object"!=typeof e||Array.isArray(e))throw Error("Ethereum RPC Server errors must provide single object argument.");let{code:t}=e;if(!Number.isInteger(t)||t>-32005||t<-32099)throw Error('"code" must be an integer such that: -32099 <= code <= -32005');return getEthJsonRpcError(t,e)},invalidInput:e=>getEthJsonRpcError(o.errorCodes.rpc.invalidInput,e),resourceNotFound:e=>getEthJsonRpcError(o.errorCodes.rpc.resourceNotFound,e),resourceUnavailable:e=>getEthJsonRpcError(o.errorCodes.rpc.resourceUnavailable,e),transactionRejected:e=>getEthJsonRpcError(o.errorCodes.rpc.transactionRejected,e),methodNotSupported:e=>getEthJsonRpcError(o.errorCodes.rpc.methodNotSupported,e),limitExceeded:e=>getEthJsonRpcError(o.errorCodes.rpc.limitExceeded,e)},provider:{userRejectedRequest:e=>getEthProviderError(o.errorCodes.provider.userRejectedRequest,e),unauthorized:e=>getEthProviderError(o.errorCodes.provider.unauthorized,e),unsupportedMethod:e=>getEthProviderError(o.errorCodes.provider.unsupportedMethod,e),disconnected:e=>getEthProviderError(o.errorCodes.provider.disconnected,e),chainDisconnected:e=>getEthProviderError(o.errorCodes.provider.chainDisconnected,e),custom:e=>{if(!e||"object"!=typeof e||Array.isArray(e))throw Error("Ethereum Provider custom errors must provide single object argument.");let{code:t,message:r,data:i}=e;if(!r||"string"!=typeof r)throw Error('"message" must be a nonempty string');return new n.EthereumProviderError(t,r,i)}}}},79826:function(e,t,r){"use strict";t.Cg=t.Sy=void 0;let n=r(12294);Object.defineProperty(t,"Cg",{enumerable:!0,get:function(){return n.EthereumRpcError}}),r(68753);let i=r(68797);Object.defineProperty(t,"Sy",{enumerable:!0,get:function(){return i.ethErrors}}),r(92662)},68753:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serializeError=t.isValidCode=t.getMessageFromCode=t.JSON_RPC_SERVER_ERROR_MESSAGE=void 0;let n=r(92662),i=r(12294),o=n.errorCodes.rpc.internal,a={code:o,message:getMessageFromCode(o)};function getMessageFromCode(e,r="Unspecified error message. This is a bug, please report it."){if(Number.isInteger(e)){let r=e.toString();if(hasKey(n.errorValues,r))return n.errorValues[r].message;if(e>=-32099&&e<=-32e3)return t.JSON_RPC_SERVER_ERROR_MESSAGE}return r}function isValidCode(e){if(!Number.isInteger(e))return!1;let t=e.toString();return!!(n.errorValues[t]||e>=-32099&&e<=-32e3)}function assignOriginalError(e){return e&&"object"==typeof e&&!Array.isArray(e)?Object.assign({},e):e}function hasKey(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.JSON_RPC_SERVER_ERROR_MESSAGE="Unspecified server error.",t.getMessageFromCode=getMessageFromCode,t.isValidCode=isValidCode,t.serializeError=function(e,{fallbackError:t=a,shouldIncludeStack:r=!1}={}){if(!t||!Number.isInteger(t.code)||"string"!=typeof t.message)throw Error("Must provide fallback error with integer number code and string message.");if(e instanceof i.EthereumRpcError)return e.serialize();let n={};if(e&&"object"==typeof e&&!Array.isArray(e)&&hasKey(e,"code")&&isValidCode(e.code))n.code=e.code,e.message&&"string"==typeof e.message?(n.message=e.message,hasKey(e,"data")&&(n.data=e.data)):(n.message=getMessageFromCode(n.code),n.data={originalError:assignOriginalError(e)});else{n.code=t.code;let r=null==e?void 0:e.message;n.message=r&&"string"==typeof r?r:t.message,n.data={originalError:assignOriginalError(e)}}let o=null==e?void 0:e.stack;return r&&e&&o&&"string"==typeof o&&(n.stack=o),n}},64063:function(e){"use strict";e.exports=function equal(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)){if((r=e.length)!=t.length)return!1;for(n=r;0!=n--;)if(!equal(e[n],t[n]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if((r=(i=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(n=r;0!=n--;)if(!Object.prototype.hasOwnProperty.call(t,i[n]))return!1;for(n=r;0!=n--;){var r,n,i,o=i[n];if(!equal(e[o],t[o]))return!1}return!0}return e!=e&&t!=t}}}]);